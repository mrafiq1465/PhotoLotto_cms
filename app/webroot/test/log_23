# Time: 121023  0:01:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.002121  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350975663;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.002542  Lock_time: 0.000125 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350975663;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:02:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.137100  Lock_time: 0.000123 Rows_sent: 125  Rows_examined: 1043801
SET timestamp=1350975736;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.950978  Lock_time: 0.000121 Rows_sent: 468  Rows_examined: 1241755
SET timestamp=1350975736;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:02:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.332752  Lock_time: 0.000201 Rows_sent: 16539  Rows_examined: 8077488
SET timestamp=1350975742;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:02:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.433377  Lock_time: 0.000147 Rows_sent: 65079  Rows_examined: 1734687
SET timestamp=1350975768;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  0:04:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.549788  Lock_time: 0.000161 Rows_sent: 125  Rows_examined: 1043801
SET timestamp=1350975894;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:04:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.169244  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1241755
SET timestamp=1350975895;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:05:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.049395  Lock_time: 0.000190 Rows_sent: 16539  Rows_examined: 8077488
SET timestamp=1350975901;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.031280  Lock_time: 0.000096 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350975915;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:06:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.079865  Lock_time: 0.000069 Rows_sent: 125  Rows_examined: 1043801
SET timestamp=1350975987;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:06:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.189190  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1241755
SET timestamp=1350975988;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:07:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.967825  Lock_time: 0.000159 Rows_sent: 1493  Rows_examined: 6450359
SET timestamp=1350976023;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  0:08:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.630678  Lock_time: 0.000213 Rows_sent: 16539  Rows_examined: 8077488
SET timestamp=1350976084;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
# Time: 121023  0:08:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.239806  Lock_time: 0.000131 Rows_sent: 125  Rows_examined: 1043802
SET timestamp=1350976131;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.720855  Lock_time: 0.000078 Rows_sent: 468  Rows_examined: 1241756
SET timestamp=1350976131;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.506166  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 18409
SET timestamp=1350976204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.734028  Lock_time: 0.000093 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350976219;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.738678  Lock_time: 0.000115 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350976219;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:11:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.497683  Lock_time: 0.000147 Rows_sent: 125  Rows_examined: 1043802
SET timestamp=1350976280;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:11:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.124240  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1241756
SET timestamp=1350976281;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:11:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.782067  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8077527
SET timestamp=1350976286;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.131986  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 18409
SET timestamp=1350976322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:12:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.433077  Lock_time: 0.000211 Rows_sent: 3  Rows_examined: 29315
SET timestamp=1350976335;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  0:13:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.346184  Lock_time: 0.000101 Rows_sent: 125  Rows_examined: 1043802
SET timestamp=1350976401;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:13:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.202210  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1241756
SET timestamp=1350976402;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:14:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.985518  Lock_time: 0.000209 Rows_sent: 16539  Rows_examined: 8077527
SET timestamp=1350976459;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:14:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.361330  Lock_time: 0.000122 Rows_sent: 125  Rows_examined: 1043803
SET timestamp=1350976482;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.978935  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1241757
SET timestamp=1350976482;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.590096  Lock_time: 0.000084 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350976516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:16:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.058692  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 18411
SET timestamp=1350976562;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:16:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.666955  Lock_time: 0.000129 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350976594;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:16:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.569357  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350976595;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:16:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.078935  Lock_time: 0.000199 Rows_sent: 16539  Rows_examined: 8077543
SET timestamp=1350976600;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:16:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.456372  Lock_time: 0.000183 Rows_sent: 1493  Rows_examined: 6450362
SET timestamp=1350976605;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  0:18:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  0:18:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.971393  Lock_time: 0.000132 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350976729;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.182453  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 18411
SET timestamp=1350976803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:20:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.139625  Lock_time: 0.000211 Rows_sent: 16539  Rows_examined: 8077543
SET timestamp=1350976806;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:20:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.974654  Lock_time: 0.000100 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350976817;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.994900  Lock_time: 0.000114 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350976817;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:21:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.686025  Lock_time: 0.000074 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350976873;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.340972  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350976873;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:22:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.287366  Lock_time: 0.000068 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350976965;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.522317  Lock_time: 0.000064 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350976965;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:22:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.048609  Lock_time: 0.000128 Rows_sent: 16539  Rows_examined: 8077543
SET timestamp=1350976973;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:22:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.356977  Lock_time: 0.000148 Rows_sent: 65079  Rows_examined: 1734694
SET timestamp=1350976977;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  0:24:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.554621  Lock_time: 0.000094 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350977092;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:24:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.203210  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350977093;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:25:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.619947  Lock_time: 0.000100 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350977117;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:26:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.419732  Lock_time: 0.000174 Rows_sent: 16539  Rows_examined: 8077543
SET timestamp=1350977192;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:26:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.832763  Lock_time: 0.000172 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350977197;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:26:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.388056  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350977198;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:26:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.376002  Lock_time: 0.000144 Rows_sent: 1493  Rows_examined: 6450362
SET timestamp=1350977206;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  0:28:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.910729  Lock_time: 0.000160 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350977326;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:28:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.503916  Lock_time: 0.000113 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350977327;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
# Time: 121023  0:28:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.318401  Lock_time: 0.000258 Rows_sent: 16539  Rows_examined: 8077543
SET timestamp=1350977333;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.562677  Lock_time: 0.000125 Rows_sent: 5  Rows_examined: 2338
SET timestamp=1350977403;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Campus Explorer : Grand Canyon University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Campus Explorer : Grand Canyon University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.483118  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 18411
SET timestamp=1350977403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.714338  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350977418;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.711930  Lock_time: 0.000113 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350977418;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:31:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.785431  Lock_time: 0.000114 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350977480;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.601129  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350977480;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:32:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.233289  Lock_time: 0.000075 Rows_sent: 0  Rows_examined: 18411
SET timestamp=1350977522;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:32:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.109821  Lock_time: 0.000239 Rows_sent: 3  Rows_examined: 29317
SET timestamp=1350977535;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  0:32:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.937676  Lock_time: 0.000220 Rows_sent: 16539  Rows_examined: 8077543
SET timestamp=1350977554;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:33:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.089448  Lock_time: 0.000097 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350977597;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:33:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.640475  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350977598;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:34:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.793599  Lock_time: 0.000163 Rows_sent: 125  Rows_examined: 1043804
SET timestamp=1350977684;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:34:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.371303  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1241758
SET timestamp=1350977685;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:34:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.418267  Lock_time: 0.000179 Rows_sent: 16539  Rows_examined: 8077543
SET timestamp=1350977691;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:35:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.248085  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350977715;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:36:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.052717  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 18412
SET timestamp=1350977762;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:36:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.978405  Lock_time: 0.000174 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350977792;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.730019  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350977792;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:36:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.793131  Lock_time: 0.000109 Rows_sent: 1493  Rows_examined: 6450362
SET timestamp=1350977800;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  0:38:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.747919  Lock_time: 0.000216 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350977880;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
# Time: 121023  0:38:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.586200  Lock_time: 0.000135 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350977927;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:38:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.129541  Lock_time: 0.000137 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350977928;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.576399  Lock_time: 0.000082 Rows_sent: 0  Rows_examined: 18412
SET timestamp=1350978004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:40:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.105662  Lock_time: 0.000103 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350978019;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.105409  Lock_time: 0.000128 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350978019;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:41:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.857257  Lock_time: 0.000099 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978073;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:41:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.505224  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978074;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:41:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.200675  Lock_time: 0.000300 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350978079;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:42:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.392587  Lock_time: 0.000105 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978163;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.601410  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978163;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:42:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.270118  Lock_time: 0.000189 Rows_sent: 65079  Rows_examined: 1734697
SET timestamp=1350978175;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  0:44:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.273863  Lock_time: 0.000214 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350978257;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:44:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.747400  Lock_time: 0.000158 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978292;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:44:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.732923  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978293;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:45:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.951316  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350978315;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:46:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.287214  Lock_time: 0.000093 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978395;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:46:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.073955  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978396;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:46:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.458250  Lock_time: 0.000136 Rows_sent: 1493  Rows_examined: 6450362
SET timestamp=1350978401;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  0:46:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.964556  Lock_time: 0.000129 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350978402;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:48:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.069090  Lock_time: 0.000144 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978532;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.908967  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978532;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
# Time: 121023  0:50:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.218472  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350978603;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.975073  Lock_time: 0.000050 Rows_sent: 0  Rows_examined: 18412
SET timestamp=1350978603;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  0:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.717163  Lock_time: 0.000120 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350978617;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.703400  Lock_time: 0.000073 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350978617;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:51:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.999072  Lock_time: 0.000086 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978669;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:51:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.659052  Lock_time: 0.000084 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978670;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.214501  Lock_time: 0.000158 Rows_sent: 3  Rows_examined: 29318
SET timestamp=1350978736;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  0:53:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.806405  Lock_time: 0.000108 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978805;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.429285  Lock_time: 0.000158 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978805;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:53:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.273590  Lock_time: 0.000200 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350978811;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.494124  Lock_time: 0.000148 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350978888;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.054130  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350978889;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.826022  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350978916;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  0:56:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.138050  Lock_time: 0.000192 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350978982;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  0:56:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.011901  Lock_time: 0.000132 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350979000;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.623083  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350979000;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:56:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.702880  Lock_time: 0.000155 Rows_sent: 1493  Rows_examined: 6450362
SET timestamp=1350979003;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  0:58:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.086849  Lock_time: 0.000143 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350979131;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  0:58:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.939453  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350979132;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  0:58:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.494288  Lock_time: 0.000220 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350979138;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
# Time: 121023  1:00:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.349087  Lock_time: 0.000100 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350979252;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.348044  Lock_time: 0.000084 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350979252;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:02:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 123.789010  Lock_time: 0.000136 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350979325;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:02:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.754435  Lock_time: 0.000164 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350979326;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:02:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.705559  Lock_time: 0.000218 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350979331;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:02:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.470962  Lock_time: 0.000119 Rows_sent: 65079  Rows_examined: 1734697
SET timestamp=1350979368;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  1:04:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.732546  Lock_time: 0.000093 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350979495;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:04:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.377099  Lock_time: 0.000159 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350979496;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:05:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.317274  Lock_time: 0.000180 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350979502;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.911527  Lock_time: 0.000093 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350979515;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:06:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.337412  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1241760
SET timestamp=1350979582;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  1:06:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.471752  Lock_time: 0.000129 Rows_sent: 125  Rows_examined: 1043806
SET timestamp=1350979595;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.930839  Lock_time: 0.000090 Rows_sent: 468  Rows_examined: 1241760
SET timestamp=1350979595;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:06:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.927704  Lock_time: 0.000109 Rows_sent: 1493  Rows_examined: 6450362
SET timestamp=1350979601;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  1:08:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.460130  Lock_time: 0.000217 Rows_sent: 16539  Rows_examined: 8077577
SET timestamp=1350979686;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:08:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.695460  Lock_time: 0.000127 Rows_sent: 125  Rows_examined: 1043806
SET timestamp=1350979728;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.206704  Lock_time: 0.000167 Rows_sent: 468  Rows_examined: 1241760
SET timestamp=1350979728;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  1:10:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.575427  Lock_time: 0.000192 Rows_sent: 1  Rows_examined: 29633
SET timestamp=1350979820;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.650946  Lock_time: 0.000100 Rows_sent: 1  Rows_examined: 29633
SET timestamp=1350979820;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:11:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.380250  Lock_time: 0.000095 Rows_sent: 125  Rows_examined: 1043806
SET timestamp=1350979868;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:11:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.030393  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1241760
SET timestamp=1350979869;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:11:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.135234  Lock_time: 0.000214 Rows_sent: 16539  Rows_examined: 8077577
SET timestamp=1350979875;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.109174  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 18413
SET timestamp=1350979922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  1:12:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.491877  Lock_time: 0.000154 Rows_sent: 3  Rows_examined: 29319
SET timestamp=1350979935;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  1:13:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.528465  Lock_time: 0.000188 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350980002;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:13:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.566781  Lock_time: 0.000109 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350980003;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:14:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.702843  Lock_time: 0.000281 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350980061;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:14:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.797844  Lock_time: 0.000130 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350980082;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.332387  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350980082;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.736116  Lock_time: 0.000102 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350980116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:16:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.111403  Lock_time: 0.000177 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350980197;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:16:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.922901  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350980198;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:16:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.619644  Lock_time: 0.000190 Rows_sent: 1493  Rows_examined: 6450362
SET timestamp=1350980200;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  1:16:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.140648  Lock_time: 0.000256 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350980204;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:18:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.592563  Lock_time: 0.000137 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350980339;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:19:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.164724  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350980340;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.439615  Lock_time: 0.000209 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350980404;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
# Time: 121023  1:21:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.175144  Lock_time: 0.000076 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350980471;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.194348  Lock_time: 0.000076 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350980471;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:22:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.478433  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 18413
SET timestamp=1350980524;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  1:22:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 150.806774  Lock_time: 0.000053 Rows_sent: 361  Rows_examined: 1038052
SET timestamp=1350980552;
SELECT id,`return`,university,disqualified,sent_date FROM sessions WHERE `sent`=1 AND `show`=1 AND `return` LIKE 'Q%' AND `sent_date` > '2012-09-23';
# Time: 121023  1:23:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 183.949506  Lock_time: 0.000131 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350980585;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:23:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 184.242621  Lock_time: 0.000118 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350980586;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:23:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.683322  Lock_time: 0.000113 Rows_sent: 65079  Rows_examined: 1734697
SET timestamp=1350980590;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  1:23:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.343822  Lock_time: 0.000210 Rows_sent: 16539  Rows_examined: 8077576
SET timestamp=1350980609;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:24:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.280741  Lock_time: 0.000122 Rows_sent: 125  Rows_examined: 1043805
SET timestamp=1350980692;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:24:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.043886  Lock_time: 0.000160 Rows_sent: 468  Rows_examined: 1241759
SET timestamp=1350980693;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:25:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.447513  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350980716;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:26:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.884571  Lock_time: 0.000238 Rows_sent: 16539  Rows_examined: 8077623
SET timestamp=1350980791;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:26:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.615031  Lock_time: 0.000131 Rows_sent: 125  Rows_examined: 1043807
SET timestamp=1350980797;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:26:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.152844  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1241761
SET timestamp=1350980798;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:26:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.797120  Lock_time: 0.000146 Rows_sent: 1493  Rows_examined: 6450371
SET timestamp=1350980806;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  1:28:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.627549  Lock_time: 0.000134 Rows_sent: 125  Rows_examined: 1043807
SET timestamp=1350980927;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:28:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.229864  Lock_time: 0.000143 Rows_sent: 468  Rows_examined: 1241761
SET timestamp=1350980928;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:28:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.991292  Lock_time: 0.000185 Rows_sent: 16539  Rows_examined: 8077669
SET timestamp=1350980933;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.268328  Lock_time: 0.000065 Rows_sent: 0  Rows_examined: 18416
SET timestamp=1350981003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  1:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.551633  Lock_time: 0.000097 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350981018;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.550502  Lock_time: 0.000115 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350981018;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
# Time: 121023  1:31:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.743458  Lock_time: 0.000117 Rows_sent: 125  Rows_examined: 1043807
SET timestamp=1350981074;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:31:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.531500  Lock_time: 0.000162 Rows_sent: 468  Rows_examined: 1241761
SET timestamp=1350981075;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:31:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.786108  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1241761
SET timestamp=1350981106;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  1:31:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.160364  Lock_time: 0.000216 Rows_sent: 16539  Rows_examined: 8077669
SET timestamp=1350981113;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:32:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.069432  Lock_time: 0.000065 Rows_sent: 0  Rows_examined: 18416
SET timestamp=1350981122;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  1:32:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.311351  Lock_time: 0.000233 Rows_sent: 3  Rows_examined: 29322
SET timestamp=1350981135;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  1:33:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.752535  Lock_time: 0.000154 Rows_sent: 125  Rows_examined: 1043807
SET timestamp=1350981204;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.391336  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1241761
SET timestamp=1350981204;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:34:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.238207  Lock_time: 0.000163 Rows_sent: 125  Rows_examined: 1043807
SET timestamp=1350981289;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:34:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.806139  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241761
SET timestamp=1350981290;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:34:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.677856  Lock_time: 0.000191 Rows_sent: 16539  Rows_examined: 8077669
SET timestamp=1350981296;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:35:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.110586  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1350981317;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:36:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.236734  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1241762
SET timestamp=1350981370;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  1:36:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.101669  Lock_time: 0.000129 Rows_sent: 125  Rows_examined: 1043809
SET timestamp=1350981402;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:36:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.796793  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1241763
SET timestamp=1350981403;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:36:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.133442  Lock_time: 0.000148 Rows_sent: 1493  Rows_examined: 6450388
SET timestamp=1350981408;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  1:37:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.607648  Lock_time: 0.000072 Rows_sent: 468  Rows_examined: 1241763
SET timestamp=1350981474;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  1:38:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.239205  Lock_time: 0.000226 Rows_sent: 16539  Rows_examined: 8077735
SET timestamp=1350981480;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:38:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.111099  Lock_time: 0.000097 Rows_sent: 13  Rows_examined: 45
SET timestamp=1350981525;
SELECT DISTINCT tags.tag FROM tags,programs WHERE tags.interest_area='healthcare' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id) AND tags.active=1 ORDER BY tag;
# Time: 121023  1:38:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.760875  Lock_time: 0.000126 Rows_sent: 125  Rows_examined: 1043809
SET timestamp=1350981531;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:38:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.311800  Lock_time: 0.000079 Rows_sent: 468  Rows_examined: 1241763
SET timestamp=1350981532;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:39:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.024492  Lock_time: 0.000088 Rows_sent: 13  Rows_examined: 45
SET timestamp=1350981561;
SELECT DISTINCT tags.tag FROM tags,programs WHERE tags.interest_area='healthcare' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id) AND tags.active=1 ORDER BY tag;
# Time: 121023  1:40:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.229743  Lock_time: 0.000124 Rows_sent: 1  Rows_examined: 29633
SET timestamp=1350981618;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.230642  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 29633
SET timestamp=1350981618;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:40:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.144396  Lock_time: 0.000085 Rows_sent: 13  Rows_examined: 45
SET timestamp=1350981619;
SELECT DISTINCT tags.tag FROM tags,programs WHERE tags.interest_area='healthcare' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id) AND tags.active=1 ORDER BY tag;
# Time: 121023  1:40:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.872628  Lock_time: 0.000159 Rows_sent: 468  Rows_examined: 1241764
SET timestamp=1350981631;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  1:41:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.870944  Lock_time: 0.000118 Rows_sent: 125  Rows_examined: 1043811
SET timestamp=1350981669;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:41:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.498453  Lock_time: 0.000158 Rows_sent: 468  Rows_examined: 1241765
SET timestamp=1350981670;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:41:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.424093  Lock_time: 0.000241 Rows_sent: 16539  Rows_examined: 8077737
SET timestamp=1350981676;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:42:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.934367  Lock_time: 0.000140 Rows_sent: 125  Rows_examined: 1043811
SET timestamp=1350981761;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.126388  Lock_time: 0.000178 Rows_sent: 468  Rows_examined: 1241765
SET timestamp=1350981761;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.544632  Lock_time: 0.000120 Rows_sent: 65079  Rows_examined: 1734711
SET timestamp=1350981776;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  1:44:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.325748  Lock_time: 0.000163 Rows_sent: 16539  Rows_examined: 8077737
SET timestamp=1350981857;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:44:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.712951  Lock_time: 0.000104 Rows_sent: 125  Rows_examined: 1043811
SET timestamp=1350981895;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:44:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.640716  Lock_time: 0.000139 Rows_sent: 468  Rows_examined: 1241766
SET timestamp=1350981896;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.908175  Lock_time: 0.000132 Rows_sent: 468  Rows_examined: 1241765
SET timestamp=1350981896;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:45:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.973266  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350981914;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:46:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.059262  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18421
SET timestamp=1350981962;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  1:46:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.811252  Lock_time: 0.000142 Rows_sent: 125  Rows_examined: 1043812
SET timestamp=1350981992;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:46:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.887302  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1241766
SET timestamp=1350981993;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:46:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.257997  Lock_time: 0.000219 Rows_sent: 16539  Rows_examined: 8077738
SET timestamp=1350981998;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:47:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.321664  Lock_time: 0.000164 Rows_sent: 1493  Rows_examined: 6450404
SET timestamp=1350982024;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  1:48:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.088061  Lock_time: 0.000067 Rows_sent: 125  Rows_examined: 1043812
SET timestamp=1350982131;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
# Time: 121023  1:50:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.493231  Lock_time: 0.000218 Rows_sent: 16539  Rows_examined: 8077738
SET timestamp=1350982207;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.194920  Lock_time: 0.000068 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350982217;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.187345  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350982217;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:51:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.107744  Lock_time: 0.000110 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350982272;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:51:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.070671  Lock_time: 0.000067 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982273;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.085648  Lock_time: 0.000162 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982273;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  1:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.497540  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 18422
SET timestamp=1350982322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  1:52:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.283949  Lock_time: 0.000155 Rows_sent: 3  Rows_examined: 29329
SET timestamp=1350982335;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  1:52:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.400822  Lock_time: 0.000087 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982346;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  1:53:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.616024  Lock_time: 0.000135 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350982398;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:53:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.185117  Lock_time: 0.000166 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982399;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:53:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.315788  Lock_time: 0.000234 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350982405;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:54:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.136285  Lock_time: 0.000165 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350982487;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.674095  Lock_time: 0.000126 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982488;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.852575  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350982516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  1:56:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.623051  Lock_time: 0.000191 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350982583;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  1:56:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.010495  Lock_time: 0.000122 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350982601;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  1:56:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.523783  Lock_time: 0.000122 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982602;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:56:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.741441  Lock_time: 0.000245 Rows_sent: 1493  Rows_examined: 6450405
SET timestamp=1350982605;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  1:58:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.159957  Lock_time: 0.000134 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350982732;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
# Time: 121023  1:58:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.096483  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982733;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  1:58:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.357684  Lock_time: 0.000232 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350982738;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.461805  Lock_time: 0.000113 Rows_sent: 8  Rows_examined: 3586
SET timestamp=1350982804;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.912557  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350982804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:00:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.596258  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350982859;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.598039  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350982859;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  2:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.552072  Lock_time: 0.000044 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350982923;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:03:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 194.658359  Lock_time: 0.000119 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350982996;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 194.974082  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350982996;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:03:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 143.292464  Lock_time: 0.000216 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350983004;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:03:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.504826  Lock_time: 0.000130 Rows_sent: 65079  Rows_examined: 1734713
SET timestamp=1350983013;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  2:04:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.795753  Lock_time: 0.000135 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983097;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:04:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.825215  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350983098;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:05:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.575099  Lock_time: 0.000228 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350983106;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:05:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.753530  Lock_time: 0.000114 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350983118;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:06:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.287387  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350983163;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:06:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.358355  Lock_time: 0.000099 Rows_sent: 17  Rows_examined: 1761
SET timestamp=1350983170;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:18:06' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  2:06:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.058801  Lock_time: 0.000217 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983218;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.997299  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350983218;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:07:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 177.126586  Lock_time: 0.000164 Rows_sent: 1493  Rows_examined: 6450405
SET timestamp=1350983279;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  2:08:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.667221  Lock_time: 0.020754 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350983319;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:08:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.110772  Lock_time: 0.010067 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983329;
# Time: 121023  2:10:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.775749  Lock_time: 0.000128 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350983428;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.279822  Lock_time: 0.000149 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350983428;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:11:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.735140  Lock_time: 1.737018 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983482;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.935197  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350983482;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:11:26
# User@Host: root[root] @ localhost []
# Query_time: 2.639223  Lock_time: 0.000076 Rows_sent: 310  Rows_examined: 310
SET timestamp=1350983486;
SHOW /*!50002 GLOBAL */ STATUS;
# Time: 121023  2:11:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.658761  Lock_time: 0.000281 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350983512;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:12:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.203988  Lock_time: 0.000156 Rows_sent: 3  Rows_examined: 29330
SET timestamp=1350983538;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  2:13:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.568406  Lock_time: 0.000089 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983608;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:13:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.591319  Lock_time: 0.038825 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350983609;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:13:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.919008  Lock_time: 0.000173 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350983638;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:15:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.329784  Lock_time: 0.000142 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983712;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:15:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.050759  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350983713;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:15:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.185378  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350983714;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:16:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.341924  Lock_time: 0.000099 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983803;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:16:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.356379  Lock_time: 0.138194 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350983804;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:16:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.833051  Lock_time: 0.000184 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350983811;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:17:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 176.313936  Lock_time: 0.008561 Rows_sent: 1493  Rows_examined: 6450405
SET timestamp=1350983877;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  2:18:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.699225  Lock_time: 0.000115 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350983936;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.251364  Lock_time: 0.000068 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350983936;
# Time: 121023  2:20:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.378972  Lock_time: 0.017499 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350984014;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:20:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.694055  Lock_time: 1.152114 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350984021;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.688957  Lock_time: 1.146839 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350984021;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:21:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.968751  Lock_time: 0.793182 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984071;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:21:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.677329  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984072;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:22:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.241207  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350984122;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:22:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.753018  Lock_time: 0.000124 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984179;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:23:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.009706  Lock_time: 0.000118 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984180;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:23:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.974669  Lock_time: 0.000245 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350984189;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:23:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.840924  Lock_time: 0.859775 Rows_sent: 65079  Rows_examined: 1734713
SET timestamp=1350984202;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  2:25:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.865528  Lock_time: 0.000190 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984321;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:25:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.146909  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984324;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:25:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.830236  Lock_time: 0.131006 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350984329;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:26:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.468502  Lock_time: 0.000101 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984408;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:26:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.209289  Lock_time: 0.047858 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984409;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:26:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 113.098216  Lock_time: 0.000150 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350984415;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:28:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.772784  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350984484;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:28:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 220.366233  Lock_time: 0.000119 Rows_sent: 1493  Rows_examined: 6450405
SET timestamp=1350984522;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  2:29:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.384371  Lock_time: 0.000122 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984581;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.688916  Lock_time: 0.000171 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984581;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:29:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.080470  Lock_time: 0.000183 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350984588;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
# Time: 121023  2:30:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.239727  Lock_time: 0.000099 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350984636;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.232130  Lock_time: 0.000107 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350984636;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:31:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.972247  Lock_time: 0.000118 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984706;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:31:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.183616  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984707;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.125325  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350984723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:32:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.059129  Lock_time: 0.073687 Rows_sent: 3  Rows_examined: 29330
SET timestamp=1350984739;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  2:33:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.877417  Lock_time: 0.000295 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350984788;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:33:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.596383  Lock_time: 0.000109 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984792;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.868787  Lock_time: 0.000076 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984792;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:35:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.352602  Lock_time: 0.079987 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350984916;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:35:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.819175  Lock_time: 0.000086 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350984919;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:35:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.199920  Lock_time: 0.027543 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350984920;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:35:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.812384  Lock_time: 0.000223 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350984926;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:36:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.595533  Lock_time: 0.000120 Rows_sent: 6  Rows_examined: 3748
SET timestamp=1350984965;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-22 19:12:04' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023  2:36:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.816987  Lock_time: 0.000123 Rows_sent: 17  Rows_examined: 1780
SET timestamp=1350984967;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 19:12:04' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  2:36:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.883767  Lock_time: 0.418249 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350985003;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:36:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.935801  Lock_time: 0.000135 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350985004;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:37:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.275053  Lock_time: 0.000058 Rows_sent: 8  Rows_examined: 262
SET timestamp=1350985050;
SELECT id FROM universities WHERE tier=5;
# Time: 121023  2:37:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 174.655670  Lock_time: 0.084103 Rows_sent: 1493  Rows_examined: 6450405
SET timestamp=1350985076;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  2:38:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  2:38:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.378925  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350985117;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:38:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.819499  Lock_time: 0.000110 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350985139;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.481135  Lock_time: 0.046724 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350985139;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:40:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.369309  Lock_time: 0.000044 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350985203;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:40:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.636515  Lock_time: 0.000074 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350985218;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.635949  Lock_time: 0.000078 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350985218;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:41:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.370094  Lock_time: 0.000093 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350985280;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:41:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.071218  Lock_time: 0.000179 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350985281;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:41:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.250936  Lock_time: 0.000154 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350985287;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:42:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.007975  Lock_time: 0.000070 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350985323;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.600062  Lock_time: 0.650822 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350985376;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.741764  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350985376;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:43:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.949203  Lock_time: 0.866714 Rows_sent: 65079  Rows_examined: 1734713
SET timestamp=1350985399;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  2:44:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.007916  Lock_time: 0.000042 Rows_sent: 0  Rows_examined: 18423
SET timestamp=1350985442;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:44:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.389769  Lock_time: 0.000217 Rows_sent: 16539  Rows_examined: 8077739
SET timestamp=1350985466;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:44:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.634779  Lock_time: 0.000133 Rows_sent: 125  Rows_examined: 1043813
SET timestamp=1350985489;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:44:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.719584  Lock_time: 0.000084 Rows_sent: 468  Rows_examined: 1241767
SET timestamp=1350985490;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:45:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.150501  Lock_time: 0.003255 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350985520;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:46:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.223841  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 18425
SET timestamp=1350985562;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:46:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.745538  Lock_time: 0.000107 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350985619;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:47:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.717539  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350985620;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:47:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.159144  Lock_time: 0.000126 Rows_sent: 16539  Rows_examined: 8077815
SET timestamp=1350985625;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
# Time: 121023  2:47:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 135.869680  Lock_time: 0.001267 Rows_sent: 1493  Rows_examined: 6450405
SET timestamp=1350985637;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  2:49:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.021571  Lock_time: 0.000097 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350985741;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.826326  Lock_time: 0.000157 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350985741;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:50:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.266222  Lock_time: 0.000076 Rows_sent: 0  Rows_examined: 18425
SET timestamp=1350985803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:50:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.983527  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350985818;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.010766  Lock_time: 0.000153 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350985818;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  2:50:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.081735  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8077815
SET timestamp=1350985824;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:51:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.577226  Lock_time: 0.000110 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350985885;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:51:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.414265  Lock_time: 0.000145 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350985886;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:52:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.667565  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 18425
SET timestamp=1350985923;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:52:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.164963  Lock_time: 0.128483 Rows_sent: 3  Rows_examined: 29335
SET timestamp=1350985956;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  2:54:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.573138  Lock_time: 0.000099 Rows_sent: 17  Rows_examined: 1780
SET timestamp=1350986045;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 19:12:04' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  2:54:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.579491  Lock_time: 0.040291 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350986056;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  2:54:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 135.056558  Lock_time: 0.207415 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350986057;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:54:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 140.850499  Lock_time: 0.140947 Rows_sent: 16539  Rows_examined: 8077815
SET timestamp=1350986062;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:55:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.345899  Lock_time: 0.000144 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350986119;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  2:55:29
# User@Host: root[root] @ localhost []
# Query_time: 4.304562  Lock_time: 0.000073 Rows_sent: 310  Rows_examined: 310
SET timestamp=1350986129;
SHOW /*!50002 GLOBAL */ STATUS;
# Time: 121023  2:56:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.333327  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 18425
SET timestamp=1350986164;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  2:56:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.811678  Lock_time: 0.181364 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350986205;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.958230  Lock_time: 0.000137 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350986205;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:56:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.448442  Lock_time: 0.000199 Rows_sent: 16539  Rows_examined: 8077815
SET timestamp=1350986211;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  2:57:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.342423  Lock_time: 0.000127 Rows_sent: 17  Rows_examined: 1780
SET timestamp=1350986225;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 19:12:04' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  2:57:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 128.458243  Lock_time: 0.027116 Rows_sent: 1493  Rows_examined: 6450406
SET timestamp=1350986230;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
# Time: 121023  2:58:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.325432  Lock_time: 0.000105 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350986336;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.810456  Lock_time: 0.000167 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350986336;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  2:59:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.083994  Lock_time: 0.000219 Rows_sent: 16539  Rows_examined: 8077815
SET timestamp=1350986383;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:00:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.349640  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18425
SET timestamp=1350986405;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.911934  Lock_time: 0.531814 Rows_sent: 5  Rows_examined: 3599
SET timestamp=1350986405;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.349440  Lock_time: 0.021961 Rows_sent: 17  Rows_examined: 1780
SET timestamp=1350986405;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 19:12:04' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  3:00:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.153722  Lock_time: 0.000127 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350986445;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.147112  Lock_time: 0.000121 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350986445;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:02:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.340941  Lock_time: 0.000087 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350986524;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:02:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 123.298990  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350986525;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:02:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.824454  Lock_time: 0.000166 Rows_sent: 16539  Rows_examined: 8077815
SET timestamp=1350986531;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:02:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.433837  Lock_time: 0.000133 Rows_sent: 65079  Rows_examined: 1734719
SET timestamp=1350986576;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  3:02:57
# User@Host: root[root] @ localhost []
# Query_time: 1.142032  Lock_time: 0.000071 Rows_sent: 310  Rows_examined: 310
SET timestamp=1350986577;
SHOW /*!50002 GLOBAL */ STATUS;
# Time: 121023  3:04:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.739013  Lock_time: 0.000136 Rows_sent: 125  Rows_examined: 1043815
SET timestamp=1350986698;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:04:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.551395  Lock_time: 0.000180 Rows_sent: 468  Rows_examined: 1241769
SET timestamp=1350986699;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:05:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.752389  Lock_time: 0.000232 Rows_sent: 16539  Rows_examined: 8077815
SET timestamp=1350986706;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:05:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.591527  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350986714;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:06:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.111598  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 18426
SET timestamp=1350986762;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:06:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.425116  Lock_time: 0.000084 Rows_sent: 125  Rows_examined: 1043816
SET timestamp=1350986795;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:06:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.437449  Lock_time: 0.000124 Rows_sent: 468  Rows_examined: 1241770
SET timestamp=1350986796;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:07:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 142.647673  Lock_time: 0.000151 Rows_sent: 1493  Rows_examined: 6450406
SET timestamp=1350986844;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  3:08:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.237058  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 18426
SET timestamp=1350986882;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:08:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.629467  Lock_time: 0.018362 Rows_sent: 16539  Rows_examined: 8077848
SET timestamp=1350986921;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
# Time: 121023  3:09:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.461381  Lock_time: 0.000092 Rows_sent: 125  Rows_examined: 1043816
SET timestamp=1350986957;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:09:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.952991  Lock_time: 0.000134 Rows_sent: 468  Rows_examined: 1241770
SET timestamp=1350986958;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.434169  Lock_time: 0.000149 Rows_sent: 25  Rows_examined: 530
SET timestamp=1350987004;
SELECT LOWER(stats_small.val),DATE_FORMAT(stats_small.datetime, '%Y-%m-%d %H:00:00') AS hr,COUNT(DISTINCT stats_small.session),SUBSTRING_INDEX(stats_small.host,'.',-2) AS domain FROM stats_small WHERE stats_small.name='utm_source' AND stats_small.datetime >= '2012-10-23' GROUP BY stats_small.val,hr,domain;
# Time: 121023  3:10:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.088285  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 18426
SET timestamp=1350987005;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:10:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.070916  Lock_time: 0.000091 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350987028;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.080221  Lock_time: 0.000092 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350987028;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:11:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.345376  Lock_time: 0.000075 Rows_sent: 86  Rows_examined: 172
SET timestamp=1350987086;
SELECT DISTINCT interest_area, tag FROM tags WHERE tags.active=1 ORDER BY FIELD(interest_area,'humanities','business','computer','education','healthcare','science','social_science','career'),tag;
# Time: 121023  3:11:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.492033  Lock_time: 0.000099 Rows_sent: 125  Rows_examined: 1043816
SET timestamp=1350987100;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:11:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.201044  Lock_time: 0.000115 Rows_sent: 468  Rows_examined: 1241770
SET timestamp=1350987101;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:11:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.711607  Lock_time: 0.000294 Rows_sent: 16539  Rows_examined: 8077848
SET timestamp=1350987107;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:12:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.150398  Lock_time: 2.502505 Rows_sent: 3  Rows_examined: 29336
SET timestamp=1350987143;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  3:13:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.976736  Lock_time: 0.000095 Rows_sent: 125  Rows_examined: 1043816
SET timestamp=1350987224;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:13:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.802291  Lock_time: 0.000135 Rows_sent: 468  Rows_examined: 1241770
SET timestamp=1350987225;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:14:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.157172  Lock_time: 0.000076 Rows_sent: 8  Rows_examined: 262
SET timestamp=1350987254;
SELECT id FROM universities WHERE tier=5;
# Time: 121023  3:15:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.054673  Lock_time: 0.000130 Rows_sent: 125  Rows_examined: 1043817
SET timestamp=1350987302;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:15:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.606609  Lock_time: 0.000137 Rows_sent: 5  Rows_examined: 4650
SET timestamp=1350987303;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Campus Explorer : Kaplan University - Online School'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Campus Explorer : Kaplan University - Online School'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023  3:15:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.474457  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1241771
SET timestamp=1350987305;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:15:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.745335  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350987322;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:15:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.118738  Lock_time: 0.000188 Rows_sent: 6  Rows_examined: 3713
SET timestamp=1350987323;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-22 18:18:06' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023  3:15:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 173.435802  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8077848
SET timestamp=1350987354;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:16:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.227633  Lock_time: 0.000103 Rows_sent: 24  Rows_examined: 20302
SET timestamp=1350987363;
SELECT DATE_FORMAT(date,'%H'),visitors FROM hits WHERE source='Facebook' AND DATE(date)='2012-10-21';
# Time: 121023  3:16:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.460358  Lock_time: 0.000095 Rows_sent: 125  Rows_examined: 1043818
SET timestamp=1350987404;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:16:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.303318  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1241772
SET timestamp=1350987405;
# Time: 121023  3:17:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 163.237979  Lock_time: 0.000138 Rows_sent: 1493  Rows_examined: 6450413
SET timestamp=1350987464;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  3:17:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.181162  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 160
SET timestamp=1350987475;
SELECT id_type, id_value, ad_text FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '24851923649';
# Time: 121023  3:18:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.303483  Lock_time: 0.000108 Rows_sent: 1  Rows_examined: 0
SET timestamp=1350987512;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  3:18:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.038912  Lock_time: 0.000115 Rows_sent: 1  Rows_examined: 0
SET timestamp=1350987513;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  3:19:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.447701  Lock_time: 0.000097 Rows_sent: 125  Rows_examined: 1043818
SET timestamp=1350987542;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.358047  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1241772
SET timestamp=1350987542;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:19:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 223.891814  Lock_time: 0.000150 Rows_sent: 16539  Rows_examined: 8077850
SET timestamp=1350987585;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.934872  Lock_time: 0.000154 Rows_sent: 26  Rows_examined: 572
SET timestamp=1350987604;
SELECT LOWER(stats_small.val),DATE_FORMAT(stats_small.datetime, '%Y-%m-%d %H:00:00') AS hr,COUNT(DISTINCT stats_small.session),SUBSTRING_INDEX(stats_small.host,'.',-2) AS domain FROM stats_small WHERE stats_small.name='utm_source' AND stats_small.datetime >= '2012-10-23' GROUP BY stats_small.val,hr,domain;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.709776  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 18429
SET timestamp=1350987604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:20:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.532301  Lock_time: 0.000148 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350987622;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.521290  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350987622;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:21:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.428471  Lock_time: 0.000131 Rows_sent: 125  Rows_examined: 1043819
SET timestamp=1350987690;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:21:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.461830  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241773
SET timestamp=1350987691;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:22:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.021432  Lock_time: 0.000127 Rows_sent: 125  Rows_examined: 1043819
SET timestamp=1350987773;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.204108  Lock_time: 0.000086 Rows_sent: 468  Rows_examined: 1241773
SET timestamp=1350987773;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:23:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.032551  Lock_time: 0.000168 Rows_sent: 16539  Rows_examined: 8077889
SET timestamp=1350987782;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:23:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.042415  Lock_time: 0.000084 Rows_sent: 65079  Rows_examined: 1734727
SET timestamp=1350987793;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  3:25:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.322263  Lock_time: 0.000105 Rows_sent: 125  Rows_examined: 1043819
SET timestamp=1350987900;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.150966  Lock_time: 0.000185 Rows_sent: 468  Rows_examined: 1241773
SET timestamp=1350987900;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:25:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.436545  Lock_time: 0.000084 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350987921;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:26:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.377493  Lock_time: 0.000101 Rows_sent: 0  Rows_examined: 18429
SET timestamp=1350987964;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:26:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.854685  Lock_time: 0.000147 Rows_sent: 125  Rows_examined: 1043819
SET timestamp=1350987998;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:26:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.266097  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1241773
SET timestamp=1350987999;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:26:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  3:28:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 181.939715  Lock_time: 0.000120 Rows_sent: 1493  Rows_examined: 6450414
SET timestamp=1350988083;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  3:28:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.537011  Lock_time: 0.000101 Rows_sent: 0  Rows_examined: 18429
SET timestamp=1350988084;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:28:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.034297  Lock_time: 0.000154 Rows_sent: 125  Rows_examined: 1043819
SET timestamp=1350988128;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.248433  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1241773
SET timestamp=1350988128;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:29:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.605246  Lock_time: 0.000234 Rows_sent: 16539  Rows_examined: 8077889
SET timestamp=1350988143;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.411577  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18431
SET timestamp=1350988204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:30:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.093071  Lock_time: 0.000091 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350988222;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.159565  Lock_time: 0.000087 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350988222;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  3:31:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.638452  Lock_time: 0.000143 Rows_sent: 125  Rows_examined: 1043821
SET timestamp=1350988290;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:31:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.841392  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241775
SET timestamp=1350988291;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:32:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.744228  Lock_time: 0.000072 Rows_sent: 0  Rows_examined: 18431
SET timestamp=1350988327;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:32:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.201920  Lock_time: 0.000196 Rows_sent: 3  Rows_examined: 29341
SET timestamp=1350988343;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  3:33:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.407911  Lock_time: 0.000149 Rows_sent: 125  Rows_examined: 1043821
SET timestamp=1350988407;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:33:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.621456  Lock_time: 0.000142 Rows_sent: 468  Rows_examined: 1241775
SET timestamp=1350988409;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:33:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 152.929565  Lock_time: 0.000240 Rows_sent: 16539  Rows_examined: 8077971
SET timestamp=1350988414;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:34:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.837497  Lock_time: 0.000154 Rows_sent: 125  Rows_examined: 1043824
SET timestamp=1350988498;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:35:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.191826  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1241778
SET timestamp=1350988500;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:35:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.418158  Lock_time: 0.000203 Rows_sent: 16539  Rows_examined: 8078012
SET timestamp=1350988512;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:35:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.765131  Lock_time: 0.000096 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350988516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:36:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.614892  Lock_time: 0.000066 Rows_sent: 0  Rows_examined: 18436
SET timestamp=1350988563;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:36:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.917682  Lock_time: 0.000138 Rows_sent: 125  Rows_examined: 1043826
SET timestamp=1350988598;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
# Time: 121023  3:36:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.650876  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1241780
SET timestamp=1350988599;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:37:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 174.575515  Lock_time: 0.000147 Rows_sent: 1493  Rows_examined: 6450447
SET timestamp=1350988676;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  3:38:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.804043  Lock_time: 0.000230 Rows_sent: 16539  Rows_examined: 8078089
SET timestamp=1350988680;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:38:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.433128  Lock_time: 0.000128 Rows_sent: 125  Rows_examined: 1043826
SET timestamp=1350988725;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:38:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.064891  Lock_time: 0.000174 Rows_sent: 468  Rows_examined: 1241780
SET timestamp=1350988726;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:40:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.280304  Lock_time: 0.000065 Rows_sent: 0  Rows_examined: 18436
SET timestamp=1350988802;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:40:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.311673  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350988821;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.386618  Lock_time: 0.000134 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350988821;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:41:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.238506  Lock_time: 0.000152 Rows_sent: 125  Rows_examined: 1043826
SET timestamp=1350988882;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:41:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.926730  Lock_time: 0.000141 Rows_sent: 468  Rows_examined: 1241780
SET timestamp=1350988883;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:41:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.845946  Lock_time: 0.000239 Rows_sent: 16539  Rows_examined: 8078089
SET timestamp=1350988902;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.087415  Lock_time: 0.000132 Rows_sent: 125  Rows_examined: 1043826
SET timestamp=1350988976;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:42:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.884404  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1241780
SET timestamp=1350988977;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:43:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.890683  Lock_time: 0.000163 Rows_sent: 65079  Rows_examined: 1734744
SET timestamp=1350988996;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  3:44:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.854541  Lock_time: 0.000092 Rows_sent: 0  Rows_examined: 18437
SET timestamp=1350989043;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:44:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.737867  Lock_time: 0.000234 Rows_sent: 16539  Rows_examined: 8078089
SET timestamp=1350989097;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:45:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.425735  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350989118;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:45:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.278779  Lock_time: 0.000148 Rows_sent: 125  Rows_examined: 1043826
SET timestamp=1350989121;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:45:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.412772  Lock_time: 0.000115 Rows_sent: 468  Rows_examined: 1241780
SET timestamp=1350989123;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:46:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.337470  Lock_time: 0.000073 Rows_sent: 125  Rows_examined: 1043826
SET timestamp=1350989192;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:46:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.485424  Lock_time: 0.000066 Rows_sent: 468  Rows_examined: 1241780
SET timestamp=1350989193;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
# Time: 121023  3:46:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.550333  Lock_time: 0.000157 Rows_sent: 16539  Rows_examined: 8078089
SET timestamp=1350989199;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:47:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 132.982219  Lock_time: 0.000147 Rows_sent: 1493  Rows_examined: 6450447
SET timestamp=1350989234;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  3:48:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.342467  Lock_time: 0.000102 Rows_sent: 125  Rows_examined: 1043827
SET timestamp=1350989337;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:48:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.942189  Lock_time: 0.000166 Rows_sent: 468  Rows_examined: 1241781
SET timestamp=1350989338;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.417524  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 18438
SET timestamp=1350989404;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  3:50:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.603534  Lock_time: 0.000216 Rows_sent: 16539  Rows_examined: 8078122
SET timestamp=1350989412;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:50:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.477219  Lock_time: 0.000135 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350989418;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.480029  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350989418;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:51:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.979533  Lock_time: 0.000160 Rows_sent: 125  Rows_examined: 1043827
SET timestamp=1350989467;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:51:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.679016  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1241781
SET timestamp=1350989468;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.468694  Lock_time: 0.000152 Rows_sent: 3  Rows_examined: 29348
SET timestamp=1350989536;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  3:53:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.860421  Lock_time: 0.000121 Rows_sent: 125  Rows_examined: 1043827
SET timestamp=1350989601;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:53:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.512368  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1241781
SET timestamp=1350989602;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:53:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.698090  Lock_time: 0.000202 Rows_sent: 16539  Rows_examined: 8078122
SET timestamp=1350989608;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:54:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.125428  Lock_time: 0.000122 Rows_sent: 125  Rows_examined: 1043827
SET timestamp=1350989690;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.664065  Lock_time: 0.000149 Rows_sent: 468  Rows_examined: 1241781
SET timestamp=1350989690;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.251103  Lock_time: 0.000119 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350989716;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  3:56:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.910252  Lock_time: 0.000184 Rows_sent: 16539  Rows_examined: 8078122
SET timestamp=1350989785;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  3:56:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.934720  Lock_time: 0.000130 Rows_sent: 125  Rows_examined: 1043827
SET timestamp=1350989802;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:56:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.340348  Lock_time: 0.000178 Rows_sent: 468  Rows_examined: 1241781
SET timestamp=1350989803;
SELECT /* Memcached:leads_allocations */
# Time: 121023  3:56:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.719607  Lock_time: 0.000157 Rows_sent: 1493  Rows_examined: 6450447
SET timestamp=1350989804;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  3:58:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.988088  Lock_time: 0.000186 Rows_sent: 125  Rows_examined: 1043828
SET timestamp=1350989932;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  3:58:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.856861  Lock_time: 0.000121 Rows_sent: 468  Rows_examined: 1241782
SET timestamp=1350989933;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  3:58:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.275055  Lock_time: 0.000182 Rows_sent: 16539  Rows_examined: 8078155
SET timestamp=1350989938;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.301228  Lock_time: 0.000067 Rows_sent: 20  Rows_examined: 367
SET timestamp=1350990003;
SELECT
    interest.id,
    interest.data
FROM
    interest
    LEFT JOIN interest_ext ON (
        interest.id = interest_ext.interest_id
    )
WHERE
    interest_ext.interest_id IS NULL
--    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
AND interest.id > 851952
LIMIT
    20;
# Time: 121023  4:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.899029  Lock_time: 0.000045 Rows_sent: 1781  Rows_examined: 1781
SET timestamp=1350990004;
SELECT data FROM interest WHERE datetime>='2012-10-22 00:00:00' AND datetime<='2012-10-22 23:59:59';
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.930562  Lock_time: 0.000134 Rows_sent: 12  Rows_examined: 3616
SET timestamp=1350990004;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.164967  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 18439
SET timestamp=1350990004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  4:00:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.965384  Lock_time: 0.000034 Rows_sent: 8931  Rows_examined: 8931
SET timestamp=1350990009;
SELECT data FROM interest WHERE datetime>='2012-10-15 00:00:00' AND datetime<='2012-10-21 23:59:59';
# Time: 121023  4:00:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.944329  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350990053;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.952313  Lock_time: 0.000149 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350990053;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  4:01:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.316843  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 181410
SET timestamp=1350990077;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="University of Phoenix - General";
# Time: 121023  4:01:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.295027  Lock_time: 0.000119 Rows_sent: 1  Rows_examined: 33760
SET timestamp=1350990081;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Kaplan University - Main B Bachelor";
# Time: 121023  4:01:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.401207  Lock_time: 0.000095 Rows_sent: 1  Rows_examined: 46985
SET timestamp=1350990084;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Kaplan University - Main C Bachelor";
# Time: 121023  4:01:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.122961  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 18648
SET timestamp=1350990089;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Kaplan University - Main A Bachelor";
# Time: 121023  4:01:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.310332  Lock_time: 0.000065 Rows_sent: 1  Rows_examined: 82953
SET timestamp=1350990105;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Full Sail University - Online";
# Time: 121023  4:01:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.622706  Lock_time: 0.000108 Rows_sent: 125  Rows_examined: 1043828
SET timestamp=1350990107;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.997259  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241782
SET timestamp=1350990107;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:01:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.928384  Lock_time: 0.000266 Rows_sent: 16539  Rows_examined: 8078155
SET timestamp=1350990114;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:02:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.941327  Lock_time: 0.000103 Rows_sent: 125  Rows_examined: 1043828
SET timestamp=1350990162;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:02:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.302535  Lock_time: 0.000118 Rows_sent: 468  Rows_examined: 1241782
SET timestamp=1350990163;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:02:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.919415  Lock_time: 0.000157 Rows_sent: 65079  Rows_examined: 1734750
SET timestamp=1350990172;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  4:04:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.258884  Lock_time: 0.000103 Rows_sent: 125  Rows_examined: 1043828
SET timestamp=1350990292;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:04:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.851399  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1241782
SET timestamp=1350990293;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:04:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.028462  Lock_time: 0.000250 Rows_sent: 16539  Rows_examined: 8078155
SET timestamp=1350990299;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:05:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.269579  Lock_time: 0.000116 Rows_sent: 2128  Rows_examined: 109109
SET timestamp=1350990308;
SELECT
    DATE_FORMAT(interest.`datetime`, '%Y-%m-%d') AS mydate,
    allocations.id,
    count(1) AS visits
FROM
    interest
    JOIN interest_ext ON (
        interest.id = interest_ext.interest_id
    ) JOIN programs ON (
        interest_ext.program_id = programs.id
    ) JOIN allocations ON (
        programs.allocation_id = allocations.id
    )
WHERE
    interest.`datetime` BETWEEN '2012-10-01 00:00:00' AND '2012-10-31 23:59:59'
    AND interest.affiliate IN ('Google','Adsense','Facebook','Bing','AdKnowledge','Reply','LookSmart')
GROUP BY
    mydate,
    id;
# Time: 121023  4:05:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.059260  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350990317;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:06:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.075578  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 18439
SET timestamp=1350990362;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  4:06:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.399446  Lock_time: 0.000149 Rows_sent: 125  Rows_examined: 1043828
SET timestamp=1350990387;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:06:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.506704  Lock_time: 0.000135 Rows_sent: 468  Rows_examined: 1241782
SET timestamp=1350990388;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:07:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 132.998177  Lock_time: 0.000153 Rows_sent: 1493  Rows_examined: 6450447
SET timestamp=1350990434;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  4:08:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.821306  Lock_time: 0.000170 Rows_sent: 16539  Rows_examined: 8078155
SET timestamp=1350990488;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:08:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.368754  Lock_time: 0.000177 Rows_sent: 125  Rows_examined: 1043829
SET timestamp=1350990529;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:08:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.842664  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1241783
SET timestamp=1350990530;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
# Time: 121023  4:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.293800  Lock_time: 0.000122 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350990619;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.299102  Lock_time: 0.000096 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350990619;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:11:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.785796  Lock_time: 0.000097 Rows_sent: 125  Rows_examined: 1043829
SET timestamp=1350990675;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.434263  Lock_time: 0.000164 Rows_sent: 468  Rows_examined: 1241783
SET timestamp=1350990675;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:11:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.907693  Lock_time: 0.000266 Rows_sent: 16539  Rows_examined: 8078188
SET timestamp=1350990681;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:12:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.107192  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18442
SET timestamp=1350990723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  4:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.631731  Lock_time: 0.000151 Rows_sent: 3  Rows_examined: 29352
SET timestamp=1350990736;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  4:13:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.088060  Lock_time: 0.000150 Rows_sent: 125  Rows_examined: 1043829
SET timestamp=1350990803;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:13:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.046469  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1241783
SET timestamp=1350990804;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:14:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.420070  Lock_time: 0.000213 Rows_sent: 16539  Rows_examined: 8078188
SET timestamp=1350990854;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:14:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.831943  Lock_time: 0.000104 Rows_sent: 125  Rows_examined: 1043831
SET timestamp=1350990887;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:14:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.537084  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1241785
SET timestamp=1350990888;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:15:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.492699  Lock_time: 0.000102 Rows_sent: 5  Rows_examined: 4649
SET timestamp=1350990903;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Campus Explorer : Kaplan University - Online School'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Campus Explorer : Kaplan University - Online School'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023  4:15:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.452833  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350990915;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:16:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.289606  Lock_time: 0.000124 Rows_sent: 125  Rows_examined: 1043831
SET timestamp=1350990994;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:16:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.993825  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1241785
SET timestamp=1350990995;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:16:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.339872  Lock_time: 0.000100 Rows_sent: 1493  Rows_examined: 6450450
SET timestamp=1350990997;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  4:16:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.464125  Lock_time: 0.000166 Rows_sent: 16539  Rows_examined: 8078228
SET timestamp=1350991000;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:18:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.089311  Lock_time: 0.000123 Rows_sent: 125  Rows_examined: 1043831
SET timestamp=1350991139;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.692181  Lock_time: 0.000221 Rows_sent: 468  Rows_examined: 1241785
SET timestamp=1350991139;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:20:04
# Time: 121023  4:20:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.929475  Lock_time: 0.000191 Rows_sent: 16539  Rows_examined: 8078267
SET timestamp=1350991211;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:20:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.131068  Lock_time: 0.000073 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350991218;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.140702  Lock_time: 0.000073 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350991218;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:21:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.506061  Lock_time: 0.000119 Rows_sent: 125  Rows_examined: 1043832
SET timestamp=1350991271;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:21:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.215233  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1241786
SET timestamp=1350991272;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:22:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.400130  Lock_time: 0.000097 Rows_sent: 125  Rows_examined: 1043832
SET timestamp=1350991362;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.663110  Lock_time: 0.000088 Rows_sent: 468  Rows_examined: 1241786
SET timestamp=1350991362;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:22:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.862719  Lock_time: 0.000208 Rows_sent: 16539  Rows_examined: 8078267
SET timestamp=1350991370;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:22:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.258885  Lock_time: 0.000220 Rows_sent: 65080  Rows_examined: 1734760
SET timestamp=1350991376;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  4:24:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.690597  Lock_time: 0.000101 Rows_sent: 125  Rows_examined: 1043832
SET timestamp=1350991495;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.346649  Lock_time: 0.000164 Rows_sent: 468  Rows_examined: 1241786
SET timestamp=1350991495;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:25:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.018099  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1350991518;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:26:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.553310  Lock_time: 0.000131 Rows_sent: 125  Rows_examined: 1043832
SET timestamp=1350991590;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.800795  Lock_time: 0.000135 Rows_sent: 468  Rows_examined: 1241786
SET timestamp=1350991590;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:26:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.610986  Lock_time: 0.000207 Rows_sent: 16539  Rows_examined: 8078222
SET timestamp=1350991592;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:26:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.170688  Lock_time: 0.000133 Rows_sent: 1493  Rows_examined: 6450451
SET timestamp=1350991599;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  4:28:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.706460  Lock_time: 0.000137 Rows_sent: 125  Rows_examined: 1043832
SET timestamp=1350991728;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.254069  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1241786
SET timestamp=1350991728;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:28:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.104472  Lock_time: 0.000273 Rows_sent: 16539  Rows_examined: 8078099
SET timestamp=1350991734;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
# Time: 121023  4:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.031010  Lock_time: 0.000112 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350991818;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.039349  Lock_time: 0.000089 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1350991818;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:31:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.810862  Lock_time: 0.000163 Rows_sent: 125  Rows_examined: 1043832
SET timestamp=1350991876;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:31:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.678560  Lock_time: 0.000126 Rows_sent: 468  Rows_examined: 1241786
SET timestamp=1350991877;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:31:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.207731  Lock_time: 0.000663 Rows_sent: 0  Rows_examined: 53700
SET timestamp=1350991887;
SELECT universities.id,tags.interest_area,GROUP_CONCAT(DISTINCT CONCAT_WS('^',programs.id, programs.name, programs.code, programs.external_id, schools.name,(CASE programs.tag1 WHEN 23 THEN 20 ELSE 0 END + CASE programs.tag2 WHEN 23 THEN 2 ELSE 0 END + CASE programs.tag3 WHEN 23 THEN 1 ELSE 0 END + CASE programs.tag1 WHEN -1 THEN 1 ELSE 0 END)) ORDER BY CASE programs.tag1 WHEN 23 THEN 20 ELSE 0 END + CASE programs.tag2 WHEN 23 THEN 2 ELSE 0 END + CASE programs.tag3 WHEN 23 THEN 1 ELSE 0 END + CASE programs.tag1 WHEN -1 THEN 1 ELSE 0 END DESC,tags.interest_area,programs.name,schools.name SEPARATOR '@'), universities.name, universities.description, universities.logo, GROUP_CONCAT(DISTINCT schools.name SEPARATOR ', '), programs.lead_price,NULL,SUM(CASE programs.tag1 WHEN 23 THEN 20 ELSE 0 END + CASE programs.tag2 WHEN 23 THEN 2 ELSE 0 END + CASE programs.tag3 WHEN 23 THEN 1 ELSE 0 END + CASE programs.tag1 WHEN -1 THEN 1 ELSE 0 END) AS score FROM universities,schools,programs,tags WHERE programs.university_id=universities.id AND universities.active=1 AND programs.school_id=schools.id AND schools.university_id=universities.id AND programs.active=1 AND programs.online=1 AND programs.degree_type='certificate' AND (tags.id='23' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id)) AND (universities.id NOT IN (104,105,150,179,180,213,214) OR programs.code NOT IN ('BSN','FNP','LVN/BSN','MSN','MSN/ED','MSN/FNP','MSN/INF','MSN/MBA/HC','MSN/MHA','NHCE','P/VN/BSN','PHD/NUR')) AND (programs.allocation_id IN (26,29,31,32,33,34,46,49,106,172,175,176,178,179,183,196,210,211,213,215,216,220,221,222,258,259,280,281,282,284,310,313,316,318,319,335,338,340,342,343,344,347,348,349,351,352,353,354,355,356,357,358,359,360,361,362,364,380,387,388,389,391,392,401,402,403,404,406,408,409,414,416,436,437,438,439,440,441,457,458,467,468,469,498,499,507,510,520,531,532,535,537,538,548,550,551,552,555,558,559,561,563,564,565,566,567,568,569,570,571,573,574,575,576,577,578,579,580,581,584,585,589,590,591,592)) AND programs.id NOT IN (8960,31067,31163,31226,44239,44248,44249,44743,45168,45177,87125,87958,124616,124728,124741,124882,125159,196677,196681,212939,212940,213550,233620,252367,252368) AND universities.id NOT IN (37,181,24,211,212,129,68,67,84,43,91,57,77,78,79,124,82,168,73,65,102,228,25,26,272,264,258,169,7,8,10,13,14,170,177,120,90,210,109,140,247,252,245,246,257,260,125,126,132,104,105,213,214,179,180,121,122,146,241,71,187,189,242,243,150,185,194,219,220,221,224,225,15,118,119,137,138,139,184,193,195,222,223,226,216,217,218,237,141,142,114,16,130,133,134,66,89,203,206,249,70,123,205,208,106,204,207,69,127,227,240,96,95,98,93,94) AND programs.id NOT IN (119900,119901,114597,119888,119887,119905,110516,110517,28155,27361,27414,27453,27477,27508,27539,27583,27617,27648,27685,27727,27770,26896,26897,26898,26899,26900,26901,30567,30572,30585,30589,30603,30606,30625,30626,30628,30637,30649,30650,26657,26675,26676,26678,44262,30711,30712,87968,17513,17575,87037,87099,108318,78397,119098,119099,119384,119596,119597,73203,73204,87442,87461,87460,87456,87457,87458,87459,229977,229978,229979,229980,228990,44743,249972,249971,212959,110428) AND programs.allocation_id NOT IN (254,255,291,410,514,515,516,517,518,584,593,568,586,587,588,589,590,591,592,175,176,522,210,309,153,0) AND programs.school_id NOT IN (278,547,553,883,1123,1124,1125,1126,1127,1128,125,2160,1739,1712,1711,109,1434,1445,1758,1767,1780,1836,2512,2523,2565,2576,2587,3058,3069,3080,3091,3102,3113,3133,3144,3155,3166,3177,3257,1421,1703,1709,1130) AND programs.code NOT IN ('MSN_ANP','MSN_FNP') AND universities.us_leads NOT IN (0) AND universities.non_profit NOT IN (1) AND schools.id NOT IN (3613,3600) AND universities.id != 67 AND universities.id != 68 GROUP BY universities.name ORDER BY programs.lead_price DESC,score DESC,universities.name;
# Time: 121023  4:31:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.794430  Lock_time: 0.000431 Rows_sent: 1  Rows_examined: 163286
SET timestamp=1350991892;
SELECT COUNT(programs.id) FROM universities, schools, programs, tags WHERE programs.university_id=universities.id AND universities.active=1 AND programs.school_id=schools.id AND programs.active=1 AND programs.degree_type='certificate' AND (tags.id='23' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id)) AND (universities.id NOT IN (104,105,150,179,180,213,214) OR programs.code NOT IN ('BSN','FNP','LVN/BSN','MSN','MSN/ED','MSN/FNP','MSN/INF','MSN/MBA/HC','MSN/MHA','NHCE','P/VN/BSN','PHD/NUR')) AND (programs.allocation_id IN (26,29,31,32,33,34,46,49,106,172,175,176,178,179,183,196,210,211,213,215,216,220,221,222,258,259,280,281,282,284,310,313,316,318,319,335,338,340,342,343,344,347,348,349,351,352,353,354,355,356,357,358,359,360,361,362,364,380,387,388,389,391,392,401,402,403,404,406,408,409,414,416,436,437,438,439,440,441,457,458,467,468,469,498,499,507,510,520,531,532,535,537,538,548,550,551,552,555,558,559,561,563,564,565,566,567,568,569,570,571,573,574,575,576,577,578,579,580,581,584,585,589,590,591,592)) AND programs.id NOT IN (8960,31067,31163,31226,44239,44248,44249,44743,45168,45177,87125,87958,124616,124728,124741,124882,125159,196677,196681,212939,212940,213550,233620,252367,252368) AND universities.id NOT IN (37,181,24,211,212,129,68,67,84,43,91,57,77,78,79,124,82,168,73,65,102,228,25,26,272,264,258,169,7,8,10,13,14,170,177,120,90,210,109,140,247,252,245,246,257,260,125,126,132,104,105,213,214,179,180,121,122,146,241,71,187,189,242,243,150,185,194,219,220,221,224,225,15,118,119,137,138,139,184,193,195,222,223,226,216,217,218,237,141,142,114,16,130,133,134,66,89,203,206,249,70,123,205,208,106,204,207,69,127,227,240,96,95,98,93,94) AND programs.id NOT IN (119900,119901,114597,119888,119887,119905,110516,110517,28155,27361,27414,27453,27477,27508,27539,27583,27617,27648,27685,27727,27770,26896,26897,26898,26899,26900,26901,30567,30572,30585,30589,30603,30606,30625,30626,30628,30637,30649,30650,26657,26675,26676,26678,44262,30711,30712,87968,17513,17575,87037,87099,108318,78397,119098,119099,119384,119596,119597,73203,73204,87442,87461,87460,87456,87457,87458,87459,229977,229978,229979,229980,228990,44743,249972,249971,212959,110428) AND programs.allocation_id NOT IN (254,255,291,410,514,515,516,517,518,584,593,568,586,587,588,589,590,591,592,175,176,522,210,309,153,0) AND programs.school_id NOT IN (278,547,553,883,1123,1124,1125,1126,1127,1128,125,2160,1739,1712,1711,109,1434,1445,1758,1767,1780,1836,2512,2523,2565,2576,2587,3058,3069,3080,3091,3102,3113,3133,3144,3155,3166,3177,3257,1421,1703,1709,1130) AND programs.code NOT IN ('MSN_ANP','MSN_FNP') AND universities.us_leads NOT IN (0) AND universities.non_profit NOT IN (1) AND schools.id NOT IN (3613,3600) AND universities.id != 67 AND universities.id != 68;
# Time: 121023  4:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.498844  Lock_time: 0.000066 Rows_sent: 0  Rows_examined: 18445
SET timestamp=1350991923;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  4:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.436225  Lock_time: 0.000208 Rows_sent: 3  Rows_examined: 29355
SET timestamp=1350991936;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  4:32:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.059525  Lock_time: 0.000213 Rows_sent: 16539  Rows_examined: 8077941
SET timestamp=1350991954;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:33:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.168440  Lock_time: 0.000098 Rows_sent: 13  Rows_examined: 45
SET timestamp=1350991984;
SELECT DISTINCT tags.tag FROM tags,programs WHERE tags.interest_area='healthcare' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id) AND tags.active=1 ORDER BY tag;
# Time: 121023  4:33:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.156012  Lock_time: 0.000080 Rows_sent: 13  Rows_examined: 45
SET timestamp=1350991988;
SELECT DISTINCT tags.tag FROM tags,programs WHERE tags.interest_area='healthcare' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id) AND tags.active=1 ORDER BY tag;
# Time: 121023  4:33:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.616027  Lock_time: 0.000125 Rows_sent: 125  Rows_examined: 1043833
SET timestamp=1350992000;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.200000  Lock_time: 0.000123 Rows_sent: 468  Rows_examined: 1241787
SET timestamp=1350992000;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:34:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.740867  Lock_time: 0.000190 Rows_sent: 125  Rows_examined: 1043833
SET timestamp=1350992086;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:34:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.291216  Lock_time: 0.000119 Rows_sent: 468  Rows_examined: 1241787
SET timestamp=1350992087;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:34:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  4:35:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.499907  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350992116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:36:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.426265  Lock_time: 0.000099 Rows_sent: 125  Rows_examined: 1043833
SET timestamp=1350992194;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.063370  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1241787
SET timestamp=1350992194;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:36:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.543409  Lock_time: 0.000169 Rows_sent: 1493  Rows_examined: 6450452
SET timestamp=1350992200;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  4:38:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.290055  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8077854
SET timestamp=1350992290;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:38:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.149699  Lock_time: 0.000080 Rows_sent: 13  Rows_examined: 45
SET timestamp=1350992316;
SELECT DISTINCT tags.tag FROM tags,programs WHERE tags.interest_area='healthcare' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id) AND tags.active=1 ORDER BY tag;
# Time: 121023  4:38:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.343985  Lock_time: 0.000084 Rows_sent: 125  Rows_examined: 1043833
SET timestamp=1350992332;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.873675  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1241787
SET timestamp=1350992332;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:40:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.207913  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 18448
SET timestamp=1350992403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  4:40:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.935830  Lock_time: 0.000122 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350992419;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.943509  Lock_time: 0.000112 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350992419;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:41:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.167338  Lock_time: 0.000099 Rows_sent: 125  Rows_examined: 1043835
SET timestamp=1350992477;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.836155  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1241789
SET timestamp=1350992477;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:41:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.666246  Lock_time: 0.000288 Rows_sent: 16539  Rows_examined: 8077934
SET timestamp=1350992483;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:42:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.064418  Lock_time: 0.000112 Rows_sent: 11  Rows_examined: 37
SET timestamp=1350992547;
SELECT DISTINCT tags.tag FROM tags,programs WHERE tags.interest_area='education' AND (programs.tag1=tags.id OR programs.tag2=tags.id OR programs.tag3=tags.id) AND tags.active=1 ORDER BY tag;
# Time: 121023  4:42:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.468136  Lock_time: 0.000116 Rows_sent: 125  Rows_examined: 1043837
SET timestamp=1350992563;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.809388  Lock_time: 0.000144 Rows_sent: 468  Rows_examined: 1241791
SET timestamp=1350992563;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.604925  Lock_time: 0.000150 Rows_sent: 65079  Rows_examined: 1734745
SET timestamp=1350992576;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  4:44:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.806911  Lock_time: 0.000210 Rows_sent: 16539  Rows_examined: 8078016
SET timestamp=1350992654;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:44:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.985525  Lock_time: 0.000202 Rows_sent: 125  Rows_examined: 1043837
SET timestamp=1350992692;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:45:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.027604  Lock_time: 0.000122 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350992715;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:46:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.829731  Lock_time: 0.000133 Rows_sent: 125  Rows_examined: 1043837
SET timestamp=1350992810;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:46:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.633853  Lock_time: 0.000114 Rows_sent: 468  Rows_examined: 1241791
SET timestamp=1350992811;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:46:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.956735  Lock_time: 0.000223 Rows_sent: 16539  Rows_examined: 8078016
SET timestamp=1350992816;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:47:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.684322  Lock_time: 0.000145 Rows_sent: 1493  Rows_examined: 6450472
SET timestamp=1350992824;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  4:48:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.116207  Lock_time: 0.000111 Rows_sent: 125  Rows_examined: 1043838
SET timestamp=1350992929;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:48:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.834077  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1241792
SET timestamp=1350992930;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.246181  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 18451
SET timestamp=1350993004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  4:50:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.237653  Lock_time: 0.000220 Rows_sent: 16539  Rows_examined: 8078046
SET timestamp=1350993006;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:50:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.245156  Lock_time: 0.000124 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350993018;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.241581  Lock_time: 0.000069 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350993018;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:51:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.942223  Lock_time: 0.000103 Rows_sent: 125  Rows_examined: 1043838
SET timestamp=1350993071;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:51:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.601652  Lock_time: 0.000078 Rows_sent: 468  Rows_examined: 1241792
SET timestamp=1350993072;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:52:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.094936  Lock_time: 0.004638 Rows_sent: 0  Rows_examined: 18451
SET timestamp=1350993124;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  4:52:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.000310  Lock_time: 0.000182 Rows_sent: 3  Rows_examined: 29361
SET timestamp=1350993137;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  4:52:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.529147  Lock_time: 0.000167 Rows_sent: 468  Rows_examined: 1241792
SET timestamp=1350993164;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  4:53:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.717720  Lock_time: 0.024992 Rows_sent: 125  Rows_examined: 1043838
SET timestamp=1350993198;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:53:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.492320  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1241792
SET timestamp=1350993199;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:53:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.952581  Lock_time: 0.000182 Rows_sent: 16539  Rows_examined: 8078046
SET timestamp=1350993204;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:53:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.723183  Lock_time: 0.000086 Rows_sent: 468  Rows_examined: 1241793
SET timestamp=1350993212;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  4:54:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.106005  Lock_time: 0.000087 Rows_sent: 468  Rows_examined: 1241793
SET timestamp=1350993270;
# Time: 121023  4:54:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.616537  Lock_time: 0.000134 Rows_sent: 125  Rows_examined: 1043839
SET timestamp=1350993284;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  4:54:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.867617  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1241793
SET timestamp=1350993285;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.288266  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350993316;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  4:56:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.251731  Lock_time: 0.000194 Rows_sent: 16539  Rows_examined: 8078090
SET timestamp=1350993390;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  4:56:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.084858  Lock_time: 0.000128 Rows_sent: 125  Rows_examined: 1043840
SET timestamp=1350993398;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.779320  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1241794
SET timestamp=1350993398;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:56:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.153636  Lock_time: 0.000123 Rows_sent: 1493  Rows_examined: 6450483
SET timestamp=1350993408;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  4:58:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.154846  Lock_time: 0.000157 Rows_sent: 125  Rows_examined: 1043840
SET timestamp=1350993527;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.775786  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1241794
SET timestamp=1350993527;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  4:58:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.050186  Lock_time: 0.000210 Rows_sent: 16539  Rows_examined: 8078090
SET timestamp=1350993534;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.621887  Lock_time: 0.000143 Rows_sent: 9  Rows_examined: 3637
SET timestamp=1350993604;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.937181  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 18456
SET timestamp=1350993604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:00:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.669863  Lock_time: 0.000110 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350993650;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.670714  Lock_time: 0.000137 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350993650;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  5:01:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.604596  Lock_time: 0.000082 Rows_sent: 1  Rows_examined: 0
SET timestamp=1350993680;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  5:02:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 120.232404  Lock_time: 0.000093 Rows_sent: 125  Rows_examined: 1043841
SET timestamp=1350993721;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.308061  Lock_time: 0.000189 Rows_sent: 468  Rows_examined: 1241795
SET timestamp=1350993723;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:02:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.940957  Lock_time: 0.000184 Rows_sent: 16539  Rows_examined: 8078137
SET timestamp=1350993728;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:02:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.962404  Lock_time: 0.000127 Rows_sent: 65080  Rows_examined: 1734758
SET timestamp=1350993767;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  5:04:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.840568  Lock_time: 0.000101 Rows_sent: 125  Rows_examined: 1043842
SET timestamp=1350993895;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:04:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.611801  Lock_time: 0.000138 Rows_sent: 468  Rows_examined: 1241796
SET timestamp=1350993896;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:05:03
# Time: 121023  5:05:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.261574  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350993916;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:06:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.025755  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 18457
SET timestamp=1350993962;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:06:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.140287  Lock_time: 0.000124 Rows_sent: 125  Rows_examined: 1043842
SET timestamp=1350993985;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:06:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.362613  Lock_time: 0.000155 Rows_sent: 468  Rows_examined: 1241796
SET timestamp=1350993986;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:07:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 120.888880  Lock_time: 0.000155 Rows_sent: 1493  Rows_examined: 6450492
SET timestamp=1350994022;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  5:08:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.799954  Lock_time: 0.000175 Rows_sent: 16539  Rows_examined: 8078176
SET timestamp=1350994086;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:08:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.600416  Lock_time: 0.000150 Rows_sent: 125  Rows_examined: 1043844
SET timestamp=1350994130;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:08:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.107691  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1241798
SET timestamp=1350994131;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.522942  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 18459
SET timestamp=1350994204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:10:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.323626  Lock_time: 0.000109 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350994218;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.314478  Lock_time: 0.000092 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350994218;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:11:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.550662  Lock_time: 0.000123 Rows_sent: 125  Rows_examined: 1043844
SET timestamp=1350994276;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.245344  Lock_time: 0.000169 Rows_sent: 468  Rows_examined: 1241798
SET timestamp=1350994276;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:11:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.547821  Lock_time: 0.000227 Rows_sent: 16539  Rows_examined: 8078223
SET timestamp=1350994282;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.195547  Lock_time: 0.000063 Rows_sent: 0  Rows_examined: 18461
SET timestamp=1350994322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.638935  Lock_time: 0.000183 Rows_sent: 3  Rows_examined: 29371
SET timestamp=1350994336;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  5:13:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.086710  Lock_time: 0.000173 Rows_sent: 125  Rows_examined: 1043846
SET timestamp=1350994403;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:13:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.991423  Lock_time: 0.000124 Rows_sent: 468  Rows_examined: 1241800
SET timestamp=1350994404;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:14:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.660125  Lock_time: 0.000206 Rows_sent: 16539  Rows_examined: 8078360
SET timestamp=1350994453;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:14:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.030230  Lock_time: 0.000132 Rows_sent: 125  Rows_examined: 1043847
SET timestamp=1350994488;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
# Time: 121023  5:14:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.733557  Lock_time: 0.000071 Rows_sent: 468  Rows_examined: 1241801
SET timestamp=1350994489;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:15:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.013699  Lock_time: 0.000135 Rows_sent: 1  Rows_examined: 890
SET timestamp=1350994503;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Campus Explorer : Argosy University Online'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Campus Explorer : Argosy University Online'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023  5:15:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.199245  Lock_time: 0.000079 Rows_sent: 17  Rows_examined: 1780
SET timestamp=1350994504;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 19:12:04' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  5:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.539567  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350994516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:16:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.331885  Lock_time: 0.000138 Rows_sent: 125  Rows_examined: 1043847
SET timestamp=1350994597;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:16:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.339712  Lock_time: 0.000124 Rows_sent: 468  Rows_examined: 1241801
SET timestamp=1350994598;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:16:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.286820  Lock_time: 0.000188 Rows_sent: 16539  Rows_examined: 8078360
SET timestamp=1350994604;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:16:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.801686  Lock_time: 0.000125 Rows_sent: 1493  Rows_examined: 6450512
SET timestamp=1350994612;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  5:18:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.020794  Lock_time: 0.000132 Rows_sent: 125  Rows_examined: 1043847
SET timestamp=1350994732;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:18:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.884388  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1241801
SET timestamp=1350994733;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.013463  Lock_time: 0.000065 Rows_sent: 0  Rows_examined: 18462
SET timestamp=1350994804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.855920  Lock_time: 0.000193 Rows_sent: 16539  Rows_examined: 8078360
SET timestamp=1350994804;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:20:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.228838  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350994818;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.233035  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350994818;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:21:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.784479  Lock_time: 0.000133 Rows_sent: 125  Rows_examined: 1043847
SET timestamp=1350994869;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:21:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.392727  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1241801
SET timestamp=1350994870;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:22:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.327845  Lock_time: 0.000095 Rows_sent: 125  Rows_examined: 1043847
SET timestamp=1350994962;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.465725  Lock_time: 0.000154 Rows_sent: 468  Rows_examined: 1241801
SET timestamp=1350994962;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:22:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.467052  Lock_time: 0.000236 Rows_sent: 16539  Rows_examined: 8078360
SET timestamp=1350994969;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:22:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.756704  Lock_time: 0.000108 Rows_sent: 65080  Rows_examined: 1734773
SET timestamp=1350994975;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  5:24:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.124709  Lock_time: 0.000168 Rows_sent: 125  Rows_examined: 1043847
SET timestamp=1350995095;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
# Time: 121023  5:24:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.801460  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241801
SET timestamp=1350995096;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:25:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.812987  Lock_time: 0.000112 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350995116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:26:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.398401  Lock_time: 0.000136 Rows_sent: 125  Rows_examined: 1043849
SET timestamp=1350995190;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.794991  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1241803
SET timestamp=1350995190;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:26:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.328519  Lock_time: 0.000199 Rows_sent: 16539  Rows_examined: 8078360
SET timestamp=1350995192;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:26:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.189984  Lock_time: 0.000120 Rows_sent: 1493  Rows_examined: 6450512
SET timestamp=1350995202;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  5:28:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.986441  Lock_time: 0.000169 Rows_sent: 125  Rows_examined: 1043851
SET timestamp=1350995327;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.522761  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241805
SET timestamp=1350995327;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:28:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.181912  Lock_time: 0.000214 Rows_sent: 16539  Rows_examined: 8078489
SET timestamp=1350995333;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.687383  Lock_time: 0.000100 Rows_sent: 0  Rows_examined: 18470
SET timestamp=1350995404;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.184717  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350995418;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.182576  Lock_time: 0.000076 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350995418;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:31:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.161757  Lock_time: 0.000169 Rows_sent: 125  Rows_examined: 1043855
SET timestamp=1350995475;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:31:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.109674  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1241809
SET timestamp=1350995476;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.401353  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 18470
SET timestamp=1350995523;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:32:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.116864  Lock_time: 0.000203 Rows_sent: 3  Rows_examined: 29380
SET timestamp=1350995535;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  5:32:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.993917  Lock_time: 0.000212 Rows_sent: 16539  Rows_examined: 8078627
SET timestamp=1350995549;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:33:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.667417  Lock_time: 0.000209 Rows_sent: 125  Rows_examined: 1043855
SET timestamp=1350995600;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.190247  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1241809
SET timestamp=1350995600;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:34:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.767617  Lock_time: 0.000094 Rows_sent: 125  Rows_examined: 1043855
SET timestamp=1350995686;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:34:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.420928  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241809
SET timestamp=1350995687;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:34:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  5:35:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.810550  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350995716;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:36:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.106979  Lock_time: 0.000139 Rows_sent: 125  Rows_examined: 1043855
SET timestamp=1350995795;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.770011  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1241809
SET timestamp=1350995795;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:36:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.736400  Lock_time: 0.000161 Rows_sent: 1493  Rows_examined: 6450553
SET timestamp=1350995799;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  5:38:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.217961  Lock_time: 0.000217 Rows_sent: 16539  Rows_examined: 8078627
SET timestamp=1350995893;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:38:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.378579  Lock_time: 0.000100 Rows_sent: 125  Rows_examined: 1043855
SET timestamp=1350995932;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:38:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.010858  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1241809
SET timestamp=1350995933;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:40:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.216138  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 18470
SET timestamp=1350996003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:40:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.854426  Lock_time: 0.000090 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350996018;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.848813  Lock_time: 0.000137 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350996018;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:41:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.656299  Lock_time: 0.000160 Rows_sent: 125  Rows_examined: 1043855
SET timestamp=1350996074;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:41:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.332542  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1241809
SET timestamp=1350996075;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:41:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.098797  Lock_time: 0.000266 Rows_sent: 16539  Rows_examined: 8078627
SET timestamp=1350996081;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:42:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.645131  Lock_time: 0.000142 Rows_sent: 125  Rows_examined: 1043856
SET timestamp=1350996163;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.879916  Lock_time: 0.000165 Rows_sent: 468  Rows_examined: 1241810
SET timestamp=1350996163;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.671589  Lock_time: 0.000140 Rows_sent: 65081  Rows_examined: 1734794
SET timestamp=1350996176;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  5:44:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.894305  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8078628
SET timestamp=1350996256;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:44:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.765380  Lock_time: 0.000131 Rows_sent: 125  Rows_examined: 1043856
SET timestamp=1350996292;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:44:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.609198  Lock_time: 0.000172 Rows_sent: 468  Rows_examined: 1241810
SET timestamp=1350996293;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
# Time: 121023  5:45:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.329589  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350996315;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:46:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.056432  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18471
SET timestamp=1350996362;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:46:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.713072  Lock_time: 0.000103 Rows_sent: 125  Rows_examined: 1043856
SET timestamp=1350996415;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:46:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.480963  Lock_time: 0.000105 Rows_sent: 468  Rows_examined: 1241810
SET timestamp=1350996416;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:47:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.824229  Lock_time: 0.000133 Rows_sent: 16539  Rows_examined: 8078628
SET timestamp=1350996421;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:47:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 141.733064  Lock_time: 0.000129 Rows_sent: 1493  Rows_examined: 6450560
SET timestamp=1350996442;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  5:48:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.286426  Lock_time: 0.000110 Rows_sent: 125  Rows_examined: 1043856
SET timestamp=1350996530;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:48:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.017853  Lock_time: 0.000173 Rows_sent: 468  Rows_examined: 1241810
SET timestamp=1350996531;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:50:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.621380  Lock_time: 0.000036 Rows_sent: 0  Rows_examined: 18471
SET timestamp=1350996603;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:50:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.344409  Lock_time: 0.000212 Rows_sent: 16539  Rows_examined: 8078628
SET timestamp=1350996611;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.113918  Lock_time: 0.000118 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350996617;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.096868  Lock_time: 0.000104 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350996617;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  5:51:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.440684  Lock_time: 0.000087 Rows_sent: 125  Rows_examined: 1043856
SET timestamp=1350996673;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:51:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.087796  Lock_time: 0.000112 Rows_sent: 468  Rows_examined: 1241810
SET timestamp=1350996674;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.093166  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 18472
SET timestamp=1350996722;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  5:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.537474  Lock_time: 0.000181 Rows_sent: 3  Rows_examined: 29382
SET timestamp=1350996736;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  5:53:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.317739  Lock_time: 0.000177 Rows_sent: 125  Rows_examined: 1043857
SET timestamp=1350996801;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:53:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.977556  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1241811
SET timestamp=1350996802;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:53:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.095385  Lock_time: 0.000169 Rows_sent: 16539  Rows_examined: 8078675
SET timestamp=1350996808;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.881957  Lock_time: 0.000096 Rows_sent: 125  Rows_examined: 1043858
SET timestamp=1350996888;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.440881  Lock_time: 0.000182 Rows_sent: 468  Rows_examined: 1241812
SET timestamp=1350996889;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:55:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.690628  Lock_time: 0.000112 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350996917;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
# Time: 121023  5:56:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.349857  Lock_time: 0.000186 Rows_sent: 16539  Rows_examined: 8078747
SET timestamp=1350996987;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  5:56:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.980570  Lock_time: 0.000127 Rows_sent: 125  Rows_examined: 1043859
SET timestamp=1350997000;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:56:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.964654  Lock_time: 0.000132 Rows_sent: 468  Rows_examined: 1241813
SET timestamp=1350997001;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:56:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.341226  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 58
SET timestamp=1350997007;
SELECT id_type, id_value, ad_text FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '24151337251';
# Time: 121023  5:56:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.041917  Lock_time: 0.000078 Rows_sent: 8  Rows_examined: 1144
SET timestamp=1350997008;
SELECT university_id, invalid_text FROM compliance_invalid_keywords WHERE LOCATE(invalid_text, 'Online Law Schools Search for Law Schools. Free Now.');
# Time: 121023  5:56:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.418864  Lock_time: 0.000143 Rows_sent: 1493  Rows_examined: 6450573
SET timestamp=1350997009;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  5:58:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.200632  Lock_time: 0.000116 Rows_sent: 125  Rows_examined: 1043862
SET timestamp=1350997127;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  5:58:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.910214  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241816
SET timestamp=1350997128;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  5:58:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.555338  Lock_time: 0.000188 Rows_sent: 16539  Rows_examined: 8078820
SET timestamp=1350997134;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.183354  Lock_time: 0.000120 Rows_sent: 20  Rows_examined: 3666
SET timestamp=1350997203;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# Time: 121023  6:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.058455  Lock_time: 0.000105 Rows_sent: 5  Rows_examined: 4204
SET timestamp=1350997204;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Grand Canyon University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Grand Canyon University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.096635  Lock_time: 0.000067 Rows_sent: 20  Rows_examined: 349
SET timestamp=1350997204;
SELECT
    interest.id,
    interest.data
FROM
    interest
    LEFT JOIN interest_ext ON (
        interest.id = interest_ext.interest_id
    )
WHERE
    interest_ext.interest_id IS NULL
--    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
AND interest.id > 854032
LIMIT
    20;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.847375  Lock_time: 0.000064 Rows_sent: 0  Rows_examined: 18477
SET timestamp=1350997204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:00:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.554699  Lock_time: 0.000108 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350997249;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.553669  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350997249;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:01:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.711813  Lock_time: 0.000120 Rows_sent: 125  Rows_examined: 1043862
SET timestamp=1350997319;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:02:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 118.454132  Lock_time: 0.000114 Rows_sent: 468  Rows_examined: 1241816
SET timestamp=1350997320;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:02:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.375642  Lock_time: 0.000228 Rows_sent: 16539  Rows_examined: 8078820
SET timestamp=1350997326;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:02:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.978521  Lock_time: 0.000069 Rows_sent: 126  Rows_examined: 1046340
SET timestamp=1350997362;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.173413  Lock_time: 0.000083 Rows_sent: 468  Rows_examined: 1241816
SET timestamp=1350997362;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:02:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.399831  Lock_time: 0.000115 Rows_sent: 65082  Rows_examined: 1734810
SET timestamp=1350997376;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  6:04:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.011220  Lock_time: 0.000093 Rows_sent: 126  Rows_examined: 1046340
SET timestamp=1350997494;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
# Time: 121023  6:04:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.649581  Lock_time: 0.000178 Rows_sent: 468  Rows_examined: 1241816
SET timestamp=1350997495;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:05:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.471561  Lock_time: 0.000180 Rows_sent: 16539  Rows_examined: 8078820
SET timestamp=1350997500;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.416998  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350997515;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:06:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.429138  Lock_time: 0.000132 Rows_sent: 126  Rows_examined: 1046340
SET timestamp=1350997586;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:06:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.630656  Lock_time: 0.000192 Rows_sent: 468  Rows_examined: 1241817
SET timestamp=1350997587;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:07:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 123.768395  Lock_time: 0.000216 Rows_sent: 1493  Rows_examined: 6450574
SET timestamp=1350997624;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  6:08:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.262948  Lock_time: 0.000169 Rows_sent: 16539  Rows_examined: 8078863
SET timestamp=1350997688;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:08:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.521852  Lock_time: 0.000162 Rows_sent: 126  Rows_examined: 1046341
SET timestamp=1350997732;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.952615  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1241818
SET timestamp=1350997732;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.427195  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 18481
SET timestamp=1350997804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.407242  Lock_time: 0.000129 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350997819;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.401974  Lock_time: 0.000118 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350997819;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:11:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.702353  Lock_time: 0.000127 Rows_sent: 126  Rows_examined: 1046343
SET timestamp=1350997877;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:11:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.404435  Lock_time: 0.000136 Rows_sent: 468  Rows_examined: 1241820
SET timestamp=1350997878;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:11:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.679799  Lock_time: 0.000185 Rows_sent: 16539  Rows_examined: 8078936
SET timestamp=1350997884;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.092096  Lock_time: 0.000065 Rows_sent: 0  Rows_examined: 18481
SET timestamp=1350997922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.614722  Lock_time: 0.000152 Rows_sent: 3  Rows_examined: 29391
SET timestamp=1350997936;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  6:13:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.134333  Lock_time: 0.000167 Rows_sent: 126  Rows_examined: 1046343
SET timestamp=1350998003;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:13:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.899085  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241820
SET timestamp=1350998004;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:14:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.936962  Lock_time: 0.000224 Rows_sent: 16539  Rows_examined: 8078936
SET timestamp=1350998054;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:14:47
# Time: 121023  6:14:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.404636  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241820
SET timestamp=1350998088;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.930157  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350998116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:16:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.095963  Lock_time: 0.000097 Rows_sent: 126  Rows_examined: 1046348
SET timestamp=1350998196;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.730219  Lock_time: 0.000068 Rows_sent: 468  Rows_examined: 1241825
SET timestamp=1350998196;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:16:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.641327  Lock_time: 0.000132 Rows_sent: 1493  Rows_examined: 6450595
SET timestamp=1350998201;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  6:16:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.315796  Lock_time: 0.000202 Rows_sent: 16539  Rows_examined: 8079111
SET timestamp=1350998203;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:18:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.806651  Lock_time: 0.000092 Rows_sent: 126  Rows_examined: 1046349
SET timestamp=1350998333;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.457282  Lock_time: 0.000153 Rows_sent: 468  Rows_examined: 1241827
SET timestamp=1350998333;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.897830  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 18488
SET timestamp=1350998403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:20:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.423260  Lock_time: 0.000200 Rows_sent: 16539  Rows_examined: 8079197
SET timestamp=1350998409;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:20:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.060819  Lock_time: 0.000190 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350998416;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.038486  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350998416;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:21:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.799364  Lock_time: 0.000106 Rows_sent: 126  Rows_examined: 1046349
SET timestamp=1350998470;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:21:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.460060  Lock_time: 0.000067 Rows_sent: 468  Rows_examined: 1241827
SET timestamp=1350998471;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:22:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.351032  Lock_time: 0.000195 Rows_sent: 126  Rows_examined: 1046349
SET timestamp=1350998563;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.418821  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241827
SET timestamp=1350998563;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:22:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.978448  Lock_time: 0.000179 Rows_sent: 16539  Rows_examined: 8079197
SET timestamp=1350998572;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:22:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.033692  Lock_time: 0.000115 Rows_sent: 65082  Rows_examined: 1734839
SET timestamp=1350998577;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  6:24:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.710842  Lock_time: 0.000103 Rows_sent: 126  Rows_examined: 1046350
SET timestamp=1350998697;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:24:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.393323  Lock_time: 0.000162 Rows_sent: 468  Rows_examined: 1241828
SET timestamp=1350998698;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
# Time: 121023  6:25:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.820326  Lock_time: 0.000121 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350998716;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:26:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.810202  Lock_time: 0.000213 Rows_sent: 16539  Rows_examined: 8079320
SET timestamp=1350998791;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:26:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.064809  Lock_time: 0.000099 Rows_sent: 126  Rows_examined: 1046352
SET timestamp=1350998795;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.634711  Lock_time: 0.000154 Rows_sent: 468  Rows_examined: 1241830
SET timestamp=1350998795;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:26:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.924303  Lock_time: 0.000160 Rows_sent: 1493  Rows_examined: 6450628
SET timestamp=1350998810;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  6:28:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.635591  Lock_time: 0.000123 Rows_sent: 126  Rows_examined: 1046352
SET timestamp=1350998921;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.356906  Lock_time: 0.000159 Rows_sent: 468  Rows_examined: 1241830
SET timestamp=1350998921;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:28:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.707329  Lock_time: 0.000235 Rows_sent: 16539  Rows_examined: 8079320
SET timestamp=1350998927;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.326767  Lock_time: 0.000207 Rows_sent: 5  Rows_examined: 2349
SET timestamp=1350999003;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Campus Explorer : Grand Canyon University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Campus Explorer : Grand Canyon University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023  6:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.619338  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 18491
SET timestamp=1350999004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.030599  Lock_time: 0.000122 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350999018;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.025861  Lock_time: 0.000120 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350999018;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:31:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.808380  Lock_time: 0.000109 Rows_sent: 126  Rows_examined: 1046352
SET timestamp=1350999073;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:31:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.777277  Lock_time: 0.000187 Rows_sent: 468  Rows_examined: 1241830
SET timestamp=1350999074;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:32:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.476252  Lock_time: 0.000048 Rows_sent: 0  Rows_examined: 18493
SET timestamp=1350999122;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:32:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.145188  Lock_time: 0.000122 Rows_sent: 3  Rows_examined: 29403
SET timestamp=1350999135;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  6:32:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.241889  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8079321
SET timestamp=1350999150;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:33:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.603321  Lock_time: 0.000097 Rows_sent: 126  Rows_examined: 1046355
SET timestamp=1350999200;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.138808  Lock_time: 0.000144 Rows_sent: 468  Rows_examined: 1241833
SET timestamp=1350999200;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:34:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.142964  Lock_time: 0.000163 Rows_sent: 126  Rows_examined: 1046359
SET timestamp=1350999287;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.656279  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241837
SET timestamp=1350999287;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:34:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.344279  Lock_time: 0.000195 Rows_sent: 16539  Rows_examined: 8079490
SET timestamp=1350999293;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:35:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.456413  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1350999315;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:36:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.807164  Lock_time: 0.000153 Rows_sent: 126  Rows_examined: 1046363
SET timestamp=1350999395;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:36:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.443706  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1241841
SET timestamp=1350999396;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:36:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.611751  Lock_time: 0.000121 Rows_sent: 1493  Rows_examined: 6450663
SET timestamp=1350999400;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  6:38:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.782033  Lock_time: 0.000217 Rows_sent: 16539  Rows_examined: 8079606
SET timestamp=1350999492;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:38:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.535228  Lock_time: 0.000117 Rows_sent: 126  Rows_examined: 1046363
SET timestamp=1350999533;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.048548  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1241841
SET timestamp=1350999533;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.620590  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 18503
SET timestamp=1350999604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:40:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.557729  Lock_time: 0.000130 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1350999619;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  6:41:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.870811  Lock_time: 0.000190 Rows_sent: 126  Rows_examined: 1046364
SET timestamp=1350999676;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:41:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.547490  Lock_time: 0.000105 Rows_sent: 468  Rows_examined: 1241842
SET timestamp=1350999677;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:41:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.300191  Lock_time: 0.000214 Rows_sent: 16539  Rows_examined: 8079636
SET timestamp=1350999683;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:42:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.206090  Lock_time: 0.000172 Rows_sent: 126  Rows_examined: 1046366
SET timestamp=1350999764;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.375878  Lock_time: 0.000135 Rows_sent: 468  Rows_examined: 1241844
SET timestamp=1350999764;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.534467  Lock_time: 0.000182 Rows_sent: 65084  Rows_examined: 1734882
SET timestamp=1350999776;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  6:44:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.163078  Lock_time: 0.000194 Rows_sent: 16539  Rows_examined: 8079804
SET timestamp=1350999862;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:44:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.970883  Lock_time: 0.000102 Rows_sent: 126  Rows_examined: 1046371
SET timestamp=1350999892;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:44:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.796801  Lock_time: 0.000071 Rows_sent: 468  Rows_examined: 1241849
SET timestamp=1350999893;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:45:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.349166  Lock_time: 0.000086 Rows_sent: 2  Rows_examined: 29635
SET timestamp=1350999915;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:46:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.224308  Lock_time: 0.000095 Rows_sent: 126  Rows_examined: 1046376
SET timestamp=1350999987;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:46:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.351386  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1241854
SET timestamp=1350999988;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:46:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.422005  Lock_time: 0.000152 Rows_sent: 16539  Rows_examined: 8080057
SET timestamp=1350999993;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:47:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.137492  Lock_time: 0.000096 Rows_sent: 24  Rows_examined: 20305
SET timestamp=1351000029;
SELECT DATE_FORMAT(date,'%H'),visitors FROM hits WHERE source='Facebook' AND DATE(date)='2012-10-21';
# Time: 121023  6:47:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 133.994120  Lock_time: 0.000122 Rows_sent: 1493  Rows_examined: 6450734
SET timestamp=1351000035;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  6:48:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.338342  Lock_time: 0.000143 Rows_sent: 126  Rows_examined: 1046383
SET timestamp=1351000129;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:48:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.028915  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1241862
SET timestamp=1351000130;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.243110  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 18527
SET timestamp=1351000204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.660240  Lock_time: 0.000154 Rows_sent: 2  Rows_examined: 29635
SET timestamp=1351000217;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.651784  Lock_time: 0.000094 Rows_sent: 2  Rows_examined: 29635
SET timestamp=1351000217;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  6:50:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.916711  Lock_time: 0.000217 Rows_sent: 16539  Rows_examined: 8080436
SET timestamp=1351000219;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
# Time: 121023  6:51:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.738760  Lock_time: 0.000074 Rows_sent: 126  Rows_examined: 1046389
SET timestamp=1351000276;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:51:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.272486  Lock_time: 0.000158 Rows_sent: 468  Rows_examined: 1241868
SET timestamp=1351000277;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:52:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.091242  Lock_time: 0.000069 Rows_sent: 0  Rows_examined: 18537
SET timestamp=1351000323;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  6:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.501422  Lock_time: 0.000230 Rows_sent: 3  Rows_examined: 29447
SET timestamp=1351000336;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  6:53:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.438570  Lock_time: 0.000102 Rows_sent: 126  Rows_examined: 1046395
SET timestamp=1351000403;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.035746  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1241874
SET timestamp=1351000403;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:53:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.715058  Lock_time: 0.000173 Rows_sent: 16539  Rows_examined: 8080599
SET timestamp=1351000409;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.441764  Lock_time: 0.000132 Rows_sent: 126  Rows_examined: 1046401
SET timestamp=1351000489;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:54:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.937688  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1241880
SET timestamp=1351000490;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.464913  Lock_time: 0.000128 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1351000516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  6:56:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.035438  Lock_time: 0.000177 Rows_sent: 16539  Rows_examined: 8080755
SET timestamp=1351000586;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  6:56:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.202389  Lock_time: 0.000117 Rows_sent: 126  Rows_examined: 1046404
SET timestamp=1351000601;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.737078  Lock_time: 0.000071 Rows_sent: 468  Rows_examined: 1241883
SET timestamp=1351000601;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:56:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.749546  Lock_time: 0.000148 Rows_sent: 1493  Rows_examined: 6450868
SET timestamp=1351000603;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  6:58:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.383469  Lock_time: 0.000096 Rows_sent: 126  Rows_examined: 1046408
SET timestamp=1351000731;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  6:58:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.256671  Lock_time: 0.000115 Rows_sent: 468  Rows_examined: 1241887
SET timestamp=1351000732;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  6:58:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.583207  Lock_time: 0.000252 Rows_sent: 16539  Rows_examined: 8081018
SET timestamp=1351000738;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.048686  Lock_time: 0.000096 Rows_sent: 20  Rows_examined: 367
SET timestamp=1351000803;
SELECT
    interest.id,
    interest.data
FROM
    interest
    LEFT JOIN interest_ext ON (
        interest.id = interest_ext.interest_id
    )
WHERE
    interest_ext.interest_id IS NULL
--    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
AND interest.id > 851952
LIMIT
    20;
# Time: 121023  7:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.184412  Lock_time: 0.000083 Rows_sent: 17  Rows_examined: 1780
SET timestamp=1351000804;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 19:12:04' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.485847  Lock_time: 0.000113 Rows_sent: 77  Rows_examined: 3763
SET timestamp=1351000804;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
# Time: 121023  7:00:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.128538  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1351000851;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.129384  Lock_time: 0.000105 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1351000851;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.980365  Lock_time: 0.000174 Rows_sent: 126  Rows_examined: 1046413
SET timestamp=1351000923;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:02:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.739256  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1241892
SET timestamp=1351000924;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:02:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.879643  Lock_time: 0.000196 Rows_sent: 16539  Rows_examined: 8081235
SET timestamp=1351000929;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:02:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.929141  Lock_time: 0.000119 Rows_sent: 65086  Rows_examined: 1735020
SET timestamp=1351000967;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  7:04:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.284328  Lock_time: 0.000095 Rows_sent: 126  Rows_examined: 1046420
SET timestamp=1351001096;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:04:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.919908  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1241899
SET timestamp=1351001097;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:05:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.882514  Lock_time: 0.000307 Rows_sent: 16539  Rows_examined: 8081356
SET timestamp=1351001103;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.207258  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351001115;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:06:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.146102  Lock_time: 0.000102 Rows_sent: 126  Rows_examined: 1046427
SET timestamp=1351001185;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:06:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.313455  Lock_time: 0.000075 Rows_sent: 468  Rows_examined: 1241906
SET timestamp=1351001198;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:06:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.386639  Lock_time: 0.000100 Rows_sent: 1493  Rows_examined: 6450963
SET timestamp=1351001210;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  7:07:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.484165  Lock_time: 0.000225 Rows_sent: 16539  Rows_examined: 8081664
SET timestamp=1351001279;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:08:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.830071  Lock_time: 0.000064 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351001322;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  7:08:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.992387  Lock_time: 0.000197 Rows_sent: 7  Rows_examined: 926014
SET timestamp=1351001331;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023  7:08:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.911997  Lock_time: 0.000100 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351001334;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  7:09:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.377953  Lock_time: 0.000165 Rows_sent: 126  Rows_examined: 1046432
SET timestamp=1351001341;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.892347  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1241911
SET timestamp=1351001341;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:10:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.378568  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 18583
SET timestamp=1351001403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:10:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.209096  Lock_time: 0.000149 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351001418;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
# Time: 121023  7:11:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.370699  Lock_time: 0.000095 Rows_sent: 126  Rows_examined: 1046441
SET timestamp=1351001476;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:11:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.047884  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1241920
SET timestamp=1351001477;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:11:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.625928  Lock_time: 0.000192 Rows_sent: 16539  Rows_examined: 8081908
SET timestamp=1351001483;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.135262  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18588
SET timestamp=1351001522;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.810688  Lock_time: 0.000241 Rows_sent: 3  Rows_examined: 29504
SET timestamp=1351001536;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  7:13:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.123822  Lock_time: 0.000096 Rows_sent: 126  Rows_examined: 1046446
SET timestamp=1351001604;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:13:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.946188  Lock_time: 0.000134 Rows_sent: 468  Rows_examined: 1241925
SET timestamp=1351001605;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:14:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.561776  Lock_time: 0.000209 Rows_sent: 16539  Rows_examined: 8082025
SET timestamp=1351001657;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:14:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.490864  Lock_time: 0.000093 Rows_sent: 126  Rows_examined: 1046449
SET timestamp=1351001687;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:14:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.671896  Lock_time: 0.000144 Rows_sent: 468  Rows_examined: 1241928
SET timestamp=1351001688;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:15:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.056536  Lock_time: 0.000076 Rows_sent: 17  Rows_examined: 1780
SET timestamp=1351001703;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 19:12:04' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  7:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.458050  Lock_time: 0.000099 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351001716;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:16:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.354173  Lock_time: 0.000138 Rows_sent: 126  Rows_examined: 1046452
SET timestamp=1351001794;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:16:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.992151  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1241931
SET timestamp=1351001795;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:16:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.107753  Lock_time: 0.000175 Rows_sent: 16539  Rows_examined: 8082108
SET timestamp=1351001801;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:16:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.441007  Lock_time: 0.000126 Rows_sent: 1493  Rows_examined: 6451054
SET timestamp=1351001806;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  7:18:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.739086  Lock_time: 0.000163 Rows_sent: 126  Rows_examined: 1046459
SET timestamp=1351001936;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.333128  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1241938
SET timestamp=1351001936;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.311835  Lock_time: 0.000049 Rows_sent: 0  Rows_examined: 18600
SET timestamp=1351002003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:20:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.691832  Lock_time: 0.000218 Rows_sent: 16539  Rows_examined: 8082271
SET timestamp=1351002005;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
# Time: 121023  7:20:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.355694  Lock_time: 0.000152 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351002017;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.346991  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351002017;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:21:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.542833  Lock_time: 0.000097 Rows_sent: 126  Rows_examined: 1046459
SET timestamp=1351002070;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.154826  Lock_time: 0.000085 Rows_sent: 468  Rows_examined: 1241938
SET timestamp=1351002070;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:22:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.211310  Lock_time: 0.000136 Rows_sent: 126  Rows_examined: 1046464
SET timestamp=1351002161;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.529138  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241943
SET timestamp=1351002161;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:22:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.829724  Lock_time: 0.000205 Rows_sent: 16539  Rows_examined: 8082379
SET timestamp=1351002168;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:22:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.801670  Lock_time: 0.000167 Rows_sent: 65092  Rows_examined: 1735133
SET timestamp=1351002173;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  7:24:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.567014  Lock_time: 0.000093 Rows_sent: 126  Rows_examined: 1046467
SET timestamp=1351002296;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.199370  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1241946
SET timestamp=1351002296;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:25:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.458820  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351002319;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:26:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.365912  Lock_time: 0.000122 Rows_sent: 16539  Rows_examined: 8082492
SET timestamp=1351002393;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:26:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.555195  Lock_time: 0.000113 Rows_sent: 126  Rows_examined: 1046472
SET timestamp=1351002398;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.938346  Lock_time: 0.000072 Rows_sent: 468  Rows_examined: 1241951
SET timestamp=1351002398;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:26:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.072074  Lock_time: 0.000099 Rows_sent: 1493  Rows_examined: 6451090
SET timestamp=1351002406;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  7:28:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.885686  Lock_time: 0.000160 Rows_sent: 126  Rows_examined: 1046477
SET timestamp=1351002531;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:28:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.622549  Lock_time: 0.000165 Rows_sent: 468  Rows_examined: 1241956
SET timestamp=1351002532;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:28:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.154324  Lock_time: 0.000231 Rows_sent: 16539  Rows_examined: 8082739
SET timestamp=1351002537;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.494720  Lock_time: 0.000070 Rows_sent: 0  Rows_examined: 18624
SET timestamp=1351002604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:30:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.486874  Lock_time: 0.000105 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351002619;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.487683  Lock_time: 0.000127 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351002619;
SELECT
    sessions.id,
    sessions.university,
# Time: 121023  7:31:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.979839  Lock_time: 0.000105 Rows_sent: 126  Rows_examined: 1046483
SET timestamp=1351002677;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:31:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.570857  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241962
SET timestamp=1351002678;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.775878  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 18625
SET timestamp=1351002723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.539016  Lock_time: 0.000184 Rows_sent: 3  Rows_examined: 29544
SET timestamp=1351002736;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  7:32:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.790376  Lock_time: 0.000161 Rows_sent: 16539  Rows_examined: 8082893
SET timestamp=1351002757;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:33:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.681503  Lock_time: 0.000101 Rows_sent: 126  Rows_examined: 1046485
SET timestamp=1351002799;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.237681  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1241964
SET timestamp=1351002799;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:34:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.927565  Lock_time: 0.000100 Rows_sent: 126  Rows_examined: 1046493
SET timestamp=1351002886;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.434587  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1241972
SET timestamp=1351002886;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:34:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.723630  Lock_time: 0.000311 Rows_sent: 16539  Rows_examined: 8083211
SET timestamp=1351002892;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:35:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.412252  Lock_time: 0.000063 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351002916;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:36:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.958901  Lock_time: 0.000138 Rows_sent: 126  Rows_examined: 1046499
SET timestamp=1351002989;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:36:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.690359  Lock_time: 0.000126 Rows_sent: 468  Rows_examined: 1241978
SET timestamp=1351002990;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:36:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.117447  Lock_time: 0.000102 Rows_sent: 1493  Rows_examined: 6451198
SET timestamp=1351002997;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  7:38:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.392613  Lock_time: 0.000219 Rows_sent: 16539  Rows_examined: 8083504
SET timestamp=1351003082;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:38:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.187991  Lock_time: 0.000096 Rows_sent: 126  Rows_examined: 1046504
SET timestamp=1351003125;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:38:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.715682  Lock_time: 0.000152 Rows_sent: 468  Rows_examined: 1241983
SET timestamp=1351003126;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.344293  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 18647
SET timestamp=1351003204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:40:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.778670  Lock_time: 0.000091 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351003219;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.788915  Lock_time: 0.000104 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351003219;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:40:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.221522  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1241985
SET timestamp=1351003221;
# Time: 121023  7:41:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.275761  Lock_time: 0.000091 Rows_sent: 126  Rows_examined: 1046506
SET timestamp=1351003276;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.858620  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1241985
SET timestamp=1351003276;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:41:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.548021  Lock_time: 0.000260 Rows_sent: 16539  Rows_examined: 8083660
SET timestamp=1351003282;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:42:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.691558  Lock_time: 0.000142 Rows_sent: 126  Rows_examined: 1046510
SET timestamp=1351003364;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.813858  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1241989
SET timestamp=1351003364;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.997580  Lock_time: 0.000243 Rows_sent: 65094  Rows_examined: 1735263
SET timestamp=1351003376;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  7:44:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.153688  Lock_time: 0.000171 Rows_sent: 16539  Rows_examined: 8083908
SET timestamp=1351003463;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:44:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.014800  Lock_time: 0.000148 Rows_sent: 126  Rows_examined: 1046516
SET timestamp=1351003494;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.494571  Lock_time: 0.000144 Rows_sent: 468  Rows_examined: 1241995
SET timestamp=1351003494;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:45:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.185116  Lock_time: 0.000099 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351003516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:46:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.401914  Lock_time: 0.000121 Rows_sent: 126  Rows_examined: 1046518
SET timestamp=1351003618;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.212161  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1241997
SET timestamp=1351003618;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:47:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.560057  Lock_time: 0.000282 Rows_sent: 16539  Rows_examined: 8084065
SET timestamp=1351003624;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:47:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.696900  Lock_time: 0.000134 Rows_sent: 1493  Rows_examined: 6451279
SET timestamp=1351003628;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  7:48:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.690203  Lock_time: 0.000169 Rows_sent: 126  Rows_examined: 1046518
SET timestamp=1351003730;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:48:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.353516  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1241997
SET timestamp=1351003731;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.584098  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 18659
SET timestamp=1351003804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:50:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.306191  Lock_time: 0.000199 Rows_sent: 16539  Rows_examined: 8084065
SET timestamp=1351003811;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.047579  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351003817;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.058663  Lock_time: 0.000154 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351003817;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
# Time: 121023  7:51:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.061583  Lock_time: 0.000138 Rows_sent: 126  Rows_examined: 1046518
SET timestamp=1351003872;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:51:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.710610  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1241997
SET timestamp=1351003873;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.125666  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 18664
SET timestamp=1351003922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  7:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.843700  Lock_time: 0.000190 Rows_sent: 3  Rows_examined: 29583
SET timestamp=1351003936;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  7:53:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.136577  Lock_time: 0.000137 Rows_sent: 126  Rows_examined: 1046523
SET timestamp=1351004002;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:53:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.715544  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242002
SET timestamp=1351004003;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:53:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.572169  Lock_time: 0.000205 Rows_sent: 16539  Rows_examined: 8084261
SET timestamp=1351004008;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:54:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.050930  Lock_time: 0.000077 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351004068;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  7:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.229132  Lock_time: 0.000075 Rows_sent: 126  Rows_examined: 1046527
SET timestamp=1351004089;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:54:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.743700  Lock_time: 0.000139 Rows_sent: 468  Rows_examined: 1242006
SET timestamp=1351004090;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.330990  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351004116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  7:56:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.671158  Lock_time: 0.000171 Rows_sent: 16539  Rows_examined: 8084427
SET timestamp=1351004188;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  7:56:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.743609  Lock_time: 0.000108 Rows_sent: 126  Rows_examined: 1046531
SET timestamp=1351004200;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  7:56:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.997280  Lock_time: 0.000070 Rows_sent: 468  Rows_examined: 1242010
SET timestamp=1351004202;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:56:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.241385  Lock_time: 0.000139 Rows_sent: 1493  Rows_examined: 6451352
SET timestamp=1351004210;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  7:58:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.739829  Lock_time: 0.000092 Rows_sent: 124  Rows_examined: 1046539
SET timestamp=1351004326;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.428766  Lock_time: 0.000123 Rows_sent: 468  Rows_examined: 1242018
SET timestamp=1351004326;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  7:58:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.716523  Lock_time: 0.000317 Rows_sent: 16539  Rows_examined: 8084636
SET timestamp=1351004332;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.830627  Lock_time: 0.000089 Rows_sent: 129  Rows_examined: 3969
SET timestamp=1351004404;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.119848  Lock_time: 0.000063 Rows_sent: 0  Rows_examined: 18680
SET timestamp=1351004404;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:00:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.942503  Lock_time: 0.000110 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351004448;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.934136  Lock_time: 0.000102 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351004448;
SELECT
# Time: 121023  8:01:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.223022  Lock_time: 0.000105 Rows_sent: 124  Rows_examined: 1046539
SET timestamp=1351004518;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:01:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.806241  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242018
SET timestamp=1351004519;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:02:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.394610  Lock_time: 0.000188 Rows_sent: 16539  Rows_examined: 8084636
SET timestamp=1351004525;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:02:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.463880  Lock_time: 0.000088 Rows_sent: 124  Rows_examined: 1046539
SET timestamp=1351004562;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.582514  Lock_time: 0.000076 Rows_sent: 468  Rows_examined: 1242018
SET timestamp=1351004562;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:02:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.855864  Lock_time: 0.000118 Rows_sent: 65095  Rows_examined: 1735340
SET timestamp=1351004575;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  8:04:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.619138  Lock_time: 0.000142 Rows_sent: 124  Rows_examined: 1046540
SET timestamp=1351004695;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:04:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.291604  Lock_time: 0.000139 Rows_sent: 468  Rows_examined: 1242019
SET timestamp=1351004696;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:05:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.719965  Lock_time: 0.000205 Rows_sent: 16539  Rows_examined: 8084669
SET timestamp=1351004702;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.500411  Lock_time: 0.000094 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351004715;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  8:06:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.292321  Lock_time: 0.000099 Rows_sent: 124  Rows_examined: 1046544
SET timestamp=1351004786;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:06:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.563372  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242023
SET timestamp=1351004787;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:07:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 125.984081  Lock_time: 0.000130 Rows_sent: 1493  Rows_examined: 6451423
SET timestamp=1351004827;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  8:08:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.179773  Lock_time: 0.000159 Rows_sent: 16539  Rows_examined: 8084871
SET timestamp=1351004891;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:08:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.565156  Lock_time: 0.000205 Rows_sent: 124  Rows_examined: 1046549
SET timestamp=1351004931;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.086647  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242028
SET timestamp=1351004931;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.524219  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 18691
SET timestamp=1351005004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.329858  Lock_time: 0.000114 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351005019;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.337452  Lock_time: 0.000143 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351005019;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  8:10:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.190158  Lock_time: 0.000076 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351005042;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  8:11:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.637290  Lock_time: 0.000140 Rows_sent: 124  Rows_examined: 1046551
SET timestamp=1351005076;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
# Time: 121023  8:11:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.648050  Lock_time: 0.000242 Rows_sent: 16539  Rows_examined: 8084968
SET timestamp=1351005082;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.074330  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 18701
SET timestamp=1351005122;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.625729  Lock_time: 0.000193 Rows_sent: 3  Rows_examined: 29620
SET timestamp=1351005136;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  8:13:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.417524  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1046560
SET timestamp=1351005202;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:13:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.169905  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242039
SET timestamp=1351005203;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:14:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.772113  Lock_time: 0.000192 Rows_sent: 16539  Rows_examined: 8085228
SET timestamp=1351005261;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:14:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.409699  Lock_time: 0.000131 Rows_sent: 124  Rows_examined: 1046568
SET timestamp=1351005282;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:14:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.941893  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242047
SET timestamp=1351005283;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.838817  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351005316;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  8:16:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.358684  Lock_time: 0.000116 Rows_sent: 124  Rows_examined: 1046572
SET timestamp=1351005395;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:16:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.064321  Lock_time: 0.000191 Rows_sent: 468  Rows_examined: 1242051
SET timestamp=1351005396;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:16:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.184751  Lock_time: 0.000116 Rows_sent: 24  Rows_examined: 20307
SET timestamp=1351005399;
SELECT DATE_FORMAT(date,'%H'),visitors FROM hits WHERE source='Facebook' AND DATE(date)='2012-10-21';
# Time: 121023  8:16:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.955039  Lock_time: 0.000125 Rows_sent: 1493  Rows_examined: 6451538
SET timestamp=1351005400;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  8:16:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.721794  Lock_time: 0.000249 Rows_sent: 16539  Rows_examined: 8085503
SET timestamp=1351005403;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:19:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.675873  Lock_time: 0.000122 Rows_sent: 124  Rows_examined: 1046580
SET timestamp=1351005540;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:19:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.636517  Lock_time: 0.000126 Rows_sent: 468  Rows_examined: 1242059
SET timestamp=1351005541;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:19:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.949214  Lock_time: 0.000132 Rows_sent: 468  Rows_examined: 1242062
SET timestamp=1351005588;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  8:19:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.649974  Lock_time: 0.000208 Rows_sent: 16539  Rows_examined: 8085865
SET timestamp=1351005594;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.540861  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 18730
SET timestamp=1351005604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:20:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.833319  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351005618;
SELECT
# Time: 121023  8:21:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.842507  Lock_time: 0.000100 Rows_sent: 124  Rows_examined: 1046589
SET timestamp=1351005675;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:21:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.251206  Lock_time: 0.000112 Rows_sent: 468  Rows_examined: 1242068
SET timestamp=1351005676;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:22:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.519816  Lock_time: 0.000135 Rows_sent: 124  Rows_examined: 1046603
SET timestamp=1351005764;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.566181  Lock_time: 0.000113 Rows_sent: 468  Rows_examined: 1242082
SET timestamp=1351005764;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:22:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.008421  Lock_time: 0.000184 Rows_sent: 16539  Rows_examined: 8086208
SET timestamp=1351005771;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:22:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.080268  Lock_time: 0.000179 Rows_sent: 65101  Rows_examined: 1735500
SET timestamp=1351005777;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  8:24:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.561674  Lock_time: 0.000150 Rows_sent: 124  Rows_examined: 1046604
SET timestamp=1351005898;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.140110  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242083
SET timestamp=1351005898;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:25:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.246354  Lock_time: 0.000095 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351005918;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  8:26:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.068127  Lock_time: 0.000148 Rows_sent: 124  Rows_examined: 1046619
SET timestamp=1351005990;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:26:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.262977  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242098
SET timestamp=1351005991;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:26:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.872863  Lock_time: 0.000173 Rows_sent: 16539  Rows_examined: 8086478
SET timestamp=1351005993;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:26:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.727612  Lock_time: 0.000142 Rows_sent: 1493  Rows_examined: 6451706
SET timestamp=1351006002;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  8:28:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.872099  Lock_time: 0.000136 Rows_sent: 124  Rows_examined: 1046622
SET timestamp=1351006128;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:28:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.337811  Lock_time: 0.000183 Rows_sent: 468  Rows_examined: 1242101
SET timestamp=1351006129;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:28:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.991228  Lock_time: 0.000186 Rows_sent: 16539  Rows_examined: 8086786
SET timestamp=1351006134;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.894252  Lock_time: 0.000048 Rows_sent: 0  Rows_examined: 18763
SET timestamp=1351006204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:30:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.906883  Lock_time: 0.000113 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351006219;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.892819  Lock_time: 0.000114 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351006219;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  8:31:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  8:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.526786  Lock_time: 0.000217 Rows_sent: 3  Rows_examined: 29690
SET timestamp=1351006336;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  8:32:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.494278  Lock_time: 0.000215 Rows_sent: 16539  Rows_examined: 8086786
SET timestamp=1351006360;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:33:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.537365  Lock_time: 0.000138 Rows_sent: 124  Rows_examined: 1046624
SET timestamp=1351006398;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:33:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.532562  Lock_time: 0.000115 Rows_sent: 468  Rows_examined: 1242103
SET timestamp=1351006399;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:34:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.134549  Lock_time: 0.000119 Rows_sent: 124  Rows_examined: 1046626
SET timestamp=1351006486;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.657570  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242105
SET timestamp=1351006486;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:34:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.734443  Lock_time: 0.000276 Rows_sent: 16539  Rows_examined: 8086883
SET timestamp=1351006492;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:35:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.031141  Lock_time: 0.000089 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351006516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  8:36:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.444596  Lock_time: 0.000158 Rows_sent: 124  Rows_examined: 1046631
SET timestamp=1351006587;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:36:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.191107  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242110
SET timestamp=1351006588;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:36:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.831779  Lock_time: 0.000137 Rows_sent: 1493  Rows_examined: 6451781
SET timestamp=1351006605;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  8:37:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.689722  Lock_time: 0.000181 Rows_sent: 16539  Rows_examined: 8087096
SET timestamp=1351006679;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:38:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.102069  Lock_time: 0.000099 Rows_sent: 124  Rows_examined: 1046637
SET timestamp=1351006731;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:38:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.726639  Lock_time: 0.000204 Rows_sent: 468  Rows_examined: 1242116
SET timestamp=1351006732;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.630947  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 18785
SET timestamp=1351006804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:40:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.738622  Lock_time: 0.000108 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351006820;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.739025  Lock_time: 0.000138 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351006820;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  8:41:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.455512  Lock_time: 0.000125 Rows_sent: 124  Rows_examined: 1046645
SET timestamp=1351006869;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:41:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.632414  Lock_time: 0.000146 Rows_sent: 468  Rows_examined: 1242126
SET timestamp=1351006870;
# Time: 121023  8:41:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.544084  Lock_time: 0.000235 Rows_sent: 16539  Rows_examined: 8087446
SET timestamp=1351006877;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:42:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.773932  Lock_time: 0.000149 Rows_sent: 124  Rows_examined: 1046649
SET timestamp=1351006965;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.927483  Lock_time: 0.000104 Rows_sent: 468  Rows_examined: 1242128
SET timestamp=1351006965;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:42:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.566016  Lock_time: 0.000163 Rows_sent: 65104  Rows_examined: 1735622
SET timestamp=1351006979;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  8:44:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.486008  Lock_time: 0.000182 Rows_sent: 16539  Rows_examined: 8087557
SET timestamp=1351007057;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:44:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.231069  Lock_time: 0.000096 Rows_sent: 124  Rows_examined: 1046651
SET timestamp=1351007096;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:44:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.082897  Lock_time: 0.000144 Rows_sent: 468  Rows_examined: 1242130
SET timestamp=1351007097;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:45:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.013194  Lock_time: 0.000038 Rows_sent: 15  Rows_examined: 399
SET timestamp=1351007103;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  8:45:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.586613  Lock_time: 0.000122 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351007116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  8:45:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.057920  Lock_time: 0.000108 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351007158;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  8:46:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.406657  Lock_time: 0.000074 Rows_sent: 124  Rows_examined: 1046657
SET timestamp=1351007190;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:46:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.453607  Lock_time: 0.000069 Rows_sent: 468  Rows_examined: 1242136
SET timestamp=1351007191;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:46:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.038851  Lock_time: 0.000122 Rows_sent: 1493  Rows_examined: 6451908
SET timestamp=1351007218;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  8:47:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.259454  Lock_time: 0.000182 Rows_sent: 16539  Rows_examined: 8087741
SET timestamp=1351007226;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:48:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.364711  Lock_time: 0.000154 Rows_sent: 124  Rows_examined: 1046660
SET timestamp=1351007330;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:48:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.093857  Lock_time: 0.000154 Rows_sent: 468  Rows_examined: 1242139
SET timestamp=1351007331;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:50:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.588896  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 18806
SET timestamp=1351007402;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.070013  Lock_time: 0.000178 Rows_sent: 16539  Rows_examined: 8087927
SET timestamp=1351007404;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.787553  Lock_time: 0.000147 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351007417;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023  8:51:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.904837  Lock_time: 0.000099 Rows_sent: 124  Rows_examined: 1046665
SET timestamp=1351007472;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.602589  Lock_time: 0.000087 Rows_sent: 468  Rows_examined: 1242144
SET timestamp=1351007472;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.076180  Lock_time: 0.000070 Rows_sent: 0  Rows_examined: 18807
SET timestamp=1351007522;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  8:52:12
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 1.328877  Lock_time: 0.000070 Rows_sent: 3  Rows_examined: 3
SET timestamp=1351007532;
SHOW TABLE STATUS FROM `degreeamerica` LIKE 'sessions%';
# Time: 121023  8:52:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.733284  Lock_time: 0.000090 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351007534;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  8:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.700323  Lock_time: 0.000164 Rows_sent: 3  Rows_examined: 29733
SET timestamp=1351007536;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  8:53:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.345332  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1046667
SET timestamp=1351007589;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.440283  Lock_time: 0.000173 Rows_sent: 468  Rows_examined: 1242146
SET timestamp=1351007589;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:53:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.395049  Lock_time: 0.000269 Rows_sent: 16539  Rows_examined: 8116623
SET timestamp=1351007599;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  8:54:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.881646  Lock_time: 0.000138 Rows_sent: 124  Rows_examined: 1046677
SET timestamp=1351007693;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.479874  Lock_time: 0.000144 Rows_sent: 468  Rows_examined: 1242156
SET timestamp=1351007693;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:55:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.769888  Lock_time: 0.000084 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351007717;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  8:55:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.800437  Lock_time: 0.000086 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351007741;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  8:56:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.576260  Lock_time: 0.000172 Rows_sent: 16539  Rows_examined: 8116987
SET timestamp=1351007787;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.293950  Lock_time: 0.000124 Rows_sent: 124  Rows_examined: 1046684
SET timestamp=1351007787;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:56:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.252395  Lock_time: 0.000126 Rows_sent: 468  Rows_examined: 1242163
SET timestamp=1351007788;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:56:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.849341  Lock_time: 0.000135 Rows_sent: 1493  Rows_examined: 6451999
SET timestamp=1351007799;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  8:58:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.386636  Lock_time: 0.000191 Rows_sent: 7  Rows_examined: 81579
SET timestamp=1351007912;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-22 18:30:20' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023  8:58:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.710920  Lock_time: 0.000082 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351007914;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  8:58:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.347575  Lock_time: 0.000105 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351007915;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  8:58:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.701611  Lock_time: 0.000182 Rows_sent: 124  Rows_examined: 1046684
SET timestamp=1351007929;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  8:58:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.359399  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242163
SET timestamp=1351007930;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  8:58:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.317287  Lock_time: 0.000231 Rows_sent: 16539  Rows_examined: 8088485
# Time: 121023  9:02:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.980647  Lock_time: 0.000120 Rows_sent: 124  Rows_examined: 1046690
SET timestamp=1351008126;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:02:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 125.917874  Lock_time: 0.000224 Rows_sent: 468  Rows_examined: 1242169
SET timestamp=1351008127;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:02:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.112163  Lock_time: 0.000188 Rows_sent: 16539  Rows_examined: 8088621
SET timestamp=1351008132;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:02:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.423175  Lock_time: 0.000140 Rows_sent: 65108  Rows_examined: 1735751
SET timestamp=1351008168;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  9:04:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.668963  Lock_time: 0.000116 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351008273;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:04:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.337649  Lock_time: 0.000093 Rows_sent: 124  Rows_examined: 1046704
SET timestamp=1351008298;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:04:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.025572  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242183
SET timestamp=1351008299;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:05:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.646474  Lock_time: 0.000255 Rows_sent: 16539  Rows_examined: 8089037
SET timestamp=1351008304;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.945804  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351008315;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:06:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.352042  Lock_time: 0.000165 Rows_sent: 124  Rows_examined: 1046707
SET timestamp=1351008414;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:06:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.135114  Lock_time: 0.000107 Rows_sent: 468  Rows_examined: 1242186
SET timestamp=1351008415;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:07:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.829272  Lock_time: 0.000119 Rows_sent: 1493  Rows_examined: 6452119
SET timestamp=1351008428;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  9:07:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.670492  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1242191
SET timestamp=1351008441;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  9:07:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.769495  Lock_time: 0.000084 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351008454;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:08:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.156010  Lock_time: 0.000226 Rows_sent: 16539  Rows_examined: 8089196
SET timestamp=1351008500;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:08:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.104445  Lock_time: 0.000132 Rows_sent: 124  Rows_examined: 1046716
SET timestamp=1351008538;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:08:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.321710  Lock_time: 0.000114 Rows_sent: 468  Rows_examined: 1242195
SET timestamp=1351008539;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.607228  Lock_time: 0.000066 Rows_sent: 0  Rows_examined: 18861
SET timestamp=1351008604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.450528  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351008619;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.467082  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351008619;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  9:10:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.675857  Lock_time: 0.000109 Rows_sent: 468  Rows_examined: 1242197
SET timestamp=1351008633;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  9:10:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.800919  Lock_time: 0.000078 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351008634;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:11:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.789016  Lock_time: 0.000093 Rows_sent: 124  Rows_examined: 1046719
SET timestamp=1351008673;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:11:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.286796  Lock_time: 0.000164 Rows_sent: 468  Rows_examined: 1242198
SET timestamp=1351008674;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:11:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.541442  Lock_time: 0.000249 Rows_sent: 16539  Rows_examined: 8089407
SET timestamp=1351008680;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.044604  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 18864
SET timestamp=1351008722;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:12:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.243828  Lock_time: 0.000189 Rows_sent: 3  Rows_examined: 29794
SET timestamp=1351008735;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  9:12:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.638119  Lock_time: 0.000108 Rows_sent: 22  Rows_examined: 28102
SET timestamp=1351008742;
# Time: 121023  9:13:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.206851  Lock_time: 0.000089 Rows_sent: 389  Rows_examined: 1096602
SET timestamp=1351008788;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023  9:13:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.701389  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242201
SET timestamp=1351008793;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  9:13:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.653970  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1046723
SET timestamp=1351008806;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:13:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.180265  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1242202
SET timestamp=1351008807;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:13:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.722061  Lock_time: 0.000090 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351008814;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:14:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.283750  Lock_time: 0.000293 Rows_sent: 16539  Rows_examined: 8089764
SET timestamp=1351008869;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:14:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.928957  Lock_time: 0.000100 Rows_sent: 124  Rows_examined: 1046734
SET timestamp=1351008897;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.338466  Lock_time: 0.000136 Rows_sent: 468  Rows_examined: 1242213
SET timestamp=1351008897;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:15:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.275664  Lock_time: 0.000113 Rows_sent: 5  Rows_examined: 4276
SET timestamp=1351008904;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Full Sail University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Full Sail University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023  9:15:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.514947  Lock_time: 0.000189 Rows_sent: 6  Rows_examined: 3713
SET timestamp=1351008907;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-22 18:18:06' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023  9:15:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.007808  Lock_time: 0.000162 Rows_sent: 5  Rows_examined: 4119
SET timestamp=1351008909;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Kaplan University M'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Kaplan University M'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023  9:15:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.700674  Lock_time: 0.000053 Rows_sent: 9  Rows_examined: 93
SET timestamp=1351008911;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 06:27:08' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:15:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.015357  Lock_time: 0.000106 Rows_sent: 5  Rows_examined: 4123
SET timestamp=1351008918;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'University of North Carolina'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'University of North Carolina'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.320079  Lock_time: 0.000080 Rows_sent: 17  Rows_examined: 1761
SET timestamp=1351008918;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:18:06' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:15:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.176862  Lock_time: 0.000150 Rows_sent: 7  Rows_examined: 77849
SET timestamp=1351008919;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-22 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023  9:15:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.875718  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 28102
SET timestamp=1351008923;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:15:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.261733  Lock_time: 0.000135 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351008934;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  9:15:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.095454  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351008949;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:16:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.073551  Lock_time: 0.000064 Rows_sent: 389  Rows_examined: 1096609
SET timestamp=1351008974;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023  9:16:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.800792  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351008994;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:17:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.465359  Lock_time: 0.000120 Rows_sent: 124  Rows_examined: 1046740
SET timestamp=1351009025;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:17:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.361384  Lock_time: 0.000072 Rows_sent: 468  Rows_examined: 1242219
SET timestamp=1351009026;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:17:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.727004  Lock_time: 0.000164 Rows_sent: 16539  Rows_examined: 8090111
SET timestamp=1351009031;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:17:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 171.498540  Lock_time: 0.000201 Rows_sent: 1493  Rows_examined: 6452257
SET timestamp=1351009073;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  9:18:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.525336  Lock_time: 0.000087 Rows_sent: 22  Rows_examined: 28102
SET timestamp=1351009100;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:18:57
# Time: 121023  9:18:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.604061  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242224
SET timestamp=1351009138;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:19:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.750848  Lock_time: 0.000133 Rows_sent: 22  Rows_examined: 29835
SET timestamp=1351009174;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 18:30:20' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:20:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.998543  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 18891
SET timestamp=1351009205;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:20:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.689335  Lock_time: 0.000072 Rows_sent: 7176  Rows_examined: 12738
SET timestamp=1351009207;
SELECT data FROM interest WHERE `datetime` > NOW() - INTERVAL 10 DAY AND submit=1 AND data <> "";
# Time: 121023  9:20:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.098194  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351009223;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.097997  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351009223;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:20:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.618439  Lock_time: 0.000182 Rows_sent: 16539  Rows_examined: 8090345
SET timestamp=1351009237;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:21:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.288439  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 77849
SET timestamp=1351009278;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-22 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023  9:21:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.693225  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 28102
SET timestamp=1351009282;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:21:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.136982  Lock_time: 0.000087 Rows_sent: 389  Rows_examined: 1096628
SET timestamp=1351009289;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023  9:21:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.061580  Lock_time: 0.000148 Rows_sent: 124  Rows_examined: 1046749
SET timestamp=1351009294;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:21:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.595382  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242228
SET timestamp=1351009295;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:22:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.031013  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1046754
SET timestamp=1351009364;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.362896  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242233
SET timestamp=1351009364;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:22:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.444015  Lock_time: 0.000171 Rows_sent: 16539  Rows_examined: 8090560
SET timestamp=1351009370;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:22:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.082562  Lock_time: 0.000127 Rows_sent: 65112  Rows_examined: 1735895
SET timestamp=1351009377;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  9:24:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.553324  Lock_time: 0.000108 Rows_sent: 22  Rows_examined: 28102
SET timestamp=1351009460;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-22 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:25:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.721780  Lock_time: 0.000122 Rows_sent: 124  Rows_examined: 1046758
SET timestamp=1351009500;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:25:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.415152  Lock_time: 0.000068 Rows_sent: 468  Rows_examined: 1242237
SET timestamp=1351009501;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:25:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.174945  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351009517;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:26:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.891565  Lock_time: 0.000142 Rows_sent: 468  Rows_examined: 1242240
SET timestamp=1351009583;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  9:26:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.344295  Lock_time: 0.000186 Rows_sent: 16539  Rows_examined: 8090728
SET timestamp=1351009588;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:26:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.091667  Lock_time: 0.000099 Rows_sent: 124  Rows_examined: 1046763
SET timestamp=1351009599;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
# Time: 121023  9:26:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.889983  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242242
SET timestamp=1351009600;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:26:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.982579  Lock_time: 0.000155 Rows_sent: 1493  Rows_examined: 6452390
SET timestamp=1351009610;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  9:27:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.622531  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351009623;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:27:18
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 3.091030  Lock_time: 0.000069 Rows_sent: 30  Rows_examined: 417
SET timestamp=1351009638;
SELECT id,affiliate,email,program_id,lead_price,affiliate_price,university,sent_date,disqualified from `sessions` where university like 'Strayer University Online WT' and sent_date > '2012-10-01'
 LIMIT 0, 30;
# Time: 121023  9:27:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.357432  Lock_time: 0.000054 Rows_sent: 7  Rows_examined: 2864
SET timestamp=1351009644;
SELECT DISTINCT client_name FROM warmtransfer_agent;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.991229  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 0
SET timestamp=1351009644;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.id = 1164812
    AND sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
LIMIT 1;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.401271  Lock_time: 0.000110 Rows_sent: 5  Rows_examined: 1356
SET timestamp=1351009644;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 5.656415  Lock_time: 0.000065 Rows_sent: 3  Rows_examined: 3
SET timestamp=1351009644;
SHOW TABLE STATUS FROM `degreeamerica` LIKE 'sessions%';
# Time: 121023  9:27:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.359751  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351009652;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  9:27:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.109465  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351009678;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023  9:27:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.372092  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351009679;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  9:28:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.537356  Lock_time: 0.011703 Rows_sent: 468  Rows_examined: 1242244
SET timestamp=1351009684;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023  9:28:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.320437  Lock_time: 0.000099 Rows_sent: 389  Rows_examined: 1096645
SET timestamp=1351009690;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.819324  Lock_time: 0.000083 Rows_sent: 389  Rows_examined: 1096645
SET timestamp=1351009690;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.404720  Lock_time: 0.000069 Rows_sent: 389  Rows_examined: 1096642
SET timestamp=1351009690;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.210930  Lock_time: 0.000082 Rows_sent: 389  Rows_examined: 1096642
SET timestamp=1351009690;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023  9:28:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.385152  Lock_time: 0.005752 Rows_sent: 1437  Rows_examined: 322835
SET timestamp=1351009691;
SELECT name,IF(affiliate='','(None)',affiliate),SUM(sent),SUM(disqualified),SUM(IF(LEFT(reason,3)='***',1,0)),COUNT(1),SUM(enrolled),SUM(applied),SUM(lead_price),SUM(dq_cost),SUM(scrub_cost),SUM(IF(sent=1,score,null))/SUM(sent) FROM ((SELECT `allocations`.name,sessions.affiliate,sessions.sent,sessions.disqualified,sessions.reason,sessions.enrolled,sessions.applied,sessions.score,IF(sessions.sent=1 AND sessions.disqualified=0, sessions.lead_price,0) AS lead_price,IF(sessions.sent=1 AND sessions.disqualified=1,sessions.lead_price,0) AS dq_cost,IF(LEFT(sessions.reason,3)='***',sessions.lead_price,0) AS scrub_cost FROM sessions,`programs`,`allocations` WHERE sessions.`show`=1 AND (sessions.sent=1 OR sessions.disqualified=1) AND sessions.program_id=`programs`.id AND `programs`.allocation_id=`allocations`.id AND sessions.sent_date <= '2012-10-22 23:59:59' AND sessions.sent_date >= '2012-10-01') UNION ALL (SELECT `allocations`.name,reject.affiliate,0,1,reject.reason,0,0,0,0,0,0 FROM reject,`programs`,`allocations` WHERE reject.program_id=`programs`.id AND `programs`.allocation_id=`allocations`.id AND reject.datetime <= '2012-10-22 23:59:59' AND reject.datetime >= '2012-10-01')) AS ut GROUP BY name,affiliate WITH ROLLUP;
# Time: 121023  9:28:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.098342  Lock_time: 0.000112 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351009718;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  9:28:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.915380  Lock_time: 0.016936 Rows_sent: 124  Rows_examined: 1046769
SET timestamp=1351009735;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:28:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.546363  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242249
SET timestamp=1351009736;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:29:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.353938  Lock_time: 0.000179 Rows_sent: 16539  Rows_examined: 8091021
SET timestamp=1351009742;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.564918  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 18911
SET timestamp=1351009803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:30:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.245111  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351009820;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:30:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.858746  Lock_time: 0.000131 Rows_sent: 3  Rows_examined: 29639
SET timestamp=1351009821;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.828539  Lock_time: 0.000133 Rows_sent: 3  Rows_examined: 29639
SET timestamp=1351009821;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  9:31:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.013145  Lock_time: 0.000103 Rows_sent: 124  Rows_examined: 1046770
SET timestamp=1351009882;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:31:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.784042  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242250
SET timestamp=1351009883;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:32:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.071290  Lock_time: 0.000042 Rows_sent: 0  Rows_examined: 18920
SET timestamp=1351009922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.699710  Lock_time: 0.000184 Rows_sent: 3  Rows_examined: 29853
SET timestamp=1351009936;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
# Time: 121023  9:32:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.541846  Lock_time: 0.000189 Rows_sent: 16539  Rows_examined: 8091157
SET timestamp=1351009962;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:33:03
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 1.630933  Lock_time: 0.000065 Rows_sent: 1  Rows_examined: 17109
SET timestamp=1351009983;
SELECT distinct(affiliate),count(affiliate) from `prospectives` where affiliate like 'kaplan%' and sent_date > '2012-10-01' and qualified=1
 LIMIT 0, 30;
# Time: 121023  9:33:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.772788  Lock_time: 0.000080 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351010000;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:33:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.611890  Lock_time: 0.000091 Rows_sent: 124  Rows_examined: 1046776
SET timestamp=1351010001;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:33:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.348477  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1242256
SET timestamp=1351010002;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:34:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.197265  Lock_time: 0.000143 Rows_sent: 124  Rows_examined: 1046783
SET timestamp=1351010098;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:34:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.623221  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242263
SET timestamp=1351010099;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:35:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.906394  Lock_time: 0.000222 Rows_sent: 16539  Rows_examined: 8091324
SET timestamp=1351010105;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:35:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.634911  Lock_time: 0.000075 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351010114;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:36:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.864574  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351010180;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:36:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.011252  Lock_time: 0.000148 Rows_sent: 124  Rows_examined: 1046789
SET timestamp=1351010189;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:36:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.029821  Lock_time: 0.000134 Rows_sent: 468  Rows_examined: 1242270
SET timestamp=1351010190;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:37:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.999692  Lock_time: 0.000118 Rows_sent: 1493  Rows_examined: 6452506
SET timestamp=1351010229;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  9:38:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.782745  Lock_time: 0.000250 Rows_sent: 16539  Rows_examined: 8091505
SET timestamp=1351010287;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:38:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.840122  Lock_time: 0.000079 Rows_sent: 125  Rows_examined: 1046792
SET timestamp=1351010328;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:38:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.291646  Lock_time: 0.000157 Rows_sent: 468  Rows_examined: 1242273
SET timestamp=1351010329;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:39:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.343082  Lock_time: 0.000125 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351010359;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:40:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.035652  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 18944
SET timestamp=1351010402;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:40:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.394336  Lock_time: 0.000180 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351010419;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.343782  Lock_time: 0.000111 Rows_sent: 0  Rows_examined: 29637
SET timestamp=1351010419;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:41:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.288431  Lock_time: 0.000100 Rows_sent: 2994  Rows_examined: 269382
SET timestamp=1351010475;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023  9:41:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.369592  Lock_time: 0.000092 Rows_sent: 125  Rows_examined: 1046798
SET timestamp=1351010477;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:41:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.962456  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242279
SET timestamp=1351010478;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
# Time: 121023  9:41:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.685656  Lock_time: 0.000250 Rows_sent: 16539  Rows_examined: 8091804
SET timestamp=1351010484;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:42:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.705183  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351010540;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:42:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.172321  Lock_time: 0.000095 Rows_sent: 125  Rows_examined: 1046804
SET timestamp=1351010572;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.374648  Lock_time: 0.000074 Rows_sent: 468  Rows_examined: 1242285
SET timestamp=1351010572;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:43:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.476879  Lock_time: 0.000129 Rows_sent: 65117  Rows_examined: 1736027
SET timestamp=1351010585;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023  9:44:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.402822  Lock_time: 3.809748 Rows_sent: 16539  Rows_examined: 8091976
SET timestamp=1351010666;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:45:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.399840  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351010713;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:45:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.675826  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351010720;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:45:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.670748  Lock_time: 24.316293 Rows_sent: 125  Rows_examined: 1046805
SET timestamp=1351010726;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:45:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.878635  Lock_time: 24.317605 Rows_sent: 468  Rows_examined: 1242286
SET timestamp=1351010727;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:46:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.532177  Lock_time: 0.000137 Rows_sent: 125  Rows_examined: 1046915
SET timestamp=1351010806;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:46:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.576401  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242297
SET timestamp=1351010807;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:46:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.775144  Lock_time: 0.000129 Rows_sent: 16539  Rows_examined: 8092345
SET timestamp=1351010812;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:47:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 152.351340  Lock_time: 25.809781 Rows_sent: 1493  Rows_examined: 6452620
SET timestamp=1351010854;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  9:48:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.683260  Lock_time: 0.000121 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351010900;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:49:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.241952  Lock_time: 0.000127 Rows_sent: 125  Rows_examined: 1046923
SET timestamp=1351010942;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:49:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.623433  Lock_time: 0.000138 Rows_sent: 468  Rows_examined: 1242305
SET timestamp=1351010943;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.592609  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 18970
SET timestamp=1351011004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.830368  Lock_time: 0.000079 Rows_sent: 2  Rows_examined: 29638
SET timestamp=1351011017;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.836360  Lock_time: 0.000115 Rows_sent: 2  Rows_examined: 29638
SET timestamp=1351011017;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023  9:50:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.743330  Lock_time: 0.000206 Rows_sent: 16539  Rows_examined: 8092572
SET timestamp=1351011023;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
# Time: 121023  9:51:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.556282  Lock_time: 0.000116 Rows_sent: 125  Rows_examined: 1046925
SET timestamp=1351011076;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.063625  Lock_time: 0.000150 Rows_sent: 468  Rows_examined: 1242307
SET timestamp=1351011076;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:51:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.556769  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351011080;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.072926  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 18978
SET timestamp=1351011122;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023  9:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.923185  Lock_time: 0.000155 Rows_sent: 3  Rows_examined: 29915
SET timestamp=1351011136;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023  9:53:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.283177  Lock_time: 0.000189 Rows_sent: 126  Rows_examined: 1046931
SET timestamp=1351011204;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023  9:53:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.096645  Lock_time: 0.000143 Rows_sent: 468  Rows_examined: 1242313
SET timestamp=1351011205;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:53:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.073422  Lock_time: 0.000258 Rows_sent: 16539  Rows_examined: 8092795
SET timestamp=1351011211;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:54:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.718910  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351011260;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:55:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.332951  Lock_time: 0.000157 Rows_sent: 126  Rows_examined: 1046935
SET timestamp=1351011300;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.833799  Lock_time: 0.000119 Rows_sent: 468  Rows_examined: 1242317
SET timestamp=1351011300;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:55:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.881207  Lock_time: 0.000078 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351011317;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023  9:55:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.004554  Lock_time: 0.000075 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351011354;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023  9:56:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.023814  Lock_time: 0.000138 Rows_sent: 1493  Rows_examined: 6451271
SET timestamp=1351011385;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023  9:56:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.580416  Lock_time: 0.000222 Rows_sent: 16539  Rows_examined: 8093027
SET timestamp=1351011389;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023  9:56:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.496236  Lock_time: 0.000133 Rows_sent: 126  Rows_examined: 1046941
SET timestamp=1351011416;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.806234  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1242323
SET timestamp=1351011416;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:57:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.728112  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351011440;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023  9:58:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.733230  Lock_time: 0.000116 Rows_sent: 126  Rows_examined: 1046945
SET timestamp=1351011534;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.211912  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242327
SET timestamp=1351011534;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023  9:59:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.848348  Lock_time: 0.000185 Rows_sent: 16539  Rows_examined: 8093275
SET timestamp=1351011541;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.668062  Lock_time: 0.000071 Rows_sent: 20  Rows_examined: 898
SET timestamp=1351011604;
SELECT
    interest.id,
    interest.data
FROM
    interest
    LEFT JOIN interest_ext ON (
        interest.id = interest_ext.interest_id
    )
WHERE
    interest_ext.interest_id IS NULL
--    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
# Time: 121023 10:00:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.596088  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 29638
SET timestamp=1351011654;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.598103  Lock_time: 0.000088 Rows_sent: 2  Rows_examined: 29638
SET timestamp=1351011654;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 10:00:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.112693  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351011655;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 10:02:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 123.974920  Lock_time: 0.000116 Rows_sent: 126  Rows_examined: 1046958
SET timestamp=1351011726;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:02:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.534504  Lock_time: 0.000111 Rows_sent: 468  Rows_examined: 1242340
SET timestamp=1351011727;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:02:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.316711  Lock_time: 0.000210 Rows_sent: 16539  Rows_examined: 8093744
SET timestamp=1351011732;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:02:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.360010  Lock_time: 0.000167 Rows_sent: 65121  Rows_examined: 1736185
SET timestamp=1351011768;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 10:03:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.548817  Lock_time: 0.000107 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351011800;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:04:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.650638  Lock_time: 0.000177 Rows_sent: 126  Rows_examined: 1046962
SET timestamp=1351011893;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:04:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.373558  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242345
SET timestamp=1351011894;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:05:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.715541  Lock_time: 0.000242 Rows_sent: 16539  Rows_examined: 8093923
SET timestamp=1351011900;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:05:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.064196  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351011916;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 10:06:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.007098  Lock_time: 0.000041 Rows_sent: 0  Rows_examined: 19017
SET timestamp=1351011962;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:06:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.702452  Lock_time: 0.000103 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351011980;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:06:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.760708  Lock_time: 0.000134 Rows_sent: 1493  Rows_examined: 6451424
SET timestamp=1351012004;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 10:07:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.080484  Lock_time: 0.000104 Rows_sent: 126  Rows_examined: 1046970
SET timestamp=1351012028;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:07:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.907492  Lock_time: 0.000076 Rows_sent: 468  Rows_examined: 1242353
SET timestamp=1351012029;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:08:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.743822  Lock_time: 0.000267 Rows_sent: 16539  Rows_examined: 8094174
SET timestamp=1351012092;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:08:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.144597  Lock_time: 0.000212 Rows_sent: 126  Rows_examined: 1046972
SET timestamp=1351012124;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
# Time: 121023 10:08:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.892673  Lock_time: 0.000119 Rows_sent: 468  Rows_examined: 1242355
SET timestamp=1351012125;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:09:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.578386  Lock_time: 0.000073 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351012160;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:10:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.505351  Lock_time: 0.000050 Rows_sent: 0  Rows_examined: 19025
SET timestamp=1351012203;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.396738  Lock_time: 0.000092 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351012219;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.392333  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351012219;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 10:11:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.247378  Lock_time: 0.000147 Rows_sent: 126  Rows_examined: 1046975
SET timestamp=1351012273;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:11:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.991636  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242358
SET timestamp=1351012274;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:11:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.314880  Lock_time: 0.000174 Rows_sent: 16539  Rows_examined: 8094335
SET timestamp=1351012279;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:11:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.715005  Lock_time: 0.000054 Rows_sent: 15  Rows_examined: 482
SET timestamp=1351012288;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23' AND interest.datetime < '2012-10-23 09:11:26' GROUP BY interest.affiliate;
# Time: 121023 10:12:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.259761  Lock_time: 0.000107 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351012326;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.413189  Lock_time: 0.000051 Rows_sent: 0  Rows_examined: 19026
SET timestamp=1351012326;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:12:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.225800  Lock_time: 0.000104 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351012341;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 10:12:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 23.901465  Lock_time: 0.000108 Rows_sent: 3  Rows_examined: 29968
SET timestamp=1351012345;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 10:12:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.758343  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351012346;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:12:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.998332  Lock_time: 0.000080 Rows_sent: 389  Rows_examined: 1096758
SET timestamp=1351012358;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 10:13:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.932807  Lock_time: 0.000072 Rows_sent: 126  Rows_examined: 1046976
SET timestamp=1351012418;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.666174  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242359
SET timestamp=1351012418;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:13:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.305350  Lock_time: 0.000209 Rows_sent: 16539  Rows_examined: 8094386
SET timestamp=1351012424;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:14:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.402534  Lock_time: 0.000094 Rows_sent: 126  Rows_examined: 1046979
SET timestamp=1351012496;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.886864  Lock_time: 0.000115 Rows_sent: 468  Rows_examined: 1242362
SET timestamp=1351012496;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:15:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.182880  Lock_time: 0.000107 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351012515;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 10:15:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.578936  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351012520;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:16:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.057953  Lock_time: 0.000134 Rows_sent: 1493  Rows_examined: 6451461
SET timestamp=1351012598;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 10:17:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.716598  Lock_time: 33.362941 Rows_sent: 126  Rows_examined: 1046980
SET timestamp=1351012650;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:17:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.348510  Lock_time: 33.358556 Rows_sent: 468  Rows_examined: 1242363
SET timestamp=1351012651;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
# Time: 121023 10:17:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.017344  Lock_time: 33.335140 Rows_sent: 16539  Rows_examined: 8094510
SET timestamp=1351012657;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:18:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.619729  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351012701;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:18:33
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 1.240928  Lock_time: 0.000072 Rows_sent: 245  Rows_examined: 245
SET timestamp=1351012713;
SHOW TABLE STATUS FROM `degreeamerica`;
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 1.137176  Lock_time: 0.000090 Rows_sent: 245  Rows_examined: 245
SET timestamp=1351012713;
SHOW TABLE STATUS FROM `degreeamerica`;
# Time: 121023 10:19:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.314970  Lock_time: 0.000128 Rows_sent: 126  Rows_examined: 1046983
SET timestamp=1351012752;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:19:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.047678  Lock_time: 0.000112 Rows_sent: 468  Rows_examined: 1242366
SET timestamp=1351012753;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.571391  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19037
SET timestamp=1351012804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:20:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.988344  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351012817;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.995960  Lock_time: 0.000090 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351012817;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 10:20:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.871668  Lock_time: 0.000206 Rows_sent: 16539  Rows_examined: 8094697
SET timestamp=1351012826;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:21:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.043886  Lock_time: 0.000128 Rows_sent: 127  Rows_examined: 1046987
SET timestamp=1351012873;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:21:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.621483  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1242370
SET timestamp=1351012874;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:22:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.035668  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19042
SET timestamp=1351012922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.255932  Lock_time: 0.000116 Rows_sent: 7  Rows_examined: 926258
SET timestamp=1351012922;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:22:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.973412  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351012925;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:22:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.245053  Lock_time: 0.000104 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351012938;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 10:22:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.084058  Lock_time: 0.000108 Rows_sent: 389  Rows_examined: 1096776
SET timestamp=1351012963;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 10:22:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.327581  Lock_time: 0.000170 Rows_sent: 127  Rows_examined: 1046992
SET timestamp=1351012972;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.541215  Lock_time: 0.000109 Rows_sent: 468  Rows_examined: 1242375
SET timestamp=1351012972;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:22:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.064853  Lock_time: 0.000234 Rows_sent: 16539  Rows_examined: 8094940
SET timestamp=1351012979;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:23:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.951155  Lock_time: 0.000122 Rows_sent: 65124  Rows_examined: 1736275
SET timestamp=1351012992;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 10:23:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.814097  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1242380
SET timestamp=1351013014;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 10:25:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.184738  Lock_time: 0.000195 Rows_sent: 7  Rows_examined: 926265
SET timestamp=1351013110;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:25:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.287374  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351013114;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:25:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.056302  Lock_time: 0.000109 Rows_sent: 127  Rows_examined: 1047001
SET timestamp=1351013117;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:25:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 10:26:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.859176  Lock_time: 0.000152 Rows_sent: 1493  Rows_examined: 6451524
SET timestamp=1351013185;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 10:26:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.533413  Lock_time: 0.000225 Rows_sent: 16539  Rows_examined: 8095197
SET timestamp=1351013188;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:26:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.910561  Lock_time: 0.000109 Rows_sent: 127  Rows_examined: 1047006
SET timestamp=1351013214;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.255791  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242389
SET timestamp=1351013214;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:27:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.139572  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351013258;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.532008  Lock_time: 0.000122 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351013258;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 10:28:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.017264  Lock_time: 0.000121 Rows_sent: 7  Rows_examined: 926270
SET timestamp=1351013281;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:28:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.965760  Lock_time: 0.000121 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351013284;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:28:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.839675  Lock_time: 0.000159 Rows_sent: 127  Rows_examined: 1047010
SET timestamp=1351013335;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:28:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.396431  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242393
SET timestamp=1351013336;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:29:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.304453  Lock_time: 0.000184 Rows_sent: 16539  Rows_examined: 8095360
SET timestamp=1351013341;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.622804  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 19066
SET timestamp=1351013404;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:30:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.975500  Lock_time: 0.000141 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351013420;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.965238  Lock_time: 0.000094 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351013420;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 10:31:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.309762  Lock_time: 0.000126 Rows_sent: 7  Rows_examined: 926277
SET timestamp=1351013476;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:31:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.168495  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351013479;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.108062  Lock_time: 0.000082 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351013479;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 10:31:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.010767  Lock_time: 0.000139 Rows_sent: 127  Rows_examined: 1047016
SET timestamp=1351013486;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:31:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.063074  Lock_time: 0.000117 Rows_sent: 468  Rows_examined: 1242399
SET timestamp=1351013487;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:32:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.102730  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19069
SET timestamp=1351013522;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.811920  Lock_time: 0.000197 Rows_sent: 3  Rows_examined: 30022
SET timestamp=1351013536;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 10:32:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.219547  Lock_time: 0.000289 Rows_sent: 16539  Rows_examined: 8095692
SET timestamp=1351013573;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
# Time: 121023 10:33:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.203117  Lock_time: 0.000100 Rows_sent: 127  Rows_examined: 1047020
SET timestamp=1351013591;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.488085  Lock_time: 0.000088 Rows_sent: 468  Rows_examined: 1242403
SET timestamp=1351013591;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:34:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.177922  Lock_time: 0.000148 Rows_sent: 7  Rows_examined: 926280
SET timestamp=1351013640;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:34:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.696954  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351013643;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:34:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.674037  Lock_time: 0.000129 Rows_sent: 127  Rows_examined: 1047026
SET timestamp=1351013694;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:34:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.277343  Lock_time: 0.000206 Rows_sent: 468  Rows_examined: 1242409
SET timestamp=1351013695;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:35:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.085964  Lock_time: 0.000181 Rows_sent: 16539  Rows_examined: 8095968
SET timestamp=1351013701;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:35:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.108754  Lock_time: 0.000087 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351013715;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 10:36:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.701636  Lock_time: 0.000054 Rows_sent: 15  Rows_examined: 463
SET timestamp=1351013802;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 09:06:38' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:36:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.710403  Lock_time: 0.000137 Rows_sent: 1493  Rows_examined: 6451649
SET timestamp=1351013808;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 10:36:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.173910  Lock_time: 0.000077 Rows_sent: 1  Rows_examined: 2180
SET timestamp=1351013813;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.university='University of Southern California' ORDER BY sessions.sent_date DESC;
# Time: 121023 10:37:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.654991  Lock_time: 0.000128 Rows_sent: 10  Rows_examined: 55485
SET timestamp=1351013825;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.university='University of Southern California' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 10:37:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.859912  Lock_time: 0.000220 Rows_sent: 7  Rows_examined: 926292
SET timestamp=1351013827;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:37:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.936626  Lock_time: 0.000078 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351013830;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:37:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.349442  Lock_time: 0.000078 Rows_sent: 127  Rows_examined: 1047038
SET timestamp=1351013840;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:37:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.550330  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242421
SET timestamp=1351013841;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:38:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.172778  Lock_time: 0.000210 Rows_sent: 16539  Rows_examined: 8096345
SET timestamp=1351013917;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:38:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.448692  Lock_time: 0.000137 Rows_sent: 127  Rows_examined: 1047041
SET timestamp=1351013924;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.612817  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1242424
SET timestamp=1351013924;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:39:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.708110  Lock_time: 0.000138 Rows_sent: 828  Rows_examined: 22192
SET timestamp=1351013956;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,sessions.data,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-10-01' AND sessions.expire < '2012-10-24'  AND sessions.university IN ('University of Southern California','University of Southern California I','University of Southern California N');
# Time: 121023 10:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.421440  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19102
SET timestamp=1351014004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:40:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.093924  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351014016;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 10:40:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.292210  Lock_time: 0.000140 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351014018;
# Time: 121023 10:40:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.642252  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926298
SET timestamp=1351014020;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:40:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.388643  Lock_time: 0.000077 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351014023;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.396307  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351014023;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 10:40:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.238831  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351014024;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:40:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 115.107304  Lock_time: 0.028022 Rows_sent: 14900  Rows_examined: 6606539
SET timestamp=1351014050;
SELECT
    `allocations_2012-08`.id,
    concat(`allocations_2012-08`.name, ' ', database()) as name,
    `allocations_2012-08`.allocation,
    `allocations_2012-08`.updated,
    `allocations_2012-08`.filldays,
    `allocations_2012-08`.daycap,
    `universities_2012-08`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations_2012-08`.allocation AS perc,
    `affiliates_price_2012-08`.allocation,
    affiliates.name,
    `allocations_2012-08`.pause,
    `allocations_2012-08`.price
FROM
    `allocations_2012-08`,
    `universities_2012-08`,
    paul.`affiliates_price_2012-08`,
    affiliates,
    `programs_2012-08` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs_2012-08`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '8-2012'
WHERE
    `allocations_2012-08`.id=`programs_2012-08`.allocation_id
    AND `programs_2012-08`.university_id=`universities_2012-08`.id
    AND `affiliates_price_2012-08`.allocation_id=`allocations_2012-08`.id
    AND `affiliates_price_2012-08`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations_2012-08`.id,
    `affiliates_price_2012-08`.id
ORDER BY
    `allocations_2012-08`.name;
# Time: 121023 10:41:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.724797  Lock_time: 0.000128 Rows_sent: 127  Rows_examined: 1047051
SET timestamp=1351014064;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:41:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.360455  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242434
SET timestamp=1351014065;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:41:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.595676  Lock_time: 0.000173 Rows_sent: 16539  Rows_examined: 8096710
SET timestamp=1351014072;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:42:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.696502  Lock_time: 0.000111 Rows_sent: 127  Rows_examined: 1047059
SET timestamp=1351014173;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.914374  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242442
SET timestamp=1351014173;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.649764  Lock_time: 0.000170 Rows_sent: 7  Rows_examined: 926305
SET timestamp=1351014173;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.788476  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351014176;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:43:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.035445  Lock_time: 0.000181 Rows_sent: 65132  Rows_examined: 1736448
SET timestamp=1351014188;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 10:44:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.161607  Lock_time: 0.000184 Rows_sent: 16539  Rows_examined: 8097054
SET timestamp=1351014264;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:44:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.344553  Lock_time: 0.000076 Rows_sent: 127  Rows_examined: 1047064
SET timestamp=1351014291;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.785618  Lock_time: 0.000111 Rows_sent: 468  Rows_examined: 1242447
SET timestamp=1351014291;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:45:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.521307  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351014316;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 10:46:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.483725  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 19120
SET timestamp=1351014364;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:46:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.219055  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926310
SET timestamp=1351014372;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:46:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.893143  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351014375;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:46:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.376999  Lock_time: 0.000114 Rows_sent: 1493  Rows_examined: 6451790
SET timestamp=1351014404;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 10:46:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.309510  Lock_time: 0.000102 Rows_sent: 127  Rows_examined: 1047069
SET timestamp=1351014414;
SELECT /* Memcached:Remaining_Allocations*/
# Time: 121023 10:47:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.475274  Lock_time: 0.000242 Rows_sent: 16539  Rows_examined: 8097224
SET timestamp=1351014421;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:49:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.101696  Lock_time: 0.000194 Rows_sent: 7  Rows_examined: 926320
SET timestamp=1351014545;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:49:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.962421  Lock_time: 0.000111 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351014548;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:49:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.950808  Lock_time: 0.000133 Rows_sent: 127  Rows_examined: 1047076
SET timestamp=1351014550;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:49:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.911440  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1242460
SET timestamp=1351014551;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.797473  Lock_time: 0.000047 Rows_sent: 0  Rows_examined: 19135
SET timestamp=1351014604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:50:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.825148  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351014619;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.831696  Lock_time: 0.000123 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351014619;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 10:50:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.821874  Lock_time: 0.000217 Rows_sent: 16539  Rows_examined: 8097568
SET timestamp=1351014647;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:51:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.519389  Lock_time: 0.000105 Rows_sent: 127  Rows_examined: 1047083
SET timestamp=1351014665;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.710911  Lock_time: 0.000080 Rows_sent: 468  Rows_examined: 1242467
SET timestamp=1351014665;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:51:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.370420  Lock_time: 0.000061 Rows_sent: 15  Rows_examined: 787
SET timestamp=1351014697;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:52:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.019424  Lock_time: 0.000119 Rows_sent: 7  Rows_examined: 926325
SET timestamp=1351014720;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:52:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.567587  Lock_time: 0.000041 Rows_sent: 0  Rows_examined: 19140
SET timestamp=1351014723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:52:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.161774  Lock_time: 0.000073 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351014725;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.412665  Lock_time: 0.000129 Rows_sent: 3  Rows_examined: 30096
SET timestamp=1351014736;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 10:53:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.698492  Lock_time: 0.000090 Rows_sent: 127  Rows_examined: 1047088
SET timestamp=1351014802;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.383348  Lock_time: 0.000070 Rows_sent: 468  Rows_examined: 1242472
SET timestamp=1351014802;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:53:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.798468  Lock_time: 0.000218 Rows_sent: 16539  Rows_examined: 8097811
SET timestamp=1351014809;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:54:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.733638  Lock_time: 0.000149 Rows_sent: 7  Rows_examined: 926329
SET timestamp=1351014899;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:55:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.336327  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351014904;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:55:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.335262  Lock_time: 0.000158 Rows_sent: 127  Rows_examined: 1047090
SET timestamp=1351014907;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
# Time: 121023 10:55:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.094288  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242474
SET timestamp=1351014909;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:55:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.640999  Lock_time: 0.000104 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351014919;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 10:56:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.059006  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19144
SET timestamp=1351014962;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 10:56:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.840275  Lock_time: 0.000154 Rows_sent: 1493  Rows_examined: 6451878
SET timestamp=1351014988;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 10:56:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.370341  Lock_time: 0.000247 Rows_sent: 16539  Rows_examined: 8097883
SET timestamp=1351014993;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 10:56:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.148503  Lock_time: 0.000118 Rows_sent: 127  Rows_examined: 1047092
SET timestamp=1351015017;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.385136  Lock_time: 0.000166 Rows_sent: 468  Rows_examined: 1242476
SET timestamp=1351015017;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:58:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.404175  Lock_time: 0.000154 Rows_sent: 7  Rows_examined: 926330
SET timestamp=1351015083;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 10:58:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.185491  Lock_time: 0.000104 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351015086;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 10:58:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.236774  Lock_time: 0.000173 Rows_sent: 127  Rows_examined: 1047093
SET timestamp=1351015136;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 10:58:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.969994  Lock_time: 0.000146 Rows_sent: 468  Rows_examined: 1242477
SET timestamp=1351015137;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 10:59:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.304349  Lock_time: 0.000183 Rows_sent: 16539  Rows_examined: 8097946
SET timestamp=1351015144;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.695132  Lock_time: 0.000170 Rows_sent: 134  Rows_examined: 4968
SET timestamp=1351015204;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.064052  Lock_time: 0.000075 Rows_sent: 0  Rows_examined: 19147
SET timestamp=1351015204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:00:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.447625  Lock_time: 0.000099 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351015248;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:00:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.298892  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351015254;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:00:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.491615  Lock_time: 0.000093 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351015256;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.491005  Lock_time: 0.000121 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351015256;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 11:01:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.045160  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926332
SET timestamp=1351015319;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:02:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.015817  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351015322;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.355066  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 19148
SET timestamp=1351015322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:02:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 132.685256  Lock_time: 0.000123 Rows_sent: 127  Rows_examined: 1047095
SET timestamp=1351015334;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:02:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 133.821387  Lock_time: 0.000160 Rows_sent: 468  Rows_examined: 1242479
SET timestamp=1351015335;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:02:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.309270  Lock_time: 0.000209 Rows_sent: 16539  Rows_examined: 8098033
SET timestamp=1351015340;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
# Time: 121023 11:02:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.730106  Lock_time: 0.000179 Rows_sent: 65135  Rows_examined: 1736550
SET timestamp=1351015375;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 11:03:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.882750  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351015415;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 11:04:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.991581  Lock_time: 0.000171 Rows_sent: 7  Rows_examined: 926336
SET timestamp=1351015440;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:04:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.365803  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19158
SET timestamp=1351015442;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:04:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.467311  Lock_time: 0.000062 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351015443;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:04:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.746472  Lock_time: 0.000097 Rows_sent: 127  Rows_examined: 1047106
SET timestamp=1351015499;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.342989  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242490
SET timestamp=1351015499;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:05:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.867459  Lock_time: 0.000232 Rows_sent: 16539  Rows_examined: 8098320
SET timestamp=1351015506;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:05:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.204712  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29632
SET timestamp=1351015516;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 11:06:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.055389  Lock_time: 0.000168 Rows_sent: 1493  Rows_examined: 6451952
SET timestamp=1351015607;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 11:07:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.193708  Lock_time: 0.000140 Rows_sent: 7  Rows_examined: 926344
SET timestamp=1351015623;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:07:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.950624  Lock_time: 0.000114 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351015626;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:07:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.642679  Lock_time: 0.000203 Rows_sent: 127  Rows_examined: 1047115
SET timestamp=1351015632;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:07:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.867631  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242499
SET timestamp=1351015633;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:08:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.704631  Lock_time: 0.000210 Rows_sent: 16539  Rows_examined: 8098600
SET timestamp=1351015705;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:08:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.503115  Lock_time: 0.000128 Rows_sent: 127  Rows_examined: 1047117
SET timestamp=1351015729;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.923906  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242501
SET timestamp=1351015729;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.543274  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19171
SET timestamp=1351015804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:10:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.764727  Lock_time: 0.000154 Rows_sent: 7  Rows_examined: 926345
SET timestamp=1351015807;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:10:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.259685  Lock_time: 0.000108 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351015810;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:10:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.461404  Lock_time: 0.000101 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351015811;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.558501  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351015819;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.563890  Lock_time: 0.000103 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351015819;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
# Time: 121023 11:11:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.323403  Lock_time: 0.000096 Rows_sent: 127  Rows_examined: 1047120
SET timestamp=1351015877;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.727206  Lock_time: 0.000126 Rows_sent: 468  Rows_examined: 1242504
SET timestamp=1351015877;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:11:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.322562  Lock_time: 0.000179 Rows_sent: 16539  Rows_examined: 8098677
SET timestamp=1351015884;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:11:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.602672  Lock_time: 0.000061 Rows_sent: 3  Rows_examined: 2867
SET timestamp=1351015894;
SELECT 
    first_name,    
    last_name, 
    email, 
    agent_id,
    client_subid
FROM 
    warmtransfer_agent 
WHERE 
    client_name = 'Strayer' 
    AND (client_subid = '3480' OR client_subid IS NULL)
    AND available = 1 
ORDER BY 
    first_name, 
    last_name;
# Time: 121023 11:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.481315  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19176
SET timestamp=1351015922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:12:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.481102  Lock_time: 0.000151 Rows_sent: 3  Rows_examined: 30135
SET timestamp=1351015941;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 11:12:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.649519  Lock_time: 0.000055 Rows_sent: 389  Rows_examined: 1096908
SET timestamp=1351015967;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 11:13:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.239583  Lock_time: 0.000077 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351016010;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:13:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.886414  Lock_time: 0.000136 Rows_sent: 7  Rows_examined: 926347
SET timestamp=1351016012;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:13:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.860734  Lock_time: 0.000076 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351016015;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:13:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.483798  Lock_time: 0.000131 Rows_sent: 127  Rows_examined: 1047125
SET timestamp=1351016024;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:13:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.067564  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242509
SET timestamp=1351016025;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:13:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.434731  Lock_time: 0.000251 Rows_sent: 16539  Rows_examined: 8098780
SET timestamp=1351016032;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:14:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.320020  Lock_time: 0.000107 Rows_sent: 127  Rows_examined: 1047129
SET timestamp=1351016096;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.785493  Lock_time: 0.000154 Rows_sent: 468  Rows_examined: 1242513
SET timestamp=1351016096;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.574291  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351016116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 11:16:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.163423  Lock_time: 0.000125 Rows_sent: 7  Rows_examined: 926351
SET timestamp=1351016172;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:16:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.023219  Lock_time: 0.000088 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351016175;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:16:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.167269  Lock_time: 0.000111 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351016177;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:16:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.597604  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242517
SET timestamp=1351016196;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 11:16:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.274000  Lock_time: 0.000140 Rows_sent: 1493  Rows_examined: 6452009
SET timestamp=1351016213;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 11:17:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.682117  Lock_time: 0.000115 Rows_sent: 127  Rows_examined: 1047137
SET timestamp=1351016221;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.939478  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242521
SET timestamp=1351016221;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:17:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.174768  Lock_time: 0.000178 Rows_sent: 16539  Rows_examined: 8099020
SET timestamp=1351016228;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
# Time: 121023 11:18:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.638171  Lock_time: 0.000086 Rows_sent: 389  Rows_examined: 1096934
SET timestamp=1351016330;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 11:19:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.729925  Lock_time: 0.000061 Rows_sent: 15  Rows_examined: 493
SET timestamp=1351016349;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 09:13:05' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:19:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.467917  Lock_time: 0.000161 Rows_sent: 127  Rows_examined: 1047150
SET timestamp=1351016351;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:19:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.865397  Lock_time: 0.000122 Rows_sent: 468  Rows_examined: 1242534
SET timestamp=1351016353;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.817285  Lock_time: 0.000171 Rows_sent: 468  Rows_examined: 1242533
SET timestamp=1351016353;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 11:19:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.336762  Lock_time: 0.000111 Rows_sent: 7  Rows_examined: 926358
SET timestamp=1351016359;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:19:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.826809  Lock_time: 0.000067 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351016362;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.011171  Lock_time: 0.000091 Rows_sent: 0  Rows_examined: 19203
SET timestamp=1351016403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:20:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.603876  Lock_time: 0.000116 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351016423;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.598728  Lock_time: 0.000089 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351016423;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 11:20:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.075725  Lock_time: 0.000083 Rows_sent: 389  Rows_examined: 1096936
SET timestamp=1351016428;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 11:20:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 114.277870  Lock_time: 0.000218 Rows_sent: 16539  Rows_examined: 8099420
SET timestamp=1351016455;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:21:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.028839  Lock_time: 0.000090 Rows_sent: 127  Rows_examined: 1047152
SET timestamp=1351016471;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.231799  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1242536
SET timestamp=1351016471;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:22:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.282428  Lock_time: 0.000117 Rows_sent: 7  Rows_examined: 926360
SET timestamp=1351016520;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:22:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.831696  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351016523;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:22:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.819625  Lock_time: 0.000152 Rows_sent: 127  Rows_examined: 1047155
SET timestamp=1351016560;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.852861  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242539
SET timestamp=1351016560;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:22:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.850275  Lock_time: 0.000220 Rows_sent: 16539  Rows_examined: 8099485
SET timestamp=1351016567;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:22:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.549705  Lock_time: 0.000184 Rows_sent: 65142  Rows_examined: 1736697
SET timestamp=1351016574;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 11:25:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.425038  Lock_time: 0.000103 Rows_sent: 128  Rows_examined: 1047159
SET timestamp=1351016704;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:25:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.869856  Lock_time: 0.000199 Rows_sent: 7  Rows_examined: 926365
SET timestamp=1351016705;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.480552  Lock_time: 0.000105 Rows_sent: 468  Rows_examined: 1242543
SET timestamp=1351016705;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
# Time: 121023 11:25:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.673739  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351016719;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 11:26:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.348200  Lock_time: 0.000087 Rows_sent: 1493  Rows_examined: 6452139
SET timestamp=1351016786;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 11:26:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.705495  Lock_time: 0.000166 Rows_sent: 16539  Rows_examined: 8099683
SET timestamp=1351016790;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:26:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.804337  Lock_time: 0.000101 Rows_sent: 128  Rows_examined: 1047161
SET timestamp=1351016817;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.153982  Lock_time: 0.000073 Rows_sent: 468  Rows_examined: 1242545
SET timestamp=1351016817;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:28:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.906005  Lock_time: 0.000118 Rows_sent: 7  Rows_examined: 926367
SET timestamp=1351016880;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:28:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.022008  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351016883;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.411545  Lock_time: 0.000078 Rows_sent: 0  Rows_examined: 19219
SET timestamp=1351016883;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:28:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.819123  Lock_time: 0.000158 Rows_sent: 128  Rows_examined: 1047168
SET timestamp=1351016927;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:28:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.648959  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242552
SET timestamp=1351016928;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.262478  Lock_time: 0.000158 Rows_sent: 468  Rows_examined: 1242552
SET timestamp=1351016928;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 11:28:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.024297  Lock_time: 0.000279 Rows_sent: 16539  Rows_examined: 8099886
SET timestamp=1351016933;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.681429  Lock_time: 0.000080 Rows_sent: 0  Rows_examined: 19220
SET timestamp=1351017003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.738906  Lock_time: 0.000091 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351017018;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.761307  Lock_time: 0.000104 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351017018;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 11:31:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.914324  Lock_time: 0.000223 Rows_sent: 7  Rows_examined: 926367
SET timestamp=1351017073;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:31:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.092409  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351017076;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:31:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.793161  Lock_time: 0.000136 Rows_sent: 128  Rows_examined: 1047169
SET timestamp=1351017083;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.584861  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242553
SET timestamp=1351017083;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.909415  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19222
SET timestamp=1351017123;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.810534  Lock_time: 0.000186 Rows_sent: 3  Rows_examined: 30181
SET timestamp=1351017136;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 11:32:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 113.058402  Lock_time: 0.000164 Rows_sent: 16539  Rows_examined: 8100023
SET timestamp=1351017174;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
# Time: 121023 11:33:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.844325  Lock_time: 0.000099 Rows_sent: 128  Rows_examined: 1046149
SET timestamp=1351017196;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:33:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.262202  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1242555
SET timestamp=1351017197;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:33:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.260153  Lock_time: 0.000153 Rows_sent: 7  Rows_examined: 926369
SET timestamp=1351017236;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:33:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.792270  Lock_time: 0.000090 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351017239;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:34:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.622451  Lock_time: 0.000138 Rows_sent: 468  Rows_examined: 1242556
SET timestamp=1351017244;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 11:34:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.113228  Lock_time: 0.000177 Rows_sent: 128  Rows_examined: 1046152
SET timestamp=1351017297;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:34:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.599562  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242558
SET timestamp=1351017298;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:35:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.931991  Lock_time: 0.000191 Rows_sent: 16539  Rows_examined: 8100072
SET timestamp=1351017304;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:35:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.674626  Lock_time: 0.000065 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351017318;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 11:35:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.432005  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351017337;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 11:35:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.234486  Lock_time: 0.000107 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351017339;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:36:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.178312  Lock_time: 0.000052 Rows_sent: 389  Rows_examined: 1096958
SET timestamp=1351017383;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 11:37:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.220009  Lock_time: 0.000130 Rows_sent: 7  Rows_examined: 926373
SET timestamp=1351017424;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:37:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.214263  Lock_time: 0.000121 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351017427;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:37:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 130.564500  Lock_time: 0.000141 Rows_sent: 1493  Rows_examined: 6452209
SET timestamp=1351017431;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 11:37:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.406354  Lock_time: 0.000113 Rows_sent: 128  Rows_examined: 1046156
SET timestamp=1351017440;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:37:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.490029  Lock_time: 0.000115 Rows_sent: 468  Rows_examined: 1242562
SET timestamp=1351017441;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:38:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.813452  Lock_time: 0.000224 Rows_sent: 16539  Rows_examined: 8100307
SET timestamp=1351017500;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:38:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.707871  Lock_time: 0.000187 Rows_sent: 128  Rows_examined: 1046161
SET timestamp=1351017528;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:38:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.648940  Lock_time: 0.000119 Rows_sent: 468  Rows_examined: 1242568
SET timestamp=1351017529;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:40:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.394376  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926377
SET timestamp=1351017601;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:40:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.468840  Lock_time: 0.000064 Rows_sent: 0  Rows_examined: 19239
SET timestamp=1351017603;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:40:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.661267  Lock_time: 0.000117 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351017605;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:40:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.465347  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 29634
SET timestamp=1351017618;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 11:41:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.103118  Lock_time: 0.000093 Rows_sent: 128  Rows_examined: 1046166
SET timestamp=1351017680;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:41:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.710838  Lock_time: 0.000201 Rows_sent: 468  Rows_examined: 1242573
SET timestamp=1351017681;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:41:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.715281  Lock_time: 0.000216 Rows_sent: 16539  Rows_examined: 8100601
SET timestamp=1351017687;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:42:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.338348  Lock_time: 0.000098 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351017748;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:42:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.584370  Lock_time: 0.000120 Rows_sent: 128  Rows_examined: 1046170
SET timestamp=1351017773;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.737324  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242577
SET timestamp=1351017773;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:42:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.298326  Lock_time: 0.000133 Rows_sent: 7  Rows_examined: 926384
SET timestamp=1351017774;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.775859  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351017776;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:43:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.051011  Lock_time: 0.000112 Rows_sent: 65146  Rows_examined: 1736797
SET timestamp=1351017789;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 11:44:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.172135  Lock_time: 0.000217 Rows_sent: 16539  Rows_examined: 8100850
SET timestamp=1351017864;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:44:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.216917  Lock_time: 0.000100 Rows_sent: 128  Rows_examined: 1046178
SET timestamp=1351017890;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.719264  Lock_time: 0.000116 Rows_sent: 468  Rows_examined: 1242585
SET timestamp=1351017890;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:45:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.129193  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351017916;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 11:46:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.423135  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19255
SET timestamp=1351017964;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:46:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.852243  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926390
SET timestamp=1351017977;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:46:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.986932  Lock_time: 0.000070 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351017980;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:46:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.187230  Lock_time: 0.000193 Rows_sent: 1493  Rows_examined: 6452340
SET timestamp=1351018013;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 11:47:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.151803  Lock_time: 0.000118 Rows_sent: 128  Rows_examined: 1046179
SET timestamp=1351018024;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:47:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.941906  Lock_time: 0.000068 Rows_sent: 468  Rows_examined: 1242586
SET timestamp=1351018025;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:47:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.098174  Lock_time: 0.000170 Rows_sent: 16539  Rows_examined: 8101006
SET timestamp=1351018031;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:49:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.648588  Lock_time: 0.000139 Rows_sent: 7  Rows_examined: 926392
SET timestamp=1351018145;
# Time: 121023 11:49:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.792915  Lock_time: 0.000075 Rows_sent: 128  Rows_examined: 1046181
SET timestamp=1351018150;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.598809  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242588
SET timestamp=1351018150;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:50:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.237810  Lock_time: 0.000090 Rows_sent: 0  Rows_examined: 19264
SET timestamp=1351018203;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.448661  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351018217;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.452936  Lock_time: 0.000089 Rows_sent: 0  Rows_examined: 29633
SET timestamp=1351018217;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 11:50:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.511446  Lock_time: 0.000202 Rows_sent: 16539  Rows_examined: 8101326
SET timestamp=1351018236;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:51:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.541150  Lock_time: 0.000105 Rows_sent: 128  Rows_examined: 1046187
SET timestamp=1351018272;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:51:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.489367  Lock_time: 0.000159 Rows_sent: 468  Rows_examined: 1242595
SET timestamp=1351018273;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:51:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.478668  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 10578
SET timestamp=1351018282;
SELECT id_type, id_value, ad_text FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004873817615';
# Time: 121023 11:51:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.283303  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242596
SET timestamp=1351018313;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 11:51:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.472416  Lock_time: 0.000139 Rows_sent: 7  Rows_examined: 926398
SET timestamp=1351018316;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:51:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.641013  Lock_time: 0.000084 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351018319;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.252298  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 19268
SET timestamp=1351018322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 11:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.596171  Lock_time: 0.000142 Rows_sent: 3  Rows_examined: 30239
SET timestamp=1351018336;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 11:53:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.624347  Lock_time: 0.000097 Rows_sent: 128  Rows_examined: 1046191
SET timestamp=1351018404;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.191084  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1242599
SET timestamp=1351018404;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:53:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.061839  Lock_time: 0.000237 Rows_sent: 16539  Rows_examined: 8101376
SET timestamp=1351018410;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:55:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.547968  Lock_time: 0.000109 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351018503;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 11:55:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.217786  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926402
SET timestamp=1351018504;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:55:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.566748  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351018508;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:55:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.565811  Lock_time: 0.000140 Rows_sent: 128  Rows_examined: 1046195
SET timestamp=1351018512;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 11:55:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.299389  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1242603
SET timestamp=1351018514;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:55:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.829237  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351018519;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 11:56:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.354038  Lock_time: 0.000132 Rows_sent: 1493  Rows_examined: 6452434
SET timestamp=1351018586;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
# Time: 121023 11:56:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.128836  Lock_time: 0.000239 Rows_sent: 16539  Rows_examined: 8101565
SET timestamp=1351018588;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 11:56:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.735473  Lock_time: 0.000099 Rows_sent: 128  Rows_examined: 1046199
SET timestamp=1351018619;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.138848  Lock_time: 0.000069 Rows_sent: 468  Rows_examined: 1242607
SET timestamp=1351018619;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:58:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.252088  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926404
SET timestamp=1351018680;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 11:58:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.621853  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19277
SET timestamp=1351018683;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.324392  Lock_time: 0.000121 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351018683;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 11:58:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.654643  Lock_time: 0.000104 Rows_sent: 128  Rows_examined: 1046201
SET timestamp=1351018735;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.246432  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242609
SET timestamp=1351018735;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 11:59:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.890672  Lock_time: 0.000280 Rows_sent: 16539  Rows_examined: 8101627
SET timestamp=1351018741;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:00:04
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 1.057534  Lock_time: 0.000069 Rows_sent: 30  Rows_examined: 309
use calfinder;
SET timestamp=1351018804;
SELECT * FROM stats
WHERE 1=1 
AND (path = 'livingsocialUS' AND conversion = 1)
AND
DATETIME >= '2012-09-01 00:00:00' AND DATETIME < '2012-10-23 00:00:00'
 LIMIT 0, 30;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.589408  Lock_time: 0.000054 Rows_sent: 1781  Rows_examined: 1781
use degreeamerica;
SET timestamp=1351018804;
SELECT data FROM interest WHERE datetime>='2012-10-22 00:00:00' AND datetime<='2012-10-22 23:59:59';
# Time: 121023 12:00:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.006681  Lock_time: 0.000118 Rows_sent: 184  Rows_examined: 5286
SET timestamp=1351018805;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.316317  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19280
SET timestamp=1351018805;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:00:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.774668  Lock_time: 0.000045 Rows_sent: 8931  Rows_examined: 8931
SET timestamp=1351018808;
SELECT data FROM interest WHERE datetime>='2012-10-15 00:00:00' AND datetime<='2012-10-21 23:59:59';
# Time: 121023 12:01:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.057515  Lock_time: 0.000097 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351018868;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.043113  Lock_time: 0.000099 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351018868;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:01:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.554501  Lock_time: 0.000119 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351018886;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 12:01:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.584346  Lock_time: 0.000100 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351018887;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 12:01:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.150235  Lock_time: 0.000075 Rows_sent: 1  Rows_examined: 181429
SET timestamp=1351018893;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="University of Phoenix - General";
# Time: 121023 12:01:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.842008  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 33791
SET timestamp=1351018895;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Kaplan University - Main B Bachelor";
# Time: 121023 12:01:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.148921  Lock_time: 0.000077 Rows_sent: 1  Rows_examined: 47045
SET timestamp=1351018897;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Kaplan University - Main C Bachelor";
# Time: 121023 12:01:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.204760  Lock_time: 0.000062 Rows_sent: 1  Rows_examined: 17719
SET timestamp=1351018900;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Kaplan University - Main B Associate";
# Time: 121023 12:01:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.048822  Lock_time: 0.000102 Rows_sent: 1  Rows_examined: 18657
SET timestamp=1351018903;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Kaplan University - Main A Bachelor";
# Time: 121023 12:01:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.979488  Lock_time: 0.000125 Rows_sent: 7  Rows_examined: 926408
SET timestamp=1351018916;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:01:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.992669  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351018919;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:02:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.822506  Lock_time: 0.000066 Rows_sent: 1  Rows_examined: 83074
SET timestamp=1351018926;
SELECT COUNT(s.id),a.allocation FROM sessions AS s INNER JOIN programs AS p ON p.id=s.program_id INNER JOIN allocations AS a ON a.id=p.allocation_id WHERE s.sent_date>='2012-10-01 00:00:00' AND s.sent_date<='2012-10-22 23:59:59' AND s.disqualified=0 AND a.name="Full Sail University - Online";
# Time: 121023 12:02:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 131.120775  Lock_time: 0.000165 Rows_sent: 128  Rows_examined: 1046204
SET timestamp=1351018933;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:02:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 12:02:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.320286  Lock_time: 0.000191 Rows_sent: 16539  Rows_examined: 8101733
SET timestamp=1351018939;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:02:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.218535  Lock_time: 0.000127 Rows_sent: 65149  Rows_examined: 1736893
SET timestamp=1351018974;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 12:03:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.810879  Lock_time: 0.000134 Rows_sent: 7  Rows_examined: 926410
SET timestamp=1351019039;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:04:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.527950  Lock_time: 0.000126 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351019041;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:04:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.994950  Lock_time: 0.000098 Rows_sent: 128  Rows_examined: 1046210
SET timestamp=1351019095;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:04:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.589658  Lock_time: 0.000156 Rows_sent: 468  Rows_examined: 1242619
SET timestamp=1351019096;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:05:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.396017  Lock_time: 0.000247 Rows_sent: 16539  Rows_examined: 8101933
SET timestamp=1351019102;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:05:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.209843  Lock_time: 0.000104 Rows_sent: 2178  Rows_examined: 112236
SET timestamp=1351019107;
SELECT
    DATE_FORMAT(interest.`datetime`, '%Y-%m-%d') AS mydate,
    allocations.id,
    count(1) AS visits
FROM
    interest
    JOIN interest_ext ON (
        interest.id = interest_ext.interest_id
    ) JOIN programs ON (
        interest_ext.program_id = programs.id
    ) JOIN allocations ON (
        programs.allocation_id = allocations.id
    )
WHERE
    interest.`datetime` BETWEEN '2012-10-01 00:00:00' AND '2012-10-31 23:59:59'
    AND interest.affiliate IN ('Google','Adsense','Facebook','Bing','AdKnowledge','Reply','LookSmart')
GROUP BY
    mydate,
    id;
# Time: 121023 12:05:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.565376  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351019118;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:06:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.576519  Lock_time: 0.000103 Rows_sent: 1493  Rows_examined: 6452461
SET timestamp=1351019209;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 12:07:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.706913  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926411
SET timestamp=1351019220;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:07:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.928952  Lock_time: 0.000121 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351019222;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:07:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.136257  Lock_time: 0.000101 Rows_sent: 128  Rows_examined: 1046211
SET timestamp=1351019229;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:07:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.029423  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1242620
SET timestamp=1351019230;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:08:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.915321  Lock_time: 0.000286 Rows_sent: 16539  Rows_examined: 8102005
SET timestamp=1351019307;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:08:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.021081  Lock_time: 0.000100 Rows_sent: 128  Rows_examined: 1046213
SET timestamp=1351019329;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.445237  Lock_time: 0.000134 Rows_sent: 468  Rows_examined: 1242622
SET timestamp=1351019329;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:10:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.246883  Lock_time: 0.000136 Rows_sent: 7  Rows_examined: 926413
SET timestamp=1351019401;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:10:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.118738  Lock_time: 0.000073 Rows_sent: 0  Rows_examined: 19291
SET timestamp=1351019405;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:10:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.087537  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351019406;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:10:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.856874  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351019419;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
# Time: 121023 12:11:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.816650  Lock_time: 0.000103 Rows_sent: 128  Rows_examined: 1046215
SET timestamp=1351019478;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:11:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.467550  Lock_time: 0.000090 Rows_sent: 468  Rows_examined: 1242624
SET timestamp=1351019479;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:11:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.252884  Lock_time: 0.000172 Rows_sent: 16539  Rows_examined: 8102086
SET timestamp=1351019485;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:12:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.140292  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 19293
SET timestamp=1351019523;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:12:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.138066  Lock_time: 0.000156 Rows_sent: 3  Rows_examined: 30267
SET timestamp=1351019537;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 12:13:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.982101  Lock_time: 0.000248 Rows_sent: 7  Rows_examined: 926418
SET timestamp=1351019597;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:13:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.905114  Lock_time: 0.000116 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351019600;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:13:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.907875  Lock_time: 0.000140 Rows_sent: 128  Rows_examined: 1046219
SET timestamp=1351019614;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:13:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.772747  Lock_time: 0.000169 Rows_sent: 468  Rows_examined: 1242628
SET timestamp=1351019615;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:14:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.699664  Lock_time: 0.000101 Rows_sent: 833  Rows_examined: 20188
SET timestamp=1351019655;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,sessions.data,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-10-01' AND sessions.expire < '2012-10-24'  AND sessions.university IN ('University of Southern California');
# Time: 121023 12:14:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.814110  Lock_time: 0.000208 Rows_sent: 16539  Rows_examined: 8102170
SET timestamp=1351019672;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:15:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.551877  Lock_time: 0.000127 Rows_sent: 128  Rows_examined: 1046221
SET timestamp=1351019712;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:15:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.651011  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242630
SET timestamp=1351019713;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:15:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.932987  Lock_time: 0.000093 Rows_sent: 2  Rows_examined: 29636
SET timestamp=1351019716;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:16:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.601818  Lock_time: 0.000051 Rows_sent: 0  Rows_examined: 19297
SET timestamp=1351019763;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:16:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.451884  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926418
SET timestamp=1351019771;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:16:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.960084  Lock_time: 0.000061 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351019774;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:16:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.131201  Lock_time: 0.000126 Rows_sent: 1493  Rows_examined: 6452502
SET timestamp=1351019806;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 12:17:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.448749  Lock_time: 0.000105 Rows_sent: 128  Rows_examined: 1046224
SET timestamp=1351019820;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:17:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.267310  Lock_time: 0.000065 Rows_sent: 468  Rows_examined: 1242633
SET timestamp=1351019821;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
# Time: 121023 12:17:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.418157  Lock_time: 0.000173 Rows_sent: 16540  Rows_examined: 8102319
SET timestamp=1351019827;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:19:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.197533  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926424
SET timestamp=1351019947;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:19:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.007014  Lock_time: 0.000084 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351019950;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:19:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.436995  Lock_time: 0.000158 Rows_sent: 128  Rows_examined: 1046231
SET timestamp=1351019956;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:19:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.244012  Lock_time: 0.000137 Rows_sent: 468  Rows_examined: 1242640
SET timestamp=1351019957;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.812335  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 19307
SET timestamp=1351020004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:20:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.666623  Lock_time: 0.000134 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351020016;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.655743  Lock_time: 0.000110 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351020016;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:20:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.031713  Lock_time: 0.000207 Rows_sent: 16540  Rows_examined: 8102455
SET timestamp=1351020043;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:21:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.243300  Lock_time: 0.000093 Rows_sent: 128  Rows_examined: 1046232
SET timestamp=1351020061;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.482696  Lock_time: 0.000105 Rows_sent: 468  Rows_examined: 1242641
SET timestamp=1351020061;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:22:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.424336  Lock_time: 0.000114 Rows_sent: 7  Rows_examined: 926426
SET timestamp=1351020120;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:22:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.587704  Lock_time: 0.000075 Rows_sent: 0  Rows_examined: 19309
SET timestamp=1351020122;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:22:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.063336  Lock_time: 0.000127 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351020123;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:22:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.741029  Lock_time: 0.000102 Rows_sent: 128  Rows_examined: 1046234
SET timestamp=1351020161;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.099680  Lock_time: 0.000163 Rows_sent: 468  Rows_examined: 1242643
SET timestamp=1351020161;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:22:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.300346  Lock_time: 0.000210 Rows_sent: 16540  Rows_examined: 8102550
SET timestamp=1351020167;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:22:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.353447  Lock_time: 0.000225 Rows_sent: 65150  Rows_examined: 1736957
SET timestamp=1351020174;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 12:24:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.715291  Lock_time: 0.000096 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351020285;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.290595  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351020285;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 12:25:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.817968  Lock_time: 0.000137 Rows_sent: 128  Rows_examined: 1046241
SET timestamp=1351020305;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.588720  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926429
SET timestamp=1351020305;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:25:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.049454  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242650
SET timestamp=1351020306;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
# Time: 121023 12:25:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.576900  Lock_time: 0.000114 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351020319;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:26:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.028402  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19320
SET timestamp=1351020362;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:26:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.977127  Lock_time: 0.000175 Rows_sent: 1493  Rows_examined: 6452577
SET timestamp=1351020394;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 12:26:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.250440  Lock_time: 0.000099 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351020401;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 12:26:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.062387  Lock_time: 0.000111 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351020402;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 12:26:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.275850  Lock_time: 0.000196 Rows_sent: 16540  Rows_examined: 8102833
SET timestamp=1351020406;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:26:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.880171  Lock_time: 0.000069 Rows_sent: 389  Rows_examined: 1097058
SET timestamp=1351020411;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 12:26:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.363333  Lock_time: 0.000073 Rows_sent: 128  Rows_examined: 1046243
SET timestamp=1351020416;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.837999  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242652
SET timestamp=1351020416;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:28:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.866478  Lock_time: 0.000124 Rows_sent: 7  Rows_examined: 926429
SET timestamp=1351020481;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:28:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.862242  Lock_time: 0.000123 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351020484;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:28:20
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 1.105521  Lock_time: 0.000049 Rows_sent: 245  Rows_examined: 245
SET timestamp=1351020500;
SHOW TABLE STATUS FROM `degreeamerica`;
# Time: 121023 12:28:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.806210  Lock_time: 0.000093 Rows_sent: 128  Rows_examined: 1046244
SET timestamp=1351020536;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.424360  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1242654
SET timestamp=1351020536;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:29:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.166872  Lock_time: 0.000262 Rows_sent: 16540  Rows_examined: 8102877
SET timestamp=1351020542;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.604891  Lock_time: 0.000044 Rows_sent: 0  Rows_examined: 19322
SET timestamp=1351020604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:30:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.683953  Lock_time: 0.000089 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351020620;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.674743  Lock_time: 0.000078 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351020620;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 12:30:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.092702  Lock_time: 0.000076 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351020621;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:31:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.714983  Lock_time: 0.000078 Rows_sent: 128  Rows_examined: 1046244
SET timestamp=1351020680;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:31:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.629478  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1242654
SET timestamp=1351020681;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.725966  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 19324
SET timestamp=1351020723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:32:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.829361  Lock_time: 0.000197 Rows_sent: 3  Rows_examined: 30301
SET timestamp=1351020737;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 12:32:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.002375  Lock_time: 0.000229 Rows_sent: 16540  Rows_examined: 8102925
SET timestamp=1351020759;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
# Time: 121023 12:33:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.940328  Lock_time: 0.000095 Rows_sent: 128  Rows_examined: 1046247
SET timestamp=1351020800;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.654029  Lock_time: 0.000085 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351020800;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:33:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.323085  Lock_time: 0.000107 Rows_sent: 468  Rows_examined: 1242657
SET timestamp=1351020801;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.636829  Lock_time: 0.000187 Rows_sent: 468  Rows_examined: 1242657
SET timestamp=1351020801;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 12:35:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.832930  Lock_time: 0.000066 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351020910;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 12:35:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.080866  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351020911;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 12:35:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.189758  Lock_time: 0.000102 Rows_sent: 128  Rows_examined: 1046248
SET timestamp=1351020938;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:35:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.626362  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351020941;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:35:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.498227  Lock_time: 0.000177 Rows_sent: 468  Rows_examined: 1242658
SET timestamp=1351020944;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:35:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.502055  Lock_time: 0.000219 Rows_sent: 16540  Rows_examined: 8102927
SET timestamp=1351020949;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:35:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.912088  Lock_time: 0.000069 Rows_sent: 389  Rows_examined: 1097064
SET timestamp=1351020951;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.445904  Lock_time: 0.000078 Rows_sent: 389  Rows_examined: 1097064
SET timestamp=1351020951;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 12:35:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.028689  Lock_time: 0.000233 Rows_sent: 1126  Rows_examined: 170840
SET timestamp=1351020952;
SELECT IF(university='','(None)',university),IF(affiliate='','(None)',affiliate),SUM(sent),SUM(disqualified),SUM(IF(LEFT(reason,3)='***',1,0)),COUNT(1),SUM(enrolled),SUM(applied),SUM(lead_price),SUM(dq_cost),SUM(scrub_cost),SUM(IF(sent=1,score,null))/SUM(sent)  FROM ((SELECT university,affiliate,sent,disqualified,reason,enrolled,score,applied,IF(sent=1 AND disqualified=0,lead_price,0) AS lead_price,IF(sessions.sent=1 AND sessions.disqualified=1,sessions.lead_price,0) AS dq_cost,IF(LEFT(sessions.reason,3)='***',sessions.lead_price,0) AS scrub_cost FROM sessions WHERE `show`=1 AND (sent=1 OR disqualified=1) AND sessions.sent_date >= '2012-10-01') UNION ALL (SELECT university,affiliate,0,1,reason,0,0,0,0,0,0 FROM reject WHERE reject.datetime >= '2012-10-01')) AS ut GROUP BY university,affiliate WITH ROLLUP;
# Time: 121023 12:36:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.664868  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351020981;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:36:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.615501  Lock_time: 0.000098 Rows_sent: 128  Rows_examined: 1046251
SET timestamp=1351021008;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:36:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.543149  Lock_time: 0.000176 Rows_sent: 468  Rows_examined: 1242661
SET timestamp=1351021009;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:37:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 155.928701  Lock_time: 0.000130 Rows_sent: 1493  Rows_examined: 6454098
SET timestamp=1351021057;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 12:38:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.177540  Lock_time: 0.000212 Rows_sent: 16540  Rows_examined: 8103037
SET timestamp=1351021087;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:38:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.567451  Lock_time: 0.000068 Rows_sent: 128  Rows_examined: 1046252
SET timestamp=1351021132;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.083221  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242662
SET timestamp=1351021132;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:39:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.596667  Lock_time: 0.000078 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351021160;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:40:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.073963  Lock_time: 0.000069 Rows_sent: 0  Rows_examined: 19331
SET timestamp=1351021202;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:40:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.103253  Lock_time: 0.000123 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351021219;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.112388  Lock_time: 0.000092 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351021219;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 12:41:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 12:41:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.950839  Lock_time: 0.000204 Rows_sent: 16540  Rows_examined: 8103052
SET timestamp=1351021285;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:42:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.748389  Lock_time: 0.000123 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351021341;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:42:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.246109  Lock_time: 0.000179 Rows_sent: 128  Rows_examined: 1046255
SET timestamp=1351021370;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.482059  Lock_time: 0.000118 Rows_sent: 468  Rows_examined: 1242665
SET timestamp=1351021370;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:43:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.666429  Lock_time: 0.000152 Rows_sent: 65152  Rows_examined: 1737011
SET timestamp=1351021383;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 12:44:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.511090  Lock_time: 0.000213 Rows_sent: 16540  Rows_examined: 8103186
SET timestamp=1351021466;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:44:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.388362  Lock_time: 0.000103 Rows_sent: 128  Rows_examined: 1046258
SET timestamp=1351021495;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:44:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.835257  Lock_time: 0.000134 Rows_sent: 468  Rows_examined: 1242668
SET timestamp=1351021496;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:45:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.853626  Lock_time: 0.000106 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351021515;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:45:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.547317  Lock_time: 0.000137 Rows_sent: 1262  Rows_examined: 40769
SET timestamp=1351021545;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,NULL,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-09-01' AND sessions.expire < '2012-10-01'  AND sessions.university IN ('Ashford University');
# Time: 121023 12:46:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.674004  Lock_time: 0.000165 Rows_sent: 6  Rows_examined: 112697
SET timestamp=1351021584;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:46:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.773972  Lock_time: 0.000100 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351021588;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:47:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.861569  Lock_time: 0.000099 Rows_sent: 128  Rows_examined: 1046262
SET timestamp=1351021623;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:47:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.916610  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242672
SET timestamp=1351021624;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:47:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.415701  Lock_time: 0.000209 Rows_sent: 16540  Rows_examined: 8103417
SET timestamp=1351021630;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:47:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 131.077774  Lock_time: 0.000124 Rows_sent: 1493  Rows_examined: 6454147
SET timestamp=1351021632;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 12:48:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.598003  Lock_time: 0.000145 Rows_sent: 128  Rows_examined: 1046263
SET timestamp=1351021719;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:48:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.275012  Lock_time: 0.000139 Rows_sent: 468  Rows_examined: 1242673
SET timestamp=1351021720;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.594403  Lock_time: 0.000118 Rows_sent: 468  Rows_examined: 1242673
SET timestamp=1351021720;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 12:49:18
# Time: 121023 12:49:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.084998  Lock_time: 0.000070 Rows_sent: 468  Rows_examined: 1242673
SET timestamp=1351021788;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 12:49:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.380818  Lock_time: 0.000244 Rows_sent: 16540  Rows_examined: 8103457
SET timestamp=1351021793;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:50:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.834388  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19343
SET timestamp=1351021803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.460584  Lock_time: 0.000118 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351021817;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.480722  Lock_time: 0.000114 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351021817;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:51:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.385101  Lock_time: 0.000109 Rows_sent: 128  Rows_examined: 1046265
SET timestamp=1351021874;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:51:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.993338  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242675
SET timestamp=1351021875;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.062682  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 19345
SET timestamp=1351021922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 12:52:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.826915  Lock_time: 0.000158 Rows_sent: 3  Rows_examined: 30322
SET timestamp=1351021938;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 12:52:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.771995  Lock_time: 0.000166 Rows_sent: 6  Rows_examined: 112697
SET timestamp=1351021940;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:52:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.876021  Lock_time: 0.000113 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351021945;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:52:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.285875  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1242677
SET timestamp=1351021968;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 12:53:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.273511  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351022001;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 12:53:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.234970  Lock_time: 0.000093 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351022004;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 12:53:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.567853  Lock_time: 0.000086 Rows_sent: 389  Rows_examined: 1097086
SET timestamp=1351022011;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 12:53:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.635765  Lock_time: 0.000166 Rows_sent: 128  Rows_examined: 1046268
SET timestamp=1351022016;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:53:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.278872  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1242678
SET timestamp=1351022017;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:53:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.553624  Lock_time: 0.000219 Rows_sent: 16540  Rows_examined: 8103542
SET timestamp=1351022024;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.132813  Lock_time: 0.000140 Rows_sent: 128  Rows_examined: 1046272
SET timestamp=1351022088;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.001584  Lock_time: 0.000111 Rows_sent: 468  Rows_examined: 1242682
SET timestamp=1351022089;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.419132  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242682
SET timestamp=1351022089;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 12:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.192761  Lock_time: 0.000076 Rows_sent: 1  Rows_examined: 29636
SET timestamp=1351022116;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 12:55:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.833684  Lock_time: 0.000197 Rows_sent: 6  Rows_examined: 112697
SET timestamp=1351022117;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:55:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.925434  Lock_time: 0.000118 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351022121;
# Time: 121023 12:56:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.436550  Lock_time: 0.000084 Rows_sent: 128  Rows_examined: 1046278
SET timestamp=1351022192;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 12:56:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.716666  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1242688
SET timestamp=1351022193;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:56:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.032177  Lock_time: 0.000126 Rows_sent: 16540  Rows_examined: 8103803
SET timestamp=1351022194;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:56:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.325399  Lock_time: 0.000109 Rows_sent: 1493  Rows_examined: 6454237
SET timestamp=1351022206;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 12:56:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.228797  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351022207;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 12:56:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.372203  Lock_time: 0.000120 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351022208;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:58:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.819120  Lock_time: 0.000211 Rows_sent: 6  Rows_examined: 112697
SET timestamp=1351022297;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 12:58:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.748930  Lock_time: 0.000206 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351022301;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 12:58:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.433144  Lock_time: 0.000104 Rows_sent: 128  Rows_examined: 1046280
SET timestamp=1351022338;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.171536  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1242690
SET timestamp=1351022338;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 12:59:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.630425  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8103907
SET timestamp=1351022344;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 12:59:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.464302  Lock_time: 0.000123 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351022385;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.765415  Lock_time: 0.000135 Rows_sent: 147  Rows_examined: 5619
SET timestamp=1351022404;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# Time: 121023 13:00:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.161637  Lock_time: 0.000073 Rows_sent: 0  Rows_examined: 19363
SET timestamp=1351022405;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:00:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.995315  Lock_time: 0.000150 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351022449;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.983134  Lock_time: 0.000106 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351022449;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:01:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.723362  Lock_time: 0.000063 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351022464;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:01:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.203260  Lock_time: 0.000108 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351022465;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:01:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.457296  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351022508;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:01:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.401430  Lock_time: 0.000068 Rows_sent: 5  Rows_examined: 2869
SET timestamp=1351022517;
SELECT 
    first_name,    
    last_name, 
    email, 
    agent_id,
    client_subid
FROM 
    warmtransfer_agent 
WHERE 
    client_name = 'Strayer' 
    AND (client_subid = '3465' OR client_subid IS NULL)
    AND available = 1 
ORDER BY 
    first_name, 
    last_name;
# Time: 121023 13:02:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.192695  Lock_time: 0.000169 Rows_sent: 6  Rows_examined: 926437
SET timestamp=1351022538;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:02:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.989024  Lock_time: 0.000075 Rows_sent: 389  Rows_examined: 1097102
SET timestamp=1351022540;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 13:02:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.899473  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351022542;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:02:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 141.918076  Lock_time: 0.000129 Rows_sent: 128  Rows_examined: 1046285
SET timestamp=1351022543;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:02:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 142.510487  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242695
SET timestamp=1351022544;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:02:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.297413  Lock_time: 0.000223 Rows_sent: 16540  Rows_examined: 8104158
SET timestamp=1351022550;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
# Time: 121023 13:03:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.016580  Lock_time: 0.000151 Rows_sent: 65181  Rows_examined: 1737092
SET timestamp=1351022597;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 13:03:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.249634  Lock_time: 0.000156 Rows_sent: 7  Rows_examined: 926437
SET timestamp=1351022601;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:03:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.664654  Lock_time: 0.000090 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351022603;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:04:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.778087  Lock_time: 0.000144 Rows_sent: 5  Rows_examined: 2564
SET timestamp=1351022685;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:05:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.704182  Lock_time: 0.000096 Rows_sent: 128  Rows_examined: 1046287
SET timestamp=1351022702;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:05:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.913779  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242697
SET timestamp=1351022704;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.881867  Lock_time: 0.000159 Rows_sent: 6  Rows_examined: 926437
SET timestamp=1351022704;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:05:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.199369  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351022709;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:05:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.275805  Lock_time: 0.000278 Rows_sent: 16540  Rows_examined: 8104159
SET timestamp=1351022710;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:05:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.607778  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351022718;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:06:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.767830  Lock_time: 0.000138 Rows_sent: 7  Rows_examined: 926441
SET timestamp=1351022797;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:06:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.899610  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351022801;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:06:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.334516  Lock_time: 0.000086 Rows_sent: 389  Rows_examined: 1097110
SET timestamp=1351022806;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 13:07:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.391989  Lock_time: 0.000132 Rows_sent: 128  Rows_examined: 1046294
SET timestamp=1351022825;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:07:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.160041  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242704
SET timestamp=1351022826;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:07:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 139.177517  Lock_time: 0.000140 Rows_sent: 1493  Rows_examined: 6454303
SET timestamp=1351022841;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 13:07:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.021637  Lock_time: 0.000198 Rows_sent: 5  Rows_examined: 2584
SET timestamp=1351022873;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:08:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.160338  Lock_time: 0.000172 Rows_sent: 6  Rows_examined: 926443
SET timestamp=1351022881;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:08:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.092197  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19372
SET timestamp=1351022882;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:08:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.082566  Lock_time: 0.000114 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351022885;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:08:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.631435  Lock_time: 0.000178 Rows_sent: 16540  Rows_examined: 8104399
SET timestamp=1351022910;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:09:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 13:09:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.896018  Lock_time: 0.000144 Rows_sent: 468  Rows_examined: 1242704
SET timestamp=1351022947;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:09:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.593543  Lock_time: 0.000135 Rows_sent: 7  Rows_examined: 926443
SET timestamp=1351022961;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:09:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.744467  Lock_time: 0.000085 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351022964;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:10:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.476145  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19374
SET timestamp=1351023007;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:10:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.613985  Lock_time: 0.000138 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351023020;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:10:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.818404  Lock_time: 0.000118 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351023022;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:10:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.499712  Lock_time: 0.000085 Rows_sent: 389  Rows_examined: 1097111
SET timestamp=1351023034;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 13:10:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.707276  Lock_time: 0.000191 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351023042;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.692111  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351023042;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:11:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.584915  Lock_time: 0.000168 Rows_sent: 6  Rows_examined: 926446
SET timestamp=1351023087;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:11:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.883918  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351023091;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:11:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.438467  Lock_time: 0.000096 Rows_sent: 128  Rows_examined: 1046296
SET timestamp=1351023099;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.051056  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242706
SET timestamp=1351023099;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:11:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.287956  Lock_time: 0.000275 Rows_sent: 16540  Rows_examined: 8104485
SET timestamp=1351023106;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:12:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.444468  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19375
SET timestamp=1351023129;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:12:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.532551  Lock_time: 0.000144 Rows_sent: 3  Rows_examined: 30352
SET timestamp=1351023143;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 13:12:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.190373  Lock_time: 0.000038 Rows_sent: 15  Rows_examined: 1157
SET timestamp=1351023162;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.012382  Lock_time: 0.000060 Rows_sent: 15  Rows_examined: 1157
SET timestamp=1351023162;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:12:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.573822  Lock_time: 0.000061 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351023179;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:13:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.251811  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351023180;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:13:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.731542  Lock_time: 0.000066 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351023198;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:13:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.485040  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926446
SET timestamp=1351023199;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:13:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.366253  Lock_time: 0.000066 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351023204;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:13:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.866268  Lock_time: 0.000065 Rows_sent: 389  Rows_examined: 1097114
SET timestamp=1351023205;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 13:14:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 130.695053  Lock_time: 0.000096 Rows_sent: 128  Rows_examined: 1046297
SET timestamp=1351023252;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.727765  Lock_time: 0.000129 Rows_sent: 6  Rows_examined: 926446
SET timestamp=1351023252;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:14:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 131.457121  Lock_time: 0.000180 Rows_sent: 468  Rows_examined: 1242707
SET timestamp=1351023253;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:14:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.410725  Lock_time: 0.000053 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351023256;
# Time: 121023 13:14:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.810525  Lock_time: 0.000192 Rows_sent: 16540  Rows_examined: 8104597
SET timestamp=1351023281;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:15:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.031710  Lock_time: 0.000075 Rows_sent: 5  Rows_examined: 3942
SET timestamp=1351023304;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Full Sail University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Full Sail University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023 13:15:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.466120  Lock_time: 0.000066 Rows_sent: 1  Rows_examined: 29636
SET timestamp=1351023322;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:15:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.036891  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926446
SET timestamp=1351023332;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:15:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.624005  Lock_time: 0.000054 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351023335;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:16:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.161953  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242712
SET timestamp=1351023369;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 13:17:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.298105  Lock_time: 0.000088 Rows_sent: 128  Rows_examined: 1046303
SET timestamp=1351023420;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:17:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.112522  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1242713
SET timestamp=1351023421;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:17:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.615539  Lock_time: 0.000125 Rows_sent: 6  Rows_examined: 926446
SET timestamp=1351023422;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:17:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.427312  Lock_time: 0.000046 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351023426;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:17:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.574604  Lock_time: 0.000202 Rows_sent: 16540  Rows_examined: 8104672
SET timestamp=1351023427;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:17:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.976008  Lock_time: 0.000095 Rows_sent: 1493  Rows_examined: 6454372
SET timestamp=1351023436;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 13:18:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.868160  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351023493;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:18:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.685600  Lock_time: 0.000100 Rows_sent: 7  Rows_examined: 926447
SET timestamp=1351023516;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:18:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.579792  Lock_time: 0.000047 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351023519;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:18:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.249587  Lock_time: 0.000085 Rows_sent: 128  Rows_examined: 1046306
SET timestamp=1351023539;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:19:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.051018  Lock_time: 0.000068 Rows_sent: 468  Rows_examined: 1242716
SET timestamp=1351023540;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:19:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.934972  Lock_time: 0.000126 Rows_sent: 6  Rows_examined: 926448
SET timestamp=1351023597;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:20:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.608813  Lock_time: 0.000061 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351023601;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.605675  Lock_time: 0.000045 Rows_sent: 0  Rows_examined: 19387
SET timestamp=1351023604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:20:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.807883  Lock_time: 0.000064 Rows_sent: 1  Rows_examined: 29636
SET timestamp=1351023619;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.797302  Lock_time: 0.000058 Rows_sent: 1  Rows_examined: 29636
SET timestamp=1351023619;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:20:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.381379  Lock_time: 0.000133 Rows_sent: 16540  Rows_examined: 8104794
SET timestamp=1351023648;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
# Time: 121023 13:21:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.478802  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1242720
SET timestamp=1351023667;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 13:21:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.415331  Lock_time: 0.000122 Rows_sent: 7  Rows_examined: 926448
SET timestamp=1351023682;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:21:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.503595  Lock_time: 0.000116 Rows_sent: 128  Rows_examined: 1046310
SET timestamp=1351023684;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:21:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.806538  Lock_time: 0.000059 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351023685;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:21:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.008796  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242720
SET timestamp=1351023686;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:21:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.619662  Lock_time: 0.000111 Rows_sent: 10  Rows_examined: 3529
SET timestamp=1351023699;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.program_id=programs.id AND programs.allocation_id=106 AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 13:22:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.042463  Lock_time: 0.000069 Rows_sent: 1  Rows_examined: 2
SET timestamp=1351023759;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.email = 'kstill@atlanticbb.net' ORDER BY sessions.sent_date DESC;
# Time: 121023 13:22:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.710148  Lock_time: 0.000086 Rows_sent: 128  Rows_examined: 1046317
SET timestamp=1351023771;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:22:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.023377  Lock_time: 0.000122 Rows_sent: 468  Rows_examined: 1242727
SET timestamp=1351023772;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.177377  Lock_time: 0.000127 Rows_sent: 6  Rows_examined: 926455
SET timestamp=1351023772;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:22:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.444313  Lock_time: 0.000049 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351023775;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:22:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.257167  Lock_time: 0.000128 Rows_sent: 16540  Rows_examined: 8105059
SET timestamp=1351023778;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:23:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.124421  Lock_time: 0.000077 Rows_sent: 65183  Rows_examined: 1737169
SET timestamp=1351023787;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 13:24:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.294485  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19401
SET timestamp=1351023847;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:24:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.267853  Lock_time: 0.000056 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351023878;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:24:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.986409  Lock_time: 0.000114 Rows_sent: 389  Rows_examined: 1097139
SET timestamp=1351023880;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 13:24:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.279514  Lock_time: 0.000112 Rows_sent: 7  Rows_examined: 926459
SET timestamp=1351023889;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:24:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.624409  Lock_time: 0.000228 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351023891;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:25:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.136752  Lock_time: 0.000087 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351023916;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:25:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.141499  Lock_time: 0.000089 Rows_sent: 126  Rows_examined: 1046322
SET timestamp=1351023938;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:25:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.027367  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242732
SET timestamp=1351023940;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:26:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.661742  Lock_time: 0.000105 Rows_sent: 6  Rows_examined: 926460
SET timestamp=1351023963;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:26:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.049525  Lock_time: 0.000049 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351023967;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:26:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.946241  Lock_time: 0.000082 Rows_sent: 468  Rows_examined: 1242734
SET timestamp=1351023982;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 13:26:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.852849  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1242736
SET timestamp=1351023991;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 13:26:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.725426  Lock_time: 0.000137 Rows_sent: 16540  Rows_examined: 8105324
SET timestamp=1351023998;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
# Time: 121023 13:26:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.628099  Lock_time: 0.000110 Rows_sent: 126  Rows_examined: 1046326
SET timestamp=1351024015;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:26:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.256520  Lock_time: 0.000117 Rows_sent: 468  Rows_examined: 1242736
SET timestamp=1351024016;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:27:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.669375  Lock_time: 0.000088 Rows_sent: 1493  Rows_examined: 6454455
SET timestamp=1351024036;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 13:27:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.320433  Lock_time: 0.000134 Rows_sent: 7  Rows_examined: 926460
SET timestamp=1351024042;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:27:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.788690  Lock_time: 0.000047 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024048;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:28:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.057580  Lock_time: 0.000042 Rows_sent: 0  Rows_examined: 19405
SET timestamp=1351024085;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:28:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.802779  Lock_time: 0.000090 Rows_sent: 7  Rows_examined: 926460
SET timestamp=1351024098;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:28:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.506895  Lock_time: 0.000065 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024101;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:28:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.714659  Lock_time: 0.000061 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351024137;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:29:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.397492  Lock_time: 0.000036 Rows_sent: 1  Rows_examined: 295
SET timestamp=1351024147;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004047372163' LIMIT 1;
# Time: 121023 13:29:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.547210  Lock_time: 0.000072 Rows_sent: 1  Rows_examined: 1088
SET timestamp=1351024148;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004737063163' LIMIT 1;
# Time: 121023 13:29:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.341996  Lock_time: 0.000121 Rows_sent: 126  Rows_examined: 1046326
SET timestamp=1351024149;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:29:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.295882  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242736
SET timestamp=1351024150;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:29:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.611008  Lock_time: 0.000148 Rows_sent: 16540  Rows_examined: 8105343
SET timestamp=1351024156;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:29:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.011873  Lock_time: 0.000100 Rows_sent: 7  Rows_examined: 926460
SET timestamp=1351024158;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.234121  Lock_time: 0.000094 Rows_sent: 7  Rows_examined: 926460
SET timestamp=1351024158;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:29:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.527396  Lock_time: 0.000047 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024160;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.530407  Lock_time: 0.000038 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024160;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.107235  Lock_time: 0.000100 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351024218;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.100153  Lock_time: 0.000072 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351024218;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 13:31:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.911812  Lock_time: 0.000135 Rows_sent: 7  Rows_examined: 926460
SET timestamp=1351024263;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:31:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.935018  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024266;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:31:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.841558  Lock_time: 0.000082 Rows_sent: 468  Rows_examined: 1242738
SET timestamp=1351024296;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 13:31:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.635359  Lock_time: 0.000138 Rows_sent: 7  Rows_examined: 926460
SET timestamp=1351024303;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:31:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.103562  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351024304;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:31:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.055620  Lock_time: 0.000065 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024306;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:32:21
# Time: 121023 13:32:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 153.828173  Lock_time: 94.472576 Rows_sent: 126  Rows_examined: 1046328
SET timestamp=1351024355;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:32:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 154.410148  Lock_time: 94.464569 Rows_sent: 468  Rows_examined: 1242738
SET timestamp=1351024356;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:32:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.478309  Lock_time: 34.344983 Rows_sent: 16540  Rows_examined: 8105405
SET timestamp=1351024362;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:32:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.865045  Lock_time: 40.408449 Rows_sent: 3  Rows_examined: 30384
SET timestamp=1351024375;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 13:34:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.018088  Lock_time: 0.000092 Rows_sent: 7  Rows_examined: 926460
SET timestamp=1351024461;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.507097  Lock_time: 0.000115 Rows_sent: 7  Rows_examined: 926463
SET timestamp=1351024461;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:34:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.186521  Lock_time: 0.000042 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024464;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.186679  Lock_time: 0.000049 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024464;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:34:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.765181  Lock_time: 0.000069 Rows_sent: 389  Rows_examined: 1097148
SET timestamp=1351024470;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 13:35:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.349636  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351024522;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:35:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.360773  Lock_time: 0.000112 Rows_sent: 7  Rows_examined: 926463
SET timestamp=1351024525;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:35:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.645155  Lock_time: 0.000049 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024527;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:35:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.790160  Lock_time: 0.000092 Rows_sent: 126  Rows_examined: 1046331
SET timestamp=1351024534;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:35:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.910411  Lock_time: 0.000135 Rows_sent: 468  Rows_examined: 1242741
SET timestamp=1351024535;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:35:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.356481  Lock_time: 0.000175 Rows_sent: 16540  Rows_examined: 8105530
SET timestamp=1351024541;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:36:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.399364  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19413
SET timestamp=1351024563;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:36:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.143986  Lock_time: 0.000090 Rows_sent: 7  Rows_examined: 926464
SET timestamp=1351024584;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:36:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.438762  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024588;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:36:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.303760  Lock_time: 0.000058 Rows_sent: 17  Rows_examined: 2646
SET timestamp=1351024613;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 11:15:50' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:36:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.421847  Lock_time: 0.000075 Rows_sent: 126  Rows_examined: 1046333
SET timestamp=1351024615;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:37:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.977374  Lock_time: 0.000124 Rows_sent: 7  Rows_examined: 926464
SET timestamp=1351024623;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:37:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.541878  Lock_time: 0.000061 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024626;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:37:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.132149  Lock_time: 0.000080 Rows_sent: 468  Rows_examined: 1242743
SET timestamp=1351024647;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
# Time: 121023 13:37:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 152.459642  Lock_time: 0.000100 Rows_sent: 1493  Rows_examined: 6454466
SET timestamp=1351024654;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 13:37:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.173207  Lock_time: 0.000134 Rows_sent: 5  Rows_examined: 963
SET timestamp=1351024679;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 08:22:58' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:38:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.800695  Lock_time: 0.000101 Rows_sent: 7  Rows_examined: 926465
SET timestamp=1351024689;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:38:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.621642  Lock_time: 0.000069 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024692;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:38:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.706772  Lock_time: 0.000143 Rows_sent: 16540  Rows_examined: 8105607
SET timestamp=1351024709;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:39:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.044830  Lock_time: 0.000092 Rows_sent: 5  Rows_examined: 2491
SET timestamp=1351024741;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 12:26:58' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:39:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.788022  Lock_time: 0.000069 Rows_sent: 126  Rows_examined: 1046336
SET timestamp=1351024742;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.333916  Lock_time: 0.000105 Rows_sent: 468  Rows_examined: 1242746
SET timestamp=1351024742;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:39:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.916790  Lock_time: 0.000103 Rows_sent: 7  Rows_examined: 926465
SET timestamp=1351024768;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:39:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.560780  Lock_time: 0.000062 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024771;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:39:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.883585  Lock_time: 0.000067 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351024799;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:40:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.961168  Lock_time: 0.000074 Rows_sent: 0  Rows_examined: 19417
SET timestamp=1351024803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:40:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.253975  Lock_time: 0.000101 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351024822;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.245554  Lock_time: 0.000097 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351024822;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 13:40:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.457673  Lock_time: 0.000101 Rows_sent: 7  Rows_examined: 926465
SET timestamp=1351024840;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:40:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.805479  Lock_time: 0.000059 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024842;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:41:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.131821  Lock_time: 0.000119 Rows_sent: 7  Rows_examined: 926465
SET timestamp=1351024878;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:41:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.558213  Lock_time: 0.000052 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024880;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:41:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.957102  Lock_time: 0.000083 Rows_sent: 126  Rows_examined: 1046337
SET timestamp=1351024881;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:41:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.539790  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242747
SET timestamp=1351024882;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:41:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.891238  Lock_time: 0.000185 Rows_sent: 16540  Rows_examined: 8105724
SET timestamp=1351024887;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:41:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.607504  Lock_time: 0.000100 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351024908;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:42:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.510064  Lock_time: 0.000044 Rows_sent: 0  Rows_examined: 19417
SET timestamp=1351024922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:42:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 13:43:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.417421  Lock_time: 0.000107 Rows_sent: 7  Rows_examined: 926465
SET timestamp=1351024984;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.200093  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926465
SET timestamp=1351024984;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:43:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.643520  Lock_time: 0.000045 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024987;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.645040  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351024987;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:43:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.467284  Lock_time: 0.000118 Rows_sent: 126  Rows_examined: 1046337
SET timestamp=1351024991;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:43:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.455438  Lock_time: 0.000065 Rows_sent: 468  Rows_examined: 1242747
SET timestamp=1351024992;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:43:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.753184  Lock_time: 0.000092 Rows_sent: 65186  Rows_examined: 1737229
SET timestamp=1351025007;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 13:44:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.218710  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926465
SET timestamp=1351025043;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:44:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.702079  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025045;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:44:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.317165  Lock_time: 0.000193 Rows_sent: 16540  Rows_examined: 8105724
SET timestamp=1351025068;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:44:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.314554  Lock_time: 0.000024 Rows_sent: 1  Rows_examined: 2999
SET timestamp=1351025099;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6005085537015' LIMIT 1;
# Time: 121023 13:45:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.244633  Lock_time: 0.000056 Rows_sent: 15  Rows_examined: 1056
SET timestamp=1351025101;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 12:26:58' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:45:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.057865  Lock_time: 0.000104 Rows_sent: 5  Rows_examined: 2363
SET timestamp=1351025102;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Campus Explorer : Grand Canyon University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Campus Explorer : Grand Canyon University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023 13:45:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.308614  Lock_time: 0.000082 Rows_sent: 126  Rows_examined: 1046338
SET timestamp=1351025103;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:45:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.400727  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1242748
SET timestamp=1351025105;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:45:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.590461  Lock_time: 0.000116 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351025121;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:45:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.838456  Lock_time: 0.000094 Rows_sent: 7  Rows_examined: 926466
SET timestamp=1351025143;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:45:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.920811  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025146;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:46:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.863038  Lock_time: 0.000096 Rows_sent: 7  Rows_examined: 926467
SET timestamp=1351025182;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:46:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.567112  Lock_time: 0.000060 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025185;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:46:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.262589  Lock_time: 0.000085 Rows_sent: 126  Rows_examined: 1046340
SET timestamp=1351025216;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:46:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.207435  Lock_time: 0.000071 Rows_sent: 468  Rows_examined: 1242750
SET timestamp=1351025217;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:47:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.535895  Lock_time: 0.000033 Rows_sent: 1  Rows_examined: 4517
SET timestamp=1351025221;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004745471554' LIMIT 1;
# Time: 121023 13:47:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.520244  Lock_time: 0.000151 Rows_sent: 16540  Rows_examined: 8105778
SET timestamp=1351025222;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
# Time: 121023 13:47:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.895168  Lock_time: 0.000112 Rows_sent: 7  Rows_examined: 926468
SET timestamp=1351025231;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:47:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.843509  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025234;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:48:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 182.522575  Lock_time: 0.000127 Rows_sent: 1493  Rows_examined: 6454493
SET timestamp=1351025283;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 13:48:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.979043  Lock_time: 0.000048 Rows_sent: 0  Rows_examined: 19423
SET timestamp=1351025289;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:48:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.926270  Lock_time: 0.000135 Rows_sent: 7  Rows_examined: 926468
SET timestamp=1351025325;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:48:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.740944  Lock_time: 0.000065 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351025327;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:48:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.009007  Lock_time: 0.000047 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025328;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.224165  Lock_time: 0.000069 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351025328;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:49:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.550392  Lock_time: 0.000096 Rows_sent: 7  Rows_examined: 926469
SET timestamp=1351025360;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:49:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.601709  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025362;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:49:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.065458  Lock_time: 0.000107 Rows_sent: 126  Rows_examined: 1046344
SET timestamp=1351025365;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:49:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.865388  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242754
SET timestamp=1351025366;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:50:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.085199  Lock_time: 0.000096 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351025415;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.075781  Lock_time: 0.000089 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351025415;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:50:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.804391  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926471
SET timestamp=1351025416;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:50:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.435408  Lock_time: 0.000062 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025419;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:50:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.876508  Lock_time: 0.000181 Rows_sent: 16540  Rows_examined: 8105886
SET timestamp=1351025439;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:51:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.842557  Lock_time: 0.000131 Rows_sent: 7  Rows_examined: 926473
SET timestamp=1351025492;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:51:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.683019  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025495;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:51:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.062655  Lock_time: 0.000036 Rows_sent: 1  Rows_examined: 3941
SET timestamp=1351025504;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004508580674' LIMIT 1;
# Time: 121023 13:51:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.672205  Lock_time: 37.829023 Rows_sent: 126  Rows_examined: 1046346
SET timestamp=1351025508;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:51:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.492925  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351025514;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 13:51:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 114.623915  Lock_time: 37.818610 Rows_sent: 468  Rows_examined: 1242756
SET timestamp=1351025515;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.029680  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 19428
SET timestamp=1351025522;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 13:52:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.676339  Lock_time: 0.000168 Rows_sent: 3  Rows_examined: 30405
SET timestamp=1351025534;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 13:52:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.265071  Lock_time: 0.000098 Rows_sent: 7  Rows_examined: 926473
SET timestamp=1351025540;
# Time: 121023 13:53:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.746391  Lock_time: 0.000097 Rows_sent: 7  Rows_examined: 926473
SET timestamp=1351025600;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:53:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.659173  Lock_time: 0.000061 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025603;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:53:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.776220  Lock_time: 0.000134 Rows_sent: 126  Rows_examined: 1046350
SET timestamp=1351025608;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:53:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.252648  Lock_time: 0.000123 Rows_sent: 468  Rows_examined: 1242760
SET timestamp=1351025609;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:53:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.158973  Lock_time: 0.000229 Rows_sent: 16540  Rows_examined: 8105935
SET timestamp=1351025615;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:54:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.741971  Lock_time: 0.000050 Rows_sent: 1  Rows_examined: 2673
SET timestamp=1351025648;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6006198076219' LIMIT 1;
# Time: 121023 13:54:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.435276  Lock_time: 0.000092 Rows_sent: 7  Rows_examined: 926473
SET timestamp=1351025676;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:54:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.037851  Lock_time: 0.000048 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025679;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.644660  Lock_time: 0.000057 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351025688;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 13:55:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.964596  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926473
SET timestamp=1351025708;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:55:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.757584  Lock_time: 0.000064 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025711;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:55:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.964175  Lock_time: 0.000069 Rows_sent: 126  Rows_examined: 1046352
SET timestamp=1351025713;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:55:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.043546  Lock_time: 0.000084 Rows_sent: 468  Rows_examined: 1242762
SET timestamp=1351025714;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 13:55:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.198196  Lock_time: 0.000064 Rows_sent: 3  Rows_examined: 29637
SET timestamp=1351025716;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 13:56:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.937037  Lock_time: 0.000066 Rows_sent: 389  Rows_examined: 1097172
SET timestamp=1351025774;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 13:56:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.904814  Lock_time: 12.722259 Rows_sent: 16540  Rows_examined: 8106022
SET timestamp=1351025806;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 13:57:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.325376  Lock_time: 0.000177 Rows_sent: 7  Rows_examined: 926475
SET timestamp=1351025846;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:57:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.930642  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025849;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:57:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 171.051347  Lock_time: 12.708575 Rows_sent: 1493  Rows_examined: 6454548
SET timestamp=1351025873;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 13:58:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.956159  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926475
SET timestamp=1351025886;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 13:58:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.822701  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351025889;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 13:58:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 170.851411  Lock_time: 106.746558 Rows_sent: 126  Rows_examined: 1046355
SET timestamp=1351025932;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 13:58:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 171.638577  Lock_time: 106.744292 Rows_sent: 468  Rows_examined: 1242765
SET timestamp=1351025933;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
# Time: 121023 14:00:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 170.137885  Lock_time: 51.726368 Rows_sent: 16540  Rows_examined: 8106115
SET timestamp=1351026051;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:00:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.245305  Lock_time: 0.000125 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351026056;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.235567  Lock_time: 0.000093 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351026056;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:02:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 138.521219  Lock_time: 0.000116 Rows_sent: 7  Rows_examined: 926475
SET timestamp=1351026120;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.290443  Lock_time: 0.007101 Rows_sent: 0  Rows_examined: 19438
SET timestamp=1351026123;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:02:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.397703  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026124;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:02:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 138.763444  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926475
SET timestamp=1351026154;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:02:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.861488  Lock_time: 0.000116 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026157;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:02:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 178.217417  Lock_time: 50.188580 Rows_sent: 126  Rows_examined: 1046355
SET timestamp=1351026179;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:03:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 179.143967  Lock_time: 50.193305 Rows_sent: 468  Rows_examined: 1242765
SET timestamp=1351026180;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:03:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.546268  Lock_time: 105.348837 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.087193  Lock_time: 73.889939 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.433252  Lock_time: 17.235347 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.267297  Lock_time: 91.069547 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.685601  Lock_time: 121.487534 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.351113  Lock_time: 74.153317 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.747794  Lock_time: 116.549624 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.194570  Lock_time: 68.996960 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.151074  Lock_time: 105.952989 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.909681  Lock_time: 50.711453 Rows_sent: 10  Rows_examined: 2036
SET timestamp=1351026181;
# Time: 121023 14:03:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.302723  Lock_time: 0.000170 Rows_sent: 7  Rows_examined: 926477
SET timestamp=1351026217;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:03:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.073569  Lock_time: 0.000089 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026220;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:04:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.083527  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926477
SET timestamp=1351026249;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:04:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.694050  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026252;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:04:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 143.336014  Lock_time: 58.527429 Rows_sent: 65189  Rows_examined: 1737283
SET timestamp=1351026265;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 14:04:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 214.981541  Lock_time: 118.889039 Rows_sent: 16540  Rows_examined: 8106253
SET timestamp=1351026276;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:05:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.110165  Lock_time: 0.000080 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351026313;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:05:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.703636  Lock_time: 34.916481 Rows_sent: 126  Rows_examined: 1046359
SET timestamp=1351026335;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:05:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.678150  Lock_time: 34.916025 Rows_sent: 468  Rows_examined: 1242769
SET timestamp=1351026336;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:06:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.643744  Lock_time: 0.000116 Rows_sent: 7  Rows_examined: 926477
SET timestamp=1351026389;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:06:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.983225  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026392;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:07:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.519925  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926477
SET timestamp=1351026422;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:07:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.803063  Lock_time: 0.000066 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026424;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:08:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 204.330917  Lock_time: 35.001306 Rows_sent: 1493  Rows_examined: 6454565
SET timestamp=1351026505;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 14:08:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.966161  Lock_time: 0.000159 Rows_sent: 6  Rows_examined: 926477
SET timestamp=1351026512;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:08:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.780391  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351026515;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:09:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 210.143267  Lock_time: 141.465717 Rows_sent: 126  Rows_examined: 1046360
SET timestamp=1351026571;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:09:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 129.121632  Lock_time: 59.371048 Rows_sent: 468  Rows_examined: 1242770
SET timestamp=1351026572;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 211.248648  Lock_time: 141.464700 Rows_sent: 468  Rows_examined: 1242770
SET timestamp=1351026572;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:09:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.906944  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926477
SET timestamp=1351026573;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:09:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.469964  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026576;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:09:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 155.451169  Lock_time: 80.649481 Rows_sent: 16540  Rows_examined: 8106254
SET timestamp=1351026577;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
# Time: 121023 14:10:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.044626  Lock_time: 0.000126 Rows_sent: 4  Rows_examined: 29638
SET timestamp=1351026622;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.051352  Lock_time: 0.000125 Rows_sent: 4  Rows_examined: 29638
SET timestamp=1351026622;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 14:10:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.839297  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926477
SET timestamp=1351026633;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:10:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.827147  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026636;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:11:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.816135  Lock_time: 0.000134 Rows_sent: 126  Rows_examined: 1046367
SET timestamp=1351026694;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:11:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.642834  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242777
SET timestamp=1351026695;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:11:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.100085  Lock_time: 0.000134 Rows_sent: 6  Rows_examined: 926479
SET timestamp=1351026696;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:11:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.506008  Lock_time: 0.000068 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351026699;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:11:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.987418  Lock_time: 0.000220 Rows_sent: 16540  Rows_examined: 8106375
SET timestamp=1351026701;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.232582  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19449
SET timestamp=1351026722;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.912317  Lock_time: 0.000153 Rows_sent: 3  Rows_examined: 30427
SET timestamp=1351026736;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 14:13:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.535699  Lock_time: 0.000126 Rows_sent: 7  Rows_examined: 926481
SET timestamp=1351026788;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:13:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.045953  Lock_time: 0.000076 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026791;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:13:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.740492  Lock_time: 0.000172 Rows_sent: 7  Rows_examined: 926482
SET timestamp=1351026813;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:13:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.927834  Lock_time: 0.000101 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026816;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:13:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.892017  Lock_time: 0.000130 Rows_sent: 126  Rows_examined: 1046370
SET timestamp=1351026823;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:13:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.362006  Lock_time: 0.000124 Rows_sent: 468  Rows_examined: 1242780
SET timestamp=1351026824;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:14:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.236660  Lock_time: 0.000125 Rows_sent: 6  Rows_examined: 926483
SET timestamp=1351026868;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:14:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.809872  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351026872;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:15:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.385812  Lock_time: 0.000100 Rows_sent: 126  Rows_examined: 1046373
SET timestamp=1351026900;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.460480  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1242783
SET timestamp=1351026900;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:15:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.186157  Lock_time: 0.000212 Rows_sent: 16540  Rows_examined: 8106592
SET timestamp=1351026902;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:15:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.024294  Lock_time: 0.000099 Rows_sent: 5  Rows_examined: 3767
SET timestamp=1351026903;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
# Time: 121023 14:15:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.699233  Lock_time: 0.000087 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351026931;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:15:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.038692  Lock_time: 0.000140 Rows_sent: 7  Rows_examined: 926483
SET timestamp=1351026950;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:15:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.986565  Lock_time: 0.000105 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026953;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:16:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.324166  Lock_time: 0.000179 Rows_sent: 7  Rows_examined: 926483
SET timestamp=1351026982;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:16:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.335119  Lock_time: 0.000108 Rows_sent: 24  Rows_examined: 20313
SET timestamp=1351026987;
SELECT DATE_FORMAT(date,'%H'),visitors FROM hits WHERE source='Facebook' AND DATE(date)='2012-10-21';
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.885326  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351026987;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:16:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.765964  Lock_time: 0.000093 Rows_sent: 126  Rows_examined: 1046374
SET timestamp=1351027018;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:16:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.239695  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1242784
SET timestamp=1351027019;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:17:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.562580  Lock_time: 0.000239 Rows_sent: 16540  Rows_examined: 8106711
SET timestamp=1351027025;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:17:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.201731  Lock_time: 0.000119 Rows_sent: 16  Rows_examined: 8425
SET timestamp=1351027029;
SELECT `date`,visitors FROM hits WHERE source='Reply' AND DATE(`date`)='2012-10-18';
# Time: 121023 14:17:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.825059  Lock_time: 0.000204 Rows_sent: 6  Rows_examined: 926483
SET timestamp=1351027052;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:17:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.679514  Lock_time: 0.000118 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351027055;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:18:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 203.439848  Lock_time: 0.000089 Rows_sent: 1493  Rows_examined: 6454585
SET timestamp=1351027105;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.333964  Lock_time: 0.000090 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351027105;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 14:18:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.415211  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926483
SET timestamp=1351027118;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:18:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.083243  Lock_time: 0.000110 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027121;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:19:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.310005  Lock_time: 0.000135 Rows_sent: 7  Rows_examined: 926483
SET timestamp=1351027151;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:19:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.430784  Lock_time: 0.000078 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027155;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:19:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.265758  Lock_time: 0.000092 Rows_sent: 126  Rows_examined: 1046374
SET timestamp=1351027156;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:19:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.101161  Lock_time: 0.000121 Rows_sent: 468  Rows_examined: 1242784
SET timestamp=1351027157;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.502189  Lock_time: 0.000050 Rows_sent: 0  Rows_examined: 19454
SET timestamp=1351027204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:20:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.740987  Lock_time: 0.000071 Rows_sent: 15  Rows_examined: 1145
SET timestamp=1351027226;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:05:21' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:20:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.693725  Lock_time: 0.000094 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351027227;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.541384  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351027227;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
# Time: 121023 14:20:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.142635  Lock_time: 0.000163 Rows_sent: 6  Rows_examined: 926483
SET timestamp=1351027240;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:20:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.200570  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351027244;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:21:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.369251  Lock_time: 0.000255 Rows_sent: 16540  Rows_examined: 8106711
SET timestamp=1351027263;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:21:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.598032  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351027285;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 14:21:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.447353  Lock_time: 0.000145 Rows_sent: 7  Rows_examined: 926483
SET timestamp=1351027297;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.962165  Lock_time: 0.000075 Rows_sent: 126  Rows_examined: 1046374
SET timestamp=1351027297;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:21:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.108802  Lock_time: 0.000071 Rows_sent: 468  Rows_examined: 1242784
SET timestamp=1351027300;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.824107  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027300;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:22:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.840236  Lock_time: 0.000070 Rows_sent: 0  Rows_examined: 19457
SET timestamp=1351027324;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:22:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.690447  Lock_time: 0.000185 Rows_sent: 7  Rows_examined: 926484
SET timestamp=1351027342;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:22:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.857149  Lock_time: 0.000074 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027345;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:22:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.115291  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242787
SET timestamp=1351027376;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.112780  Lock_time: 0.000096 Rows_sent: 126  Rows_examined: 1046377
SET timestamp=1351027376;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:23:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.692333  Lock_time: 0.000242 Rows_sent: 16540  Rows_examined: 8106743
SET timestamp=1351027382;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:23:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.020042  Lock_time: 0.000132 Rows_sent: 65193  Rows_examined: 1737331
SET timestamp=1351027407;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 14:23:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.129490  Lock_time: 0.000135 Rows_sent: 6  Rows_examined: 926486
SET timestamp=1351027412;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:23:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.228342  Lock_time: 0.000100 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351027417;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:24:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.153374  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926486
SET timestamp=1351027465;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.785159  Lock_time: 0.000186 Rows_sent: 7  Rows_examined: 926486
SET timestamp=1351027465;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.679877  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926486
SET timestamp=1351027465;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:24:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.946527  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027468;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.946562  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027468;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.053142  Lock_time: 0.000086 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351027468;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:25:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.044436  Lock_time: 0.000099 Rows_sent: 126  Rows_examined: 1046379
SET timestamp=1351027521;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
# Time: 121023 14:25:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.621670  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351027523;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.950672  Lock_time: 0.000158 Rows_sent: 468  Rows_examined: 1242789
SET timestamp=1351027523;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:25:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.969210  Lock_time: 0.000172 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027524;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:25:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.835705  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027527;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:26:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.951975  Lock_time: 0.000170 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027592;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.504668  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027592;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.455155  Lock_time: 0.000163 Rows_sent: 8  Rows_examined: 926487
SET timestamp=1351027592;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:26:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.483437  Lock_time: 0.000101 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351027599;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:26:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.455767  Lock_time: 0.000052 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027600;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:26:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.179764  Lock_time: 0.000051 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351027601;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:27:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 142.525779  Lock_time: 0.000203 Rows_sent: 16540  Rows_examined: 8106833
SET timestamp=1351027644;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:27:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.332030  Lock_time: 0.000139 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027651;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:27:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.233427  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351027654;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:27:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.773520  Lock_time: 0.000128 Rows_sent: 126  Rows_examined: 1046379
SET timestamp=1351027657;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:27:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.903321  Lock_time: 0.000124 Rows_sent: 468  Rows_examined: 1242789
SET timestamp=1351027663;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:28:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.171211  Lock_time: 0.000221 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027681;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:28:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.381517  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 19459
SET timestamp=1351027683;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:28:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.335262  Lock_time: 0.000082 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027684;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:28:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 209.925446  Lock_time: 0.000125 Rows_sent: 1493  Rows_examined: 6454614
SET timestamp=1351027711;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 14:28:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.938801  Lock_time: 0.000118 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027713;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:28:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.218756  Lock_time: 0.000105 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027716;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:28:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.246775  Lock_time: 0.000106 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351027728;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:29:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.027823  Lock_time: 0.000129 Rows_sent: 8  Rows_examined: 926487
SET timestamp=1351027761;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:29:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.933827  Lock_time: 0.000082 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351027764;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.803228  Lock_time: 0.000100 Rows_sent: 126  Rows_examined: 1046379
SET timestamp=1351027764;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:29:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.944782  Lock_time: 0.000054 Rows_sent: 15  Rows_examined: 1306
SET timestamp=1351027773;
# Time: 121023 14:29:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.855784  Lock_time: 0.000170 Rows_sent: 468  Rows_examined: 1242789
SET timestamp=1351027774;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:29:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.053483  Lock_time: 0.000169 Rows_sent: 16540  Rows_examined: 8106833
SET timestamp=1351027779;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.346160  Lock_time: 0.000057 Rows_sent: 1  Rows_examined: 2568
SET timestamp=1351027803;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Wyotech'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Wyotech'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.062024  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19460
SET timestamp=1351027803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:30:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 23.689909  Lock_time: 0.000119 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351027825;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 23.683655  Lock_time: 0.000084 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351027825;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:30:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.131569  Lock_time: 0.000188 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027830;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.580609  Lock_time: 0.000124 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027830;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.310409  Lock_time: 0.000157 Rows_sent: 7  Rows_examined: 926487
SET timestamp=1351027830;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:30:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.621042  Lock_time: 0.000052 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027836;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.637926  Lock_time: 0.000102 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351027836;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:30:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.672645  Lock_time: 0.000059 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351027838;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:30:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.280965  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351027842;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 14:31:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.839422  Lock_time: 0.000150 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351027898;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:31:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.157259  Lock_time: 0.000074 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027902;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:32:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.338517  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351027933;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:32:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.304156  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351027937;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:32:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 139.125618  Lock_time: 0.000125 Rows_sent: 126  Rows_examined: 1046380
SET timestamp=1351027940;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:32:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.073850  Lock_time: 0.000146 Rows_sent: 5  Rows_examined: 2572
SET timestamp=1351027944;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:05:21' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:32:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.753497  Lock_time: 0.000082 Rows_sent: 15  Rows_examined: 1145
SET timestamp=1351027945;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:05:21' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.758653  Lock_time: 0.000059 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351027945;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23' AND interest.datetime < '2012-10-23 13:32:23' GROUP BY interest.affiliate;
# Time: 121023 14:32:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.622088  Lock_time: 0.000112 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351027948;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:32:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 148.270135  Lock_time: 0.000111 Rows_sent: 468  Rows_examined: 1242790
SET timestamp=1351027949;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:32:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.963462  Lock_time: 27.918669 Rows_sent: 3  Rows_examined: 30438
SET timestamp=1351027966;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 14:33:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 146.361438  Lock_time: 0.000169 Rows_sent: 6  Rows_examined: 926488
SET timestamp=1351028022;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 133.157985  Lock_time: 0.000169 Rows_sent: 8  Rows_examined: 926488
SET timestamp=1351028022;
# Time: 121023 14:34:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.495595  Lock_time: 0.000087 Rows_sent: 389  Rows_examined: 1097197
SET timestamp=1351028066;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 14:35:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 181.192318  Lock_time: 0.000184 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028111;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 206.263038  Lock_time: 0.000238 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028111;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:35:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.821349  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351028117;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:35:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.305420  Lock_time: 0.000064 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351028119;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:35:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.721071  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351028150;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.007741  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351028150;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:35:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.689685  Lock_time: 0.000113 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351028152;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:36:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.048068  Lock_time: 0.000084 Rows_sent: 0  Rows_examined: 19460
SET timestamp=1351028162;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:36:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 217.190128  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028164;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:31:04' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 168.875512  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028164;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 202.268162  Lock_time: 0.000156 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028164;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:36:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.263959  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028180;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.264158  Lock_time: 0.000048 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028180;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:37:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.529497  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351028226;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 14:37:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.921615  Lock_time: 0.000112 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351028232;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:38:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.685104  Lock_time: 0.000080 Rows_sent: 0  Rows_examined: 19460
SET timestamp=1351028284;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:38:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 147.114424  Lock_time: 0.000036 Rows_sent: 25  Rows_examined: 415581
SET timestamp=1351028311;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:31:04' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:39:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 312.317440  Lock_time: 0.000165 Rows_sent: 6  Rows_examined: 926488
SET timestamp=1351028358;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 289.323419  Lock_time: 0.000164 Rows_sent: 8  Rows_examined: 926488
SET timestamp=1351028358;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:39:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.449768  Lock_time: 0.000073 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351028363;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:39:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 428.303720  Lock_time: 13.899475 Rows_sent: 468  Rows_examined: 1242790
SET timestamp=1351028364;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 14:39:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.175225  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351028366;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:39:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 505.839615  Lock_time: 87.855354 Rows_sent: 16540  Rows_examined: 8106876
SET timestamp=1351028367;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:39:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 275.395639  Lock_time: 0.000174 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028393;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:39:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.078222  Lock_time: 0.000086 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351028396;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.013722  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 19461
SET timestamp=1351028404;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:40:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 14:40:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 172.031832  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028437;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.489380  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028437;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 115.051097  Lock_time: 0.000122 Rows_sent: 7  Rows_examined: 926488
SET timestamp=1351028437;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:40:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.874766  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028446;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.878157  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028446;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:40:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.214727  Lock_time: 0.000113 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351028449;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:41:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.717724  Lock_time: 0.000166 Rows_sent: 6  Rows_examined: 926489
SET timestamp=1351028488;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.701568  Lock_time: 0.000155 Rows_sent: 8  Rows_examined: 926489
SET timestamp=1351028488;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.325516  Lock_time: 0.000201 Rows_sent: 7  Rows_examined: 926489
SET timestamp=1351028488;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:41:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 447.388267  Lock_time: 325.756719 Rows_sent: 126  Rows_examined: 1046380
SET timestamp=1351028489;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:41:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 450.141930  Lock_time: 325.756743 Rows_sent: 468  Rows_examined: 1242790
SET timestamp=1351028491;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:41:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.805704  Lock_time: 0.000036 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351028494;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:41:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.187588  Lock_time: 0.000051 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351028496;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.957974  Lock_time: 0.000083 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351028496;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:42:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.872985  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926489
SET timestamp=1351028566;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.386310  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926489
SET timestamp=1351028566;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:42:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.529163  Lock_time: 0.000117 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028573;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.539710  Lock_time: 0.000117 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351028573;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:43:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.634268  Lock_time: 0.000181 Rows_sent: 7  Rows_examined: 926489
SET timestamp=1351028608;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:43:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.405916  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028612;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:43:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.350104  Lock_time: 0.000089 Rows_sent: 389  Rows_examined: 1097198
SET timestamp=1351028620;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 14:44:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.138551  Lock_time: 0.000063 Rows_sent: 0  Rows_examined: 19461
SET timestamp=1351028646;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:44:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.990339  Lock_time: 0.000166 Rows_sent: 6  Rows_examined: 926489
SET timestamp=1351028662;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.808696  Lock_time: 0.000162 Rows_sent: 8  Rows_examined: 926489
SET timestamp=1351028662;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.011642  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926489
SET timestamp=1351028662;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:44:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.869675  Lock_time: 0.000052 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351028668;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:44:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.685024  Lock_time: 0.000100 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351028673;
# Time: 121023 14:44:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.022735  Lock_time: 0.000100 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351028675;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:44:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 577.238274  Lock_time: 265.633698 Rows_sent: 1493  Rows_examined: 6454615
SET timestamp=1351028679;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 14:45:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.455082  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351028722;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:46:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.749641  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 19463
SET timestamp=1351028764;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:46:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 129.661665  Lock_time: 0.000134 Rows_sent: 7  Rows_examined: 926489
SET timestamp=1351028779;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:46:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.562121  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351028783;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:46:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 279.140714  Lock_time: 147.064008 Rows_sent: 126  Rows_examined: 1046381
SET timestamp=1351028801;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:46:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 284.808986  Lock_time: 147.067255 Rows_sent: 468  Rows_examined: 1242791
SET timestamp=1351028806;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:46:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.072095  Lock_time: 0.000156 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351028808;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:46:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 410.440429  Lock_time: 267.680095 Rows_sent: 16540  Rows_examined: 8106909
SET timestamp=1351028811;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.735076  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028811;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:47:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 140.827065  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351028856;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:47:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.238973  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351028859;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:47:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 351.798783  Lock_time: 147.063929 Rows_sent: 65193  Rows_examined: 1737343
SET timestamp=1351028873;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 14:47:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.902194  Lock_time: 41.863515 Rows_sent: 2994  Rows_examined: 269382
SET timestamp=1351028874;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023 14:48:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.640491  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19463
SET timestamp=1351028892;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:48:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.879206  Lock_time: 0.000094 Rows_sent: 15  Rows_examined: 1162
SET timestamp=1351028917;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:15:33' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.078382  Lock_time: 0.000066 Rows_sent: 15  Rows_examined: 1315
SET timestamp=1351028917;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:48:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 158.721706  Lock_time: 0.000097 Rows_sent: 6  Rows_examined: 926491
SET timestamp=1351028924;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 135.554791  Lock_time: 0.000161 Rows_sent: 8  Rows_examined: 926491
SET timestamp=1351028924;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:48:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.579961  Lock_time: 0.000057 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351028931;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:48:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.154043  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351028933;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:49:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.277211  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351028975;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 113.812298  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351028975;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 170.645078  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351028975;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 145.451164  Lock_time: 0.000189 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351028975;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:50:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.058940  Lock_time: 0.000100 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351029025;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.055084  Lock_time: 0.000084 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351029025;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:50:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.177412  Lock_time: 0.000057 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351029028;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:32:23' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:51:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.383421  Lock_time: 0.000157 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351029066;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:51:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 128.646877  Lock_time: 0.000160 Rows_sent: 6  Rows_examined: 926491
SET timestamp=1351029074;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.742862  Lock_time: 0.000139 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029074;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.550282  Lock_time: 0.000168 Rows_sent: 8  Rows_examined: 926491
SET timestamp=1351029074;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.643410  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029074;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:51:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.816264  Lock_time: 0.000057 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351029083;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:51:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.276311  Lock_time: 0.000054 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351029085;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:51:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.701393  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351029086;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:51:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.127908  Lock_time: 0.000057 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351029087;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:52:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.973228  Lock_time: 0.000041 Rows_sent: 0  Rows_examined: 19463
SET timestamp=1351029125;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:52:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.492091  Lock_time: 0.000137 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029143;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:52:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.094805  Lock_time: 0.000106 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351029146;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:53:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.782606  Lock_time: 0.000150 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029180;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:53:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.376819  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351029183;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:53:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.936780  Lock_time: 0.000173 Rows_sent: 6  Rows_examined: 926491
SET timestamp=1351029221;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.931952  Lock_time: 0.000169 Rows_sent: 8  Rows_examined: 926491
SET timestamp=1351029221;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.954543  Lock_time: 0.000209 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029221;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:53:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.111654  Lock_time: 0.000096 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351029228;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:53:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.552147  Lock_time: 0.000059 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351029230;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.711901  Lock_time: 0.000083 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351029230;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:54:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.926201  Lock_time: 0.000080 Rows_sent: 0  Rows_examined: 19463
SET timestamp=1351029244;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:54:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.537025  Lock_time: 0.000178 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029282;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:55:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.397643  Lock_time: 0.000194 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029300;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.842631  Lock_time: 0.000144 Rows_sent: 7  Rows_examined: 926491
SET timestamp=1351029300;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:55:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.532492  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351029308;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 14:55:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 609.672104  Lock_time: 172.302604 Rows_sent: 1493  Rows_examined: 6454616
SET timestamp=1351029310;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 14:55:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.381988  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351029312;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:55:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 201.440894  Lock_time: 185.799873 Rows_sent: 3  Rows_examined: 30441
SET timestamp=1351029323;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 14:55:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.508438  Lock_time: 0.000094 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351029338;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 14:56:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.316737  Lock_time: 0.000108 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351029360;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:56:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.154388  Lock_time: 0.000173 Rows_sent: 6  Rows_examined: 926491
SET timestamp=1351029398;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.131314  Lock_time: 0.000149 Rows_sent: 8  Rows_examined: 926492
SET timestamp=1351029398;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.177057  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926492
SET timestamp=1351029398;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.221551  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926492
SET timestamp=1351029398;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:56:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.194160  Lock_time: 0.021261 Rows_sent: 17  Rows_examined: 1815
SET timestamp=1351029403;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:56:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.496195  Lock_time: 0.000044 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351029406;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:56:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.485418  Lock_time: 0.000068 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351029407;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:56:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.226844  Lock_time: 0.000105 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351029409;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.562374  Lock_time: 0.000067 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351029409;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:57:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.998579  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351029432;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 14:57:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 552.199073  Lock_time: 426.522265 Rows_sent: 126  Rows_examined: 1046383
SET timestamp=1351029433;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:57:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 554.400861  Lock_time: 426.522338 Rows_sent: 468  Rows_examined: 1242793
SET timestamp=1351029435;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 345.186330  Lock_time: 217.204735 Rows_sent: 468  Rows_examined: 1242793
SET timestamp=1351029435;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 14:57:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 499.437293  Lock_time: 366.417323 Rows_sent: 16540  Rows_examined: 8106962
SET timestamp=1351029440;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 14:57:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.592119  Lock_time: 0.000103 Rows_sent: 2994  Rows_examined: 269382
SET timestamp=1351029450;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023 14:58:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.057225  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19487
SET timestamp=1351029482;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 14:58:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.365976  Lock_time: 0.000175 Rows_sent: 7  Rows_examined: 926492
SET timestamp=1351029483;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.844886  Lock_time: 0.000187 Rows_sent: 7  Rows_examined: 926492
SET timestamp=1351029483;
# Time: 121023 14:59:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.039903  Lock_time: 0.000162 Rows_sent: 8  Rows_examined: 926514
SET timestamp=1351029541;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.087234  Lock_time: 0.000163 Rows_sent: 6  Rows_examined: 926514
SET timestamp=1351029541;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 14:59:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.616048  Lock_time: 0.000056 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351029545;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:59:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.816593  Lock_time: 0.000102 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351029547;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 14:59:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.220207  Lock_time: 0.000094 Rows_sent: 125  Rows_examined: 1046411
SET timestamp=1351029561;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 14:59:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.382501  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242821
SET timestamp=1351029562;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 14:59:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.594472  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8107692
SET timestamp=1351029568;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.314110  Lock_time: 0.000168 Rows_sent: 94  Rows_examined: 6110
SET timestamp=1351029604;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# Time: 121023 15:00:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.402201  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 19487
SET timestamp=1351029605;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:00:33
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 5.652090  Lock_time: 0.000072 Rows_sent: 245  Rows_examined: 245
SET timestamp=1351029633;
SHOW TABLE STATUS FROM `degreeamerica`;
# User@Host: phpmysqladminRO[phpmysqladminRO] @ amweb01 [10.54.91.136]
# Query_time: 5.089038  Lock_time: 0.000110 Rows_sent: 245  Rows_examined: 245
SET timestamp=1351029633;
SHOW TABLE STATUS FROM `degreeamerica`;
# Time: 121023 15:00:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.205006  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351029634;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.009220  Lock_time: 0.000208 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351029634;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:00:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.116825  Lock_time: 0.000074 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351029641;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.128847  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351029641;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:00:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.680538  Lock_time: 0.000117 Rows_sent: 7  Rows_examined: 29641
SET timestamp=1351029657;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.670957  Lock_time: 0.000083 Rows_sent: 7  Rows_examined: 29641
SET timestamp=1351029657;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.197034  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 19493
SET timestamp=1351029723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:02:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.857550  Lock_time: 0.000149 Rows_sent: 5  Rows_examined: 2683
SET timestamp=1351029748;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:32:23' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:02:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.265825  Lock_time: 0.000094 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351029751;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:32:23' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:02:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 137.473643  Lock_time: 0.000123 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351029752;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.621684  Lock_time: 0.000163 Rows_sent: 6  Rows_examined: 926514
SET timestamp=1351029752;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.518187  Lock_time: 0.000183 Rows_sent: 8  Rows_examined: 926514
SET timestamp=1351029752;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:02:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.442253  Lock_time: 0.000065 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351029759;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:02:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.513723  Lock_time: 0.000119 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351029760;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:02:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.496307  Lock_time: 0.000088 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351029761;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:03:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 186.950056  Lock_time: 0.000091 Rows_sent: 125  Rows_examined: 1046411
SET timestamp=1351029788;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
# Time: 121023 15:03:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 188.934034  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242821
SET timestamp=1351029790;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:03:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.589950  Lock_time: 0.000183 Rows_sent: 16540  Rows_examined: 8107692
SET timestamp=1351029796;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:03:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.268019  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 3472
SET timestamp=1351029813;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM programs,sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.program_id=programs.id AND programs.allocation_id=106 AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC;
# Time: 121023 15:03:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.319968  Lock_time: 0.000062 Rows_sent: 15  Rows_examined: 1162
SET timestamp=1351029818;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:15:33' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.983934  Lock_time: 0.000058 Rows_sent: 15  Rows_examined: 1355
SET timestamp=1351029818;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:03:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 118.996734  Lock_time: 0.000134 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351029824;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:03:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.991987  Lock_time: 0.000136 Rows_sent: 10  Rows_examined: 3529
SET timestamp=1351029825;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.program_id=programs.id AND programs.allocation_id=106 AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 15:03:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.326625  Lock_time: 0.000098 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351029830;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:04:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.444113  Lock_time: 0.000174 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351029857;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:04:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.034406  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351029864;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:04:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 125.956496  Lock_time: 0.000157 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351029888;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:04:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.098740  Lock_time: 0.000076 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351029892;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:05:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.486920  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351029922;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:05:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.922424  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351029925;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:05:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 205.589921  Lock_time: 0.000192 Rows_sent: 65226  Rows_examined: 1737428
SET timestamp=1351029927;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 15:05:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.316269  Lock_time: 0.000093 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351029942;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:06:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.745032  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351029982;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:06:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.467889  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351029987;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:06:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.020182  Lock_time: 0.000055 Rows_sent: 15  Rows_examined: 1275
SET timestamp=1351029989;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23' AND interest.datetime < '2012-10-23 14:06:28' GROUP BY interest.affiliate;
# Time: 121023 15:06:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 148.833353  Lock_time: 0.000173 Rows_sent: 6  Rows_examined: 926514
SET timestamp=1351029995;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 125.743852  Lock_time: 0.000109 Rows_sent: 8  Rows_examined: 926514
SET timestamp=1351029995;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:06:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 159.372467  Lock_time: 0.000092 Rows_sent: 124  Rows_examined: 1043829
SET timestamp=1351030000;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:06:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.496685  Lock_time: 0.000071 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351030001;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:06:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.243793  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351030003;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:06:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 163.141220  Lock_time: 0.000138 Rows_sent: 468  Rows_examined: 1242822
SET timestamp=1351030004;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:06:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 168.427030  Lock_time: 0.000221 Rows_sent: 16540  Rows_examined: 8107897
SET timestamp=1351030009;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
# Time: 121023 15:07:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.100166  Lock_time: 0.000086 Rows_sent: 389  Rows_examined: 1097232
SET timestamp=1351030038;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 15:07:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 162.818472  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351030048;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:07:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.201495  Lock_time: 0.000102 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351030054;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:08:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.705591  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19496
SET timestamp=1351030087;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:08:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 181.136228  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351030091;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:23:08' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:08:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.022846  Lock_time: 0.000114 Rows_sent: 22  Rows_examined: 31035
SET timestamp=1351030095;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:23:08' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:08:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 174.386290  Lock_time: 0.000130 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351030116;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:08:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.077482  Lock_time: 0.000086 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030120;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:09:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 171.282680  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351030146;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 120.735567  Lock_time: 0.000195 Rows_sent: 6  Rows_examined: 926514
SET timestamp=1351030146;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:09:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.361521  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030152;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.959105  Lock_time: 0.000113 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030152;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:09:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.706342  Lock_time: 0.000072 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351030153;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.744999  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030153;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:09:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.070774  Lock_time: 0.000080 Rows_sent: 16  Rows_examined: 1363
SET timestamp=1351030173;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.674291  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 19499
SET timestamp=1351030204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:10:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 176.573673  Lock_time: 0.000137 Rows_sent: 8  Rows_examined: 926514
SET timestamp=1351030225;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 160.593111  Lock_time: 0.000138 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351030225;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:10:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.175149  Lock_time: 0.000099 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351030231;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:10:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.222158  Lock_time: 0.000050 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351030235;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:10:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.224109  Lock_time: 0.000126 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030241;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:10:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.919965  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030243;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:10:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 163.703080  Lock_time: 0.000064 Rows_sent: 124  Rows_examined: 1043830
SET timestamp=1351030245;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:11:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 178.956811  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242823
SET timestamp=1351030260;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:11:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.546886  Lock_time: 0.000111 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351030262;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.553303  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351030262;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 15:11:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 244.058000  Lock_time: 0.000203 Rows_sent: 16540  Rows_examined: 8107897
SET timestamp=1351030265;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:11:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 184.423097  Lock_time: 0.000118 Rows_sent: 7  Rows_examined: 926514
SET timestamp=1351030280;
# Time: 121023 15:11:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 185.103958  Lock_time: 0.000126 Rows_sent: 7  Rows_examined: 926516
SET timestamp=1351030307;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:12:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.579745  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19501
SET timestamp=1351030323;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:12:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.283506  Lock_time: 0.000151 Rows_sent: 3  Rows_examined: 30480
SET timestamp=1351030339;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 15:12:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.176348  Lock_time: 0.000108 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030343;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:12:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 215.783760  Lock_time: 0.000133 Rows_sent: 7  Rows_examined: 926517
SET timestamp=1351030371;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.248115  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926517
SET timestamp=1351030371;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 165.248450  Lock_time: 0.000190 Rows_sent: 6  Rows_examined: 926517
SET timestamp=1351030371;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:12:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.108215  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030377;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:12:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.267327  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351030379;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.467659  Lock_time: 0.000073 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351030379;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:13:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 531.580743  Lock_time: 0.000193 Rows_sent: 1493  Rows_examined: 6454696
SET timestamp=1351030433;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 15:13:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.437898  Lock_time: 0.000170 Rows_sent: 6  Rows_examined: 926521
SET timestamp=1351030437;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.700550  Lock_time: 0.000101 Rows_sent: 124  Rows_examined: 1043835
SET timestamp=1351030437;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:14:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 119.452738  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242828
SET timestamp=1351030440;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:14:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.362333  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19502
SET timestamp=1351030448;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:14:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.009629  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351030449;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:14:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.491729  Lock_time: 0.000175 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030472;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.542770  Lock_time: 0.000132 Rows_sent: 8  Rows_examined: 926521
SET timestamp=1351030472;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:14:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.354593  Lock_time: 0.000060 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351030477;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:14:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.025949  Lock_time: 0.000107 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351030478;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:15:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 144.711394  Lock_time: 0.000213 Rows_sent: 16540  Rows_examined: 8108152
SET timestamp=1351030525;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:15:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.398154  Lock_time: 0.000079 Rows_sent: 2  Rows_examined: 29636
SET timestamp=1351030527;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:15:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.633349  Lock_time: 0.000142 Rows_sent: 5  Rows_examined: 2942
SET timestamp=1351030533;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:15:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.360727  Lock_time: 0.000126 Rows_sent: 124  Rows_examined: 1043838
SET timestamp=1351030544;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:15:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.404584  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242831
SET timestamp=1351030546;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
# Time: 121023 15:15:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.217500  Lock_time: 0.000136 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030548;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:15:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.024479  Lock_time: 0.000074 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030551;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:16:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.032545  Lock_time: 0.000106 Rows_sent: 24  Rows_examined: 20313
SET timestamp=1351030562;
SELECT DATE_FORMAT(date,'%H'),visitors FROM hits WHERE source='Facebook' AND DATE(date)='2012-10-21';
# Time: 121023 15:16:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.302808  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19502
SET timestamp=1351030565;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:16:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.556374  Lock_time: 0.000154 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030588;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:16:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.582243  Lock_time: 0.000109 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030613;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:16:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.105789  Lock_time: 0.000079 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030614;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:16:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.403865  Lock_time: 0.000218 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030615;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:16:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.462227  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030618;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:17:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.779648  Lock_time: 0.000150 Rows_sent: 8  Rows_examined: 926521
SET timestamp=1351030651;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.648715  Lock_time: 0.000216 Rows_sent: 6  Rows_examined: 926521
SET timestamp=1351030651;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:17:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.118183  Lock_time: 0.000115 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351030656;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:17:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.825897  Lock_time: 0.000072 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351030657;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:17:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.331684  Lock_time: 0.000122 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030669;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:18:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.838770  Lock_time: 0.000170 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030696;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:18:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.364035  Lock_time: 0.000078 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351030700;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:18:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.044440  Lock_time: 0.000076 Rows_sent: 1  Rows_examined: 1094
SET timestamp=1351030709;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC;
# Time: 121023 15:18:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.706762  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030737;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.202010  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030737;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:19:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.924731  Lock_time: 0.000052 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030740;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.924849  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030740;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:19:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.239900  Lock_time: 0.000110 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351030743;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.050500  Lock_time: 0.000094 Rows_sent: 129  Rows_examined: 14780
SET timestamp=1351030803;
SELECT LOWER(stats_small.val),DATE_FORMAT(stats_small.datetime, '%Y-%m-%d %H:00:00') AS hr,COUNT(DISTINCT stats_small.session),SUBSTRING_INDEX(stats_small.host,'.',-2) AS domain FROM stats_small WHERE stats_small.name='utm_source' AND stats_small.datetime >= '2012-10-23' GROUP BY stats_small.val,hr,domain;
# Time: 121023 15:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.393257  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19502
SET timestamp=1351030804;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:20:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.039994  Lock_time: 0.000169 Rows_sent: 6  Rows_examined: 926521
SET timestamp=1351030805;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:20:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.218297  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351030809;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:20:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.317926  Lock_time: 0.000082 Rows_sent: 2  Rows_examined: 29636
SET timestamp=1351030828;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.327123  Lock_time: 0.000204 Rows_sent: 2  Rows_examined: 29636
SET timestamp=1351030828;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 15:20:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.922409  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030843;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.924031  Lock_time: 0.000183 Rows_sent: 8  Rows_examined: 926521
SET timestamp=1351030843;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:20:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.036729  Lock_time: 0.000057 Rows_sent: 19  Rows_examined: 26934
# Time: 121023 15:21:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 223.124657  Lock_time: 221.794583 Rows_sent: 2994  Rows_examined: 269382
SET timestamp=1351030862;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023 15:21:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 364.814907  Lock_time: 44.503974 Rows_sent: 1493  Rows_examined: 6454727
SET timestamp=1351030866;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 15:21:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.717830  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030908;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.466143  Lock_time: 0.000198 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351030908;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:21:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.950756  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030911;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.950883  Lock_time: 0.000118 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351030911;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:22:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 362.241578  Lock_time: 299.866693 Rows_sent: 124  Rows_examined: 1043838
SET timestamp=1351030923;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:22:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 362.936129  Lock_time: 299.866129 Rows_sent: 468  Rows_examined: 1242831
SET timestamp=1351030924;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:22:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 369.164755  Lock_time: 299.866007 Rows_sent: 16540  Rows_examined: 8108152
SET timestamp=1351030930;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:22:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.137127  Lock_time: 14.048748 Rows_sent: 10  Rows_examined: 2159
SET timestamp=1351030932;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 15:23:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.351374  Lock_time: 0.000153 Rows_sent: 6  Rows_examined: 926521
SET timestamp=1351030985;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:23:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.281489  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351030989;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:23:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.962873  Lock_time: 0.000223 Rows_sent: 8  Rows_examined: 926521
SET timestamp=1351031008;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.066753  Lock_time: 0.000142 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031008;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:23:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.494881  Lock_time: 0.000079 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351031012;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:23:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.084503  Lock_time: 0.000045 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351031014;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:24:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 123.506835  Lock_time: 9.177490 Rows_sent: 65228  Rows_examined: 1737455
SET timestamp=1351031044;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 15:24:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.298270  Lock_time: 0.000098 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031074;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:24:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.544671  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031076;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:24:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.053800  Lock_time: 0.000112 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031079;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:25:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.354073  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 1094
SET timestamp=1351031100;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC;
# Time: 121023 15:25:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.603057  Lock_time: 0.000112 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031116;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.339458  Lock_time: 2.712604 Rows_sent: 124  Rows_examined: 1043838
SET timestamp=1351031116;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:25:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.425400  Lock_time: 0.000100 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031118;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:25:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.303477  Lock_time: 0.000111 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031121;
# Time: 121023 15:25:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.065623  Lock_time: 2.713350 Rows_sent: 468  Rows_examined: 1242831
SET timestamp=1351031123;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:25:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.600592  Lock_time: 59.712706 Rows_sent: 10  Rows_examined: 2159
SET timestamp=1351031124;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.354369  Lock_time: 54.466483 Rows_sent: 10  Rows_examined: 2159
SET timestamp=1351031124;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.618046  Lock_time: 22.730127 Rows_sent: 10  Rows_examined: 2159
SET timestamp=1351031124;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 15:25:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.500328  Lock_time: 0.000104 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031126;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:25:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.255691  Lock_time: 0.000083 Rows_sent: 2  Rows_examined: 29636
SET timestamp=1351031127;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:26:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.124544  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031162;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.464544  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19502
SET timestamp=1351031162;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:26:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.023275  Lock_time: 0.000165 Rows_sent: 6  Rows_examined: 926521
SET timestamp=1351031173;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.023137  Lock_time: 0.000164 Rows_sent: 8  Rows_examined: 926521
SET timestamp=1351031173;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.038261  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031173;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:26:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.865114  Lock_time: 0.000099 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351031180;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:26:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.401329  Lock_time: 0.000052 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351031181;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.611410  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351031181;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:26:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.140521  Lock_time: 0.000093 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031205;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:26:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.023390  Lock_time: 0.000107 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031206;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:27:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.685415  Lock_time: 0.000120 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031247;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:27:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 147.803767  Lock_time: 21.915305 Rows_sent: 16540  Rows_examined: 8108152
SET timestamp=1351031248;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:27:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.130987  Lock_time: 0.000051 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031250;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:27:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.008632  Lock_time: 0.000082 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031263;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:28:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.476056  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031284;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:28:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.142306  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031287;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:28:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 225.341784  Lock_time: 21.922510 Rows_sent: 1493  Rows_examined: 6454727
SET timestamp=1351031326;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 15:29:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.240367  Lock_time: 0.000168 Rows_sent: 6  Rows_examined: 926521
SET timestamp=1351031347;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.259616  Lock_time: 0.000166 Rows_sent: 8  Rows_examined: 926521
SET timestamp=1351031347;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:29:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.658762  Lock_time: 0.000055 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351031352;
# Time: 121023 15:29:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.463450  Lock_time: 0.000217 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031390;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:29:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.336303  Lock_time: 0.000097 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351031395;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.201493  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19502
SET timestamp=1351031403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:30:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 247.445469  Lock_time: 162.295216 Rows_sent: 124  Rows_examined: 1043838
SET timestamp=1351031408;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:30:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 248.580299  Lock_time: 162.294932 Rows_sent: 468  Rows_examined: 1242831
SET timestamp=1351031409;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:30:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 133.635385  Lock_time: 42.079023 Rows_sent: 16540  Rows_examined: 8108152
SET timestamp=1351031415;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:30:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.927159  Lock_time: 0.000124 Rows_sent: 2  Rows_examined: 29636
SET timestamp=1351031428;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.936292  Lock_time: 0.000106 Rows_sent: 2  Rows_examined: 29636
SET timestamp=1351031428;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 15:30:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.075976  Lock_time: 0.000069 Rows_sent: 17  Rows_examined: 1391
SET timestamp=1351031433;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:30:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.516046  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031444;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:30:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.799377  Lock_time: 0.000140 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031445;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:31:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.844478  Lock_time: 0.000127 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031483;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:31:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.603630  Lock_time: 0.000070 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031487;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:31:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.383155  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031518;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:32:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.107010  Lock_time: 0.000141 Rows_sent: 6  Rows_examined: 926524
SET timestamp=1351031521;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.877675  Lock_time: 0.000217 Rows_sent: 7  Rows_examined: 926521
SET timestamp=1351031521;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:32:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.655988  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19508
SET timestamp=1351031524;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:32:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.909363  Lock_time: 0.000043 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031531;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.497111  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351031531;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:32:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.353419  Lock_time: 0.000163 Rows_sent: 3  Rows_examined: 30489
SET timestamp=1351031543;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 15:32:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.399011  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031549;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:33:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.449630  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926524
SET timestamp=1351031591;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.348964  Lock_time: 0.000162 Rows_sent: 8  Rows_examined: 926524
SET timestamp=1351031591;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:33:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.042875  Lock_time: 0.000072 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351031596;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:33:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.851978  Lock_time: 0.000126 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351031598;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:33:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.027811  Lock_time: 0.000120 Rows_sent: 5  Rows_examined: 2980
SET timestamp=1351031612;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:33:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.046550  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031613;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:33:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.393196  Lock_time: 0.000179 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351031634;
# Time: 121023 15:34:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.925382  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926525
SET timestamp=1351031641;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 119.229749  Lock_time: 0.000092 Rows_sent: 124  Rows_examined: 1043843
SET timestamp=1351031641;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 119.879544  Lock_time: 0.000111 Rows_sent: 468  Rows_examined: 1242836
SET timestamp=1351031641;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:34:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.068168  Lock_time: 0.000077 Rows_sent: 0  Rows_examined: 19514
SET timestamp=1351031642;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:34:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.598866  Lock_time: 0.000104 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031643;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:34:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 185.019221  Lock_time: 0.000215 Rows_sent: 16540  Rows_examined: 8108256
SET timestamp=1351031647;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:34:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.477037  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031662;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:34:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.363395  Lock_time: 0.000105 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031663;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:34:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.735667  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926528
SET timestamp=1351031683;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:34:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.997836  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031686;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:35:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.801525  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351031704;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:35:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.671651  Lock_time: 0.000113 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351031727;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:35:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.416473  Lock_time: 0.000162 Rows_sent: 6  Rows_examined: 926529
SET timestamp=1351031745;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.481445  Lock_time: 0.000167 Rows_sent: 8  Rows_examined: 926530
SET timestamp=1351031745;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:35:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.928061  Lock_time: 0.000083 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351031750;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:35:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.145466  Lock_time: 0.000103 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351031751;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:36:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.999806  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19515
SET timestamp=1351031766;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:36:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 133.291318  Lock_time: 0.000126 Rows_sent: 124  Rows_examined: 1043849
SET timestamp=1351031774;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:36:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.739511  Lock_time: 0.000214 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351031785;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:36:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.448618  Lock_time: 0.000095 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351031791;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:37:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.752774  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351031821;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:37:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.027471  Lock_time: 0.000114 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031824;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:37:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.165919  Lock_time: 0.000155 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351031845;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:37:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.675075  Lock_time: 0.000090 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031850;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:38:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 120.660432  Lock_time: 0.000118 Rows_sent: 468  Rows_examined: 1242844
SET timestamp=1351031881;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:38:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.046830  Lock_time: 0.000165 Rows_sent: 6  Rows_examined: 926530
SET timestamp=1351031897;
# Time: 121023 15:38:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.377112  Lock_time: 0.000160 Rows_sent: 8  Rows_examined: 926530
SET timestamp=1351031916;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.424288  Lock_time: 0.000205 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351031916;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:38:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.527173  Lock_time: 0.000068 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351031921;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:38:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.433155  Lock_time: 0.000090 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351031923;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:39:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.178662  Lock_time: 0.000130 Rows_sent: 124  Rows_examined: 1043851
SET timestamp=1351031976;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:39:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 156.365518  Lock_time: 0.000251 Rows_sent: 16540  Rows_examined: 8108542
SET timestamp=1351031977;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:39:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.252379  Lock_time: 0.000153 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351031982;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:39:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.301686  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351031985;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:40:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.759628  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19515
SET timestamp=1351032003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:40:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.613507  Lock_time: 0.000106 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032009;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:40:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.474255  Lock_time: 0.000110 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351032026;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:40:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.465329  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351032027;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.454731  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351032027;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 15:40:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.443082  Lock_time: 0.000088 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032030;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:41:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.939289  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032063;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:41:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.217500  Lock_time: 0.000084 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032065;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:41:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.736690  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351032073;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.624383  Lock_time: 0.000142 Rows_sent: 8  Rows_examined: 926530
SET timestamp=1351032073;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.593655  Lock_time: 0.000171 Rows_sent: 6  Rows_examined: 926530
SET timestamp=1351032073;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:41:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 373.894149  Lock_time: 0.000122 Rows_sent: 1493  Rows_examined: 6454804
SET timestamp=1351032075;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 15:41:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.746395  Lock_time: 0.000044 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351032078;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:41:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.373610  Lock_time: 0.000038 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351032082;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.623655  Lock_time: 0.000077 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351032082;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:41:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.125214  Lock_time: 0.000135 Rows_sent: 124  Rows_examined: 1043851
SET timestamp=1351032089;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:41:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.243091  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1242844
SET timestamp=1351032090;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:41:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.829564  Lock_time: 0.000310 Rows_sent: 16540  Rows_examined: 8108542
SET timestamp=1351032095;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
# Time: 121023 15:42:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.856403  Lock_time: 0.000181 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351032158;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:42:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.025878  Lock_time: 0.000117 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032162;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:43:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.912827  Lock_time: 0.000136 Rows_sent: 124  Rows_examined: 1043850
SET timestamp=1351032187;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.103149  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242843
SET timestamp=1351032187;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:43:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.950847  Lock_time: 0.000156 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351032188;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:43:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.400104  Lock_time: 0.000080 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032196;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:43:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.149714  Lock_time: 0.000108 Rows_sent: 65260  Rows_examined: 1737489
SET timestamp=1351032232;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 15:44:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.730204  Lock_time: 0.000132 Rows_sent: 6  Rows_examined: 926530
SET timestamp=1351032250;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:44:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.911652  Lock_time: 0.000083 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351032254;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:44:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.301262  Lock_time: 0.000126 Rows_sent: 8  Rows_examined: 926530
SET timestamp=1351032283;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.377320  Lock_time: 0.000125 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351032283;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:44:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.614897  Lock_time: 0.000081 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351032288;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:44:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.362813  Lock_time: 0.000066 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351032289;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:44:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.471672  Lock_time: 0.000076 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032296;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:45:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.033767  Lock_time: 0.000090 Rows_sent: 133  Rows_examined: 17040
SET timestamp=1351032302;
SELECT LOWER(stats_small.val),DATE_FORMAT(stats_small.datetime, '%Y-%m-%d %H:00:00') AS hr,COUNT(DISTINCT stats_small.session),SUBSTRING_INDEX(stats_small.host,'.',-2) AS domain FROM stats_small WHERE stats_small.name='utm_source' AND stats_small.datetime >= '2012-10-23' GROUP BY stats_small.val,hr,domain;
# Time: 121023 15:45:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.355983  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351032327;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:45:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.696758  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032342;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:45:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 163.651801  Lock_time: 0.000207 Rows_sent: 16540  Rows_examined: 8108541
SET timestamp=1351032345;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:45:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.617612  Lock_time: 0.000140 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351032353;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 112.587780  Lock_time: 0.000129 Rows_sent: 124  Rows_examined: 1043850
SET timestamp=1351032353;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:45:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 114.903894  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1242843
SET timestamp=1351032356;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:45:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.684922  Lock_time: 0.000047 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032359;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:46:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.010416  Lock_time: 0.000049 Rows_sent: 0  Rows_examined: 19516
SET timestamp=1351032363;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:46:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.318752  Lock_time: 0.000127 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032380;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:46:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.424289  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926530
SET timestamp=1351032387;
# Time: 121023 15:47:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.903540  Lock_time: 0.000220 Rows_sent: 6  Rows_examined: 926530
SET timestamp=1351032432;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:47:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.467825  Lock_time: 0.000126 Rows_sent: 124  Rows_examined: 1043850
SET timestamp=1351032434;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:47:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.146524  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351032436;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:47:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.041717  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242843
SET timestamp=1351032437;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:47:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.399087  Lock_time: 0.000171 Rows_sent: 16540  Rows_examined: 8108541
SET timestamp=1351032442;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:47:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.450434  Lock_time: 0.000161 Rows_sent: 8  Rows_examined: 926531
SET timestamp=1351032473;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.485108  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926531
SET timestamp=1351032473;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:47:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.705298  Lock_time: 0.000095 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351032478;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:48:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.539456  Lock_time: 0.000050 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351032480;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:48:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.403999  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19518
SET timestamp=1351032482;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:48:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.138766  Lock_time: 0.000120 Rows_sent: 7  Rows_examined: 926532
SET timestamp=1351032536;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:48:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.972013  Lock_time: 0.000114 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032539;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:49:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.927175  Lock_time: 0.000123 Rows_sent: 5  Rows_examined: 2786
SET timestamp=1351032548;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:19:05' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:49:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.012450  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926532
SET timestamp=1351032565;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.857292  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926532
SET timestamp=1351032565;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:48:16' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:49:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.676059  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032569;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.784124  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 31190
SET timestamp=1351032569;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:48:16' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:49:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.864978  Lock_time: 0.000123 Rows_sent: 124  Rows_examined: 1043852
SET timestamp=1351032575;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:49:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 274.994725  Lock_time: 0.000203 Rows_sent: 1493  Rows_examined: 6454804
SET timestamp=1351032576;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 15:49:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.261496  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242845
SET timestamp=1351032578;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.322717  Lock_time: 0.000040 Rows_sent: 0  Rows_examined: 19519
SET timestamp=1351032604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 15:50:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.053606  Lock_time: 0.000062 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351032631;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.057653  Lock_time: 0.000082 Rows_sent: 1  Rows_examined: 29635
SET timestamp=1351032631;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:50:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.256080  Lock_time: 0.000148 Rows_sent: 6  Rows_examined: 926533
SET timestamp=1351032650;
# Time: 121023 15:51:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.264426  Lock_time: 0.000122 Rows_sent: 7  Rows_examined: 926534
SET timestamp=1351032678;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.205861  Lock_time: 0.000170 Rows_sent: 8  Rows_examined: 926534
SET timestamp=1351032678;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:51:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.819438  Lock_time: 0.000087 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351032683;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:51:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.092770  Lock_time: 0.000093 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351032692;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:52:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.217922  Lock_time: 0.000106 Rows_sent: 124  Rows_examined: 1043854
SET timestamp=1351032728;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:52:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.160892  Lock_time: 0.000076 Rows_sent: 468  Rows_examined: 1242847
SET timestamp=1351032729;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:52:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 192.970417  Lock_time: 0.000196 Rows_sent: 16540  Rows_examined: 8108637
SET timestamp=1351032734;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:52:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.757559  Lock_time: 13.262641 Rows_sent: 3  Rows_examined: 30502
SET timestamp=1351032760;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 15:52:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 119.217212  Lock_time: 0.000179 Rows_sent: 7  Rows_examined: 926534
SET timestamp=1351032761;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:52:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.118236  Lock_time: 0.000073 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032765;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:53:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.081552  Lock_time: 0.000190 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351032825;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:53:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 153.548633  Lock_time: 0.000220 Rows_sent: 7  Rows_examined: 926534
SET timestamp=1351032829;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 151.886822  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926534
SET timestamp=1351032829;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:48:16' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:53:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.371939  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032832;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.398139  Lock_time: 0.000087 Rows_sent: 22  Rows_examined: 31190
SET timestamp=1351032832;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:48:16' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:54:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.749377  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032842;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:54:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.110469  Lock_time: 0.000137 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351032843;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:54:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 147.802821  Lock_time: 0.000122 Rows_sent: 6  Rows_examined: 926534
SET timestamp=1351032874;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.792691  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926534
SET timestamp=1351032874;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.801048  Lock_time: 0.000189 Rows_sent: 8  Rows_examined: 926534
SET timestamp=1351032874;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:54:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.299819  Lock_time: 0.000059 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351032885;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:54:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.223796  Lock_time: 0.000102 Rows_sent: 2994  Rows_examined: 269383
SET timestamp=1351032886;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023 15:54:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.721437  Lock_time: 0.000133 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351032887;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.034598  Lock_time: 0.000056 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351032888;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:55:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.748962  Lock_time: 0.000111 Rows_sent: 133  Rows_examined: 18206
SET timestamp=1351032903;
SELECT LOWER(stats_small.val),DATE_FORMAT(stats_small.datetime, '%Y-%m-%d %H:00:00') AS hr,COUNT(DISTINCT stats_small.session),SUBSTRING_INDEX(stats_small.host,'.',-2) AS domain FROM stats_small WHERE stats_small.name='utm_source' AND stats_small.datetime >= '2012-10-23' GROUP BY stats_small.val,hr,domain;
# Time: 121023 15:55:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.245409  Lock_time: 0.000122 Rows_sent: 5  Rows_examined: 2786
SET timestamp=1351032907;
# Time: 121023 15:55:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.853291  Lock_time: 0.000154 Rows_sent: 0  Rows_examined: 29634
SET timestamp=1351032935;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 15:55:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.679487  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926538
SET timestamp=1351032939;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.218331  Lock_time: 0.000226 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351032939;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.076418  Lock_time: 0.000127 Rows_sent: 7  Rows_examined: 926537
SET timestamp=1351032939;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:55:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.612463  Lock_time: 0.000101 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032942;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.612227  Lock_time: 0.000055 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351032942;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.738542  Lock_time: 0.000120 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351032942;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:55:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.570665  Lock_time: 0.000123 Rows_sent: 10  Rows_examined: 2206
SET timestamp=1351032950;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 15:56:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.915687  Lock_time: 0.000125 Rows_sent: 28157  Rows_examined: 83287
SET timestamp=1351032960;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,NULL,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-10-01' AND sessions.expire < '2012-10-24';
# Time: 121023 15:56:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 137.609171  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043859
SET timestamp=1351032979;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:56:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 139.286576  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242852
SET timestamp=1351032981;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:56:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.822907  Lock_time: 0.000169 Rows_sent: 10  Rows_examined: 4533
SET timestamp=1351032986;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.program_id=programs.id AND programs.allocation_id=316 AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 15:56:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.376238  Lock_time: 0.000189 Rows_sent: 6  Rows_examined: 926539
SET timestamp=1351032996;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.082671  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926539
SET timestamp=1351032996;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.519352  Lock_time: 0.000197 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351032996;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:56:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.021519  Lock_time: 0.000060 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351033003;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:56:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.873903  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351033005;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:56:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.309104  Lock_time: 0.000058 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351033006;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:57:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.690102  Lock_time: 0.000130 Rows_sent: 10  Rows_examined: 4533
SET timestamp=1351033046;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.program_id=programs.id AND programs.allocation_id=316 AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 15:57:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.270461  Lock_time: 0.000108 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033056;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:57:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.434296  Lock_time: 0.000142 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033066;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.963014  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033066;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.368425  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033066;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:57:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.918295  Lock_time: 0.000048 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033069;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.918519  Lock_time: 0.000063 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033069;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:57:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 175.410928  Lock_time: 0.000146 Rows_sent: 16540  Rows_examined: 8108895
SET timestamp=1351033076;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 15:58:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.313371  Lock_time: 0.000186 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351033107;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:58:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.162693  Lock_time: 0.000095 Rows_sent: 17  Rows_examined: 1815
SET timestamp=1351033110;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:58:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.268239  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033111;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:59:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.880739  Lock_time: 0.000177 Rows_sent: 6  Rows_examined: 926539
SET timestamp=1351033146;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:59:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.457991  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351033150;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:59:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.793128  Lock_time: 0.000162 Rows_sent: 124  Rows_examined: 1043860
SET timestamp=1351033153;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 15:59:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.324461  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242853
SET timestamp=1351033154;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 15:59:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 258.807952  Lock_time: 0.000096 Rows_sent: 1493  Rows_examined: 6454836
SET timestamp=1351033160;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.940332  Lock_time: 0.000181 Rows_sent: 16540  Rows_examined: 8108895
SET timestamp=1351033160;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.847709  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033160;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 15:59:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.076263  Lock_time: 0.000107 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033161;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 15:59:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.840096  Lock_time: 0.000162 Rows_sent: 8  Rows_examined: 926539
SET timestamp=1351033179;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.829328  Lock_time: 0.000135 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033179;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 15:59:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.951204  Lock_time: 0.000110 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351033184;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 15:59:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.782950  Lock_time: 0.000059 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351033185;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.108902  Lock_time: 0.000081 Rows_sent: 133  Rows_examined: 18426
SET timestamp=1351033203;
SELECT LOWER(stats_small.val),DATE_FORMAT(stats_small.datetime, '%Y-%m-%d %H:00:00') AS hr,COUNT(DISTINCT stats_small.session),SUBSTRING_INDEX(stats_small.host,'.',-2) AS domain FROM stats_small WHERE stats_small.name='utm_source' AND stats_small.datetime >= '2012-10-23' GROUP BY stats_small.val,hr,domain;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.230536  Lock_time: 0.000076 Rows_sent: 20  Rows_examined: 304
SET timestamp=1351033203;
SELECT
    interest.id,
    interest.data
FROM
    interest
    LEFT JOIN interest_ext ON (
        interest.id = interest_ext.interest_id
    )
WHERE
    interest_ext.interest_id IS NULL
--    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
AND interest.id > 852387
LIMIT
    20;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.481943  Lock_time: 0.000119 Rows_sent: 5  Rows_examined: 1626
SET timestamp=1351033203;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Strayer University Online WT'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Strayer University Online WT'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023 16:00:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.953842  Lock_time: 0.000105 Rows_sent: 80  Rows_examined: 6284
SET timestamp=1351033205;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.011693  Lock_time: 0.000049 Rows_sent: 0  Rows_examined: 19526
SET timestamp=1351033205;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:01:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.697067  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351033262;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.704753  Lock_time: 0.000117 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351033262;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 16:01:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.795618  Lock_time: 0.000105 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033264;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 16:01:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.681484  Lock_time: 0.000105 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033268;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 16:02:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 120.118073  Lock_time: 0.000124 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033335;
# Time: 121023 16:02:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.512825  Lock_time: 0.000133 Rows_sent: 6  Rows_examined: 926539
SET timestamp=1351033359;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.318249  Lock_time: 0.000215 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033359;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.342304  Lock_time: 0.000153 Rows_sent: 8  Rows_examined: 926539
SET timestamp=1351033359;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:02:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.829271  Lock_time: 0.000078 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033364;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 16:02:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.037269  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033366;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.101240  Lock_time: 0.000053 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351033366;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:02:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.257368  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351033369;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.515886  Lock_time: 0.000058 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351033369;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:02:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 169.868311  Lock_time: 0.000093 Rows_sent: 124  Rows_examined: 1043860
SET timestamp=1351033371;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:03:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.905608  Lock_time: 0.000102 Rows_sent: 10  Rows_examined: 2208
SET timestamp=1351033380;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 16:03:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 182.535139  Lock_time: 0.000142 Rows_sent: 468  Rows_examined: 1242853
SET timestamp=1351033384;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:03:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.410543  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8108942
SET timestamp=1351033389;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:03:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.344858  Lock_time: 0.000208 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033429;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.804702  Lock_time: 0.000149 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033429;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.730075  Lock_time: 0.000136 Rows_sent: 7  Rows_examined: 926539
SET timestamp=1351033429;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:03:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.077683  Lock_time: 0.000100 Rows_sent: 2994  Rows_examined: 269383
SET timestamp=1351033432;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023 16:03:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.869411  Lock_time: 0.000068 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033433;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.870084  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033433;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.950327  Lock_time: 0.000059 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351033433;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:04:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.926595  Lock_time: 0.000126 Rows_sent: 2119  Rows_examined: 32571
SET timestamp=1351033442;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,sessions.data,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-10-01' AND sessions.expire < '2012-10-24'   AND sessions.affiliate IN ('AdKnowledge');
# Time: 121023 16:04:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.746973  Lock_time: 0.000122 Rows_sent: 65260  Rows_examined: 1737522
SET timestamp=1351033448;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
# Time: 121023 16:05:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.657735  Lock_time: 0.000086 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351033521;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.217819  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926539
SET timestamp=1351033521;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.279575  Lock_time: 0.000130 Rows_sent: 6  Rows_examined: 926539
SET timestamp=1351033521;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.303302  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926540
SET timestamp=1351033521;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:05:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.462493  Lock_time: 0.000056 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351033527;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:05:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.619091  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351033530;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.905042  Lock_time: 0.000041 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351033530;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:05:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.293367  Lock_time: 0.000128 Rows_sent: 124  Rows_examined: 1043864
SET timestamp=1351033536;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:05:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.708423  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242857
SET timestamp=1351033538;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:05:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.831239  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8109012
SET timestamp=1351033544;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:06:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.997098  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926542
SET timestamp=1351033601;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.090075  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926542
SET timestamp=1351033601;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:06:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.187405  Lock_time: 0.000104 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033604;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.253036  Lock_time: 0.000105 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351033604;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:07:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.802552  Lock_time: 0.000119 Rows_sent: 124  Rows_examined: 1043867
SET timestamp=1351033623;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:07:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.348490  Lock_time: 0.000090 Rows_sent: 468  Rows_examined: 1242860
SET timestamp=1351033625;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:07:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.948652  Lock_time: 0.000145 Rows_sent: 7  Rows_examined: 926542
SET timestamp=1351033638;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:07:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.284794  Lock_time: 0.000085 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033641;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:08:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.118022  Lock_time: 0.000166 Rows_sent: 8  Rows_examined: 926544
SET timestamp=1351033685;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.139149  Lock_time: 0.000133 Rows_sent: 7  Rows_examined: 926544
SET timestamp=1351033685;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.017802  Lock_time: 0.000170 Rows_sent: 6  Rows_examined: 926543
SET timestamp=1351033685;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:08:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.632296  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033688;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 16:08:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.317709  Lock_time: 0.000090 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351033691;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:08:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.657026  Lock_time: 0.000105 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033692;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 16:08:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.587047  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351033693;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:08:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.783747  Lock_time: 0.000056 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351033694;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:08:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 214.241726  Lock_time: 0.000157 Rows_sent: 1493  Rows_examined: 6454867
SET timestamp=1351033715;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
# Time: 121023 16:09:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.547688  Lock_time: 0.000082 Rows_sent: 1  Rows_examined: 166390
SET timestamp=1351033766;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.last_name='grantham' ORDER BY sessions.sent_date DESC;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.604955  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 166390
SET timestamp=1351033766;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.last_name='grantham' ORDER BY sessions.sent_date DESC;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.993728  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 166390
SET timestamp=1351033766;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.last_name='grantham' ORDER BY sessions.sent_date DESC;
# Time: 121023 16:09:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.495639  Lock_time: 0.000176 Rows_sent: 5  Rows_examined: 2600
SET timestamp=1351033776;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:15:33' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:09:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.104852  Lock_time: 0.000123 Rows_sent: 124  Rows_examined: 1043869
SET timestamp=1351033778;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:09:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.967215  Lock_time: 0.000138 Rows_sent: 468  Rows_examined: 1242862
SET timestamp=1351033781;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:09:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.636296  Lock_time: 0.000124 Rows_sent: 10  Rows_examined: 4533
SET timestamp=1351033787;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.program_id=programs.id AND programs.allocation_id=316 AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 16:09:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.362502  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926545
SET timestamp=1351033797;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:10:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.657042  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033801;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:10:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.247107  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19536
SET timestamp=1351033805;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:10:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.123334  Lock_time: 0.000123 Rows_sent: 65545  Rows_examined: 195482
SET timestamp=1351033811;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,NULL,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-09-01' AND sessions.expire < '2012-10-24';
# Time: 121023 16:10:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.720440  Lock_time: 0.000107 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033836;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 16:10:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.490631  Lock_time: 0.000169 Rows_sent: 10  Rows_examined: 1039220
SET timestamp=1351033843;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.last_name='grantham' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.490659  Lock_time: 0.000148 Rows_sent: 10  Rows_examined: 1039220
SET timestamp=1351033843;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.last_name='grantham' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.490539  Lock_time: 0.000124 Rows_sent: 10  Rows_examined: 1039220
SET timestamp=1351033843;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.last_name='grantham' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 16:10:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.089080  Lock_time: 0.000088 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351033847;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.090181  Lock_time: 0.000120 Rows_sent: 0  Rows_examined: 29635
SET timestamp=1351033847;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 16:11:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.270406  Lock_time: 0.000146 Rows_sent: 10  Rows_examined: 4533
SET timestamp=1351033861;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.program_id=programs.id AND programs.allocation_id=316 AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 16:11:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 128.470475  Lock_time: 0.000192 Rows_sent: 7  Rows_examined: 926545
SET timestamp=1351033866;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.142363  Lock_time: 0.000144 Rows_sent: 7  Rows_examined: 926545
SET timestamp=1351033866;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:11:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.324821  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351033869;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.341565  Lock_time: 0.000108 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351033869;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:11:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.357314  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033880;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 16:11:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.559678  Lock_time: 0.000104 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351033883;
# Time: 121023 16:12:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.564597  Lock_time: 0.000155 Rows_sent: 7  Rows_examined: 926545
SET timestamp=1351033954;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 148.516561  Lock_time: 0.000165 Rows_sent: 6  Rows_examined: 926545
SET timestamp=1351033954;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 125.520747  Lock_time: 0.000161 Rows_sent: 8  Rows_examined: 926545
SET timestamp=1351033954;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:12:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.569326  Lock_time: 0.000051 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351033961;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:12:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.719749  Lock_time: 0.000086 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351033963;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.057346  Lock_time: 0.000195 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351033963;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:13:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.832565  Lock_time: 0.000123 Rows_sent: 5  Rows_examined: 2786
SET timestamp=1351033988;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:19:05' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:13:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.364249  Lock_time: 0.000069 Rows_sent: 15  Rows_examined: 1290
SET timestamp=1351033989;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:19:05' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:13:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 197.051086  Lock_time: 0.000115 Rows_sent: 124  Rows_examined: 1043505
SET timestamp=1351033998;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:13:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 199.287581  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242863
SET timestamp=1351034000;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:13:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 204.628608  Lock_time: 0.000170 Rows_sent: 16540  Rows_examined: 8109197
SET timestamp=1351034006;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.969857  Lock_time: 0.000078 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351034006;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 16:13:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.863591  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351034008;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 16:13:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.239781  Lock_time: 0.000159 Rows_sent: 7  Rows_examined: 926545
SET timestamp=1351034018;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.045945  Lock_time: 0.000158 Rows_sent: 7  Rows_examined: 926545
SET timestamp=1351034018;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.832745  Lock_time: 0.000175 Rows_sent: 7  Rows_examined: 926545
SET timestamp=1351034018;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:13:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.880881  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034021;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.884859  Lock_time: 0.000053 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034021;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.896595  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351034021;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:14:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.994757  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034064;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.937835  Lock_time: 0.000155 Rows_sent: 8  Rows_examined: 926546
SET timestamp=1351034064;
# Time: 121023 16:15:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.768175  Lock_time: 0.000084 Rows_sent: 1  Rows_examined: 29636
SET timestamp=1351034134;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 16:15:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.443966  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043506
SET timestamp=1351034152;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:15:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 112.467032  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242864
SET timestamp=1351034154;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:16:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.124599  Lock_time: 0.000131 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034169;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.231477  Lock_time: 0.000154 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034169;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:16:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.431688  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034172;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.448524  Lock_time: 0.000080 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351034172;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:16:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.164920  Lock_time: 0.000177 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034205;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:16:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.407425  Lock_time: 0.000089 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034209;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:16:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.275638  Lock_time: 0.000130 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351034212;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 16:17:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.296859  Lock_time: 0.000062 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351034248;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:32:23' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:17:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.512430  Lock_time: 0.000152 Rows_sent: 8  Rows_examined: 926546
SET timestamp=1351034259;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.579403  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034259;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.563138  Lock_time: 0.000139 Rows_sent: 6  Rows_examined: 926546
SET timestamp=1351034259;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:17:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.465944  Lock_time: 0.000075 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351034267;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:17:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.479398  Lock_time: 0.000034 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351034269;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.919517  Lock_time: 0.000076 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351034269;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:17:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.411841  Lock_time: 0.000158 Rows_sent: 124  Rows_examined: 1043506
SET timestamp=1351034271;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:17:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 112.523457  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242864
SET timestamp=1351034273;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:17:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.735466  Lock_time: 0.000172 Rows_sent: 16540  Rows_examined: 8109198
SET timestamp=1351034278;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:18:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.111909  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 19538
SET timestamp=1351034282;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:18:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.383001  Lock_time: 0.000105 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034333;
# Time: 121023 16:19:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.088120  Lock_time: 0.000142 Rows_sent: 124  Rows_examined: 1043508
SET timestamp=1351034352;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:19:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.927908  Lock_time: 0.000109 Rows_sent: 468  Rows_examined: 1242865
SET timestamp=1351034357;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.752455  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242866
SET timestamp=1351034357;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.106031  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242866
SET timestamp=1351034357;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:19:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.943223  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034361;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:19:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.984879  Lock_time: 0.000111 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034364;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.810545  Lock_time: 0.000069 Rows_sent: 0  Rows_examined: 19539
SET timestamp=1351034404;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:20:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.997632  Lock_time: 0.000176 Rows_sent: 6  Rows_examined: 926546
SET timestamp=1351034414;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:20:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.861912  Lock_time: 0.000088 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351034419;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:20:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.451151  Lock_time: 0.000080 Rows_sent: 1  Rows_examined: 29636
SET timestamp=1351034425;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.472724  Lock_time: 0.000136 Rows_sent: 1  Rows_examined: 29636
SET timestamp=1351034425;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 16:20:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.404305  Lock_time: 0.000188 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034445;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.358474  Lock_time: 0.000169 Rows_sent: 8  Rows_examined: 926546
SET timestamp=1351034445;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:20:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.513592  Lock_time: 0.000143 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351034454;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:20:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.209895  Lock_time: 0.000081 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351034455;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:21:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 386.606308  Lock_time: 0.000129 Rows_sent: 1493  Rows_examined: 6454884
SET timestamp=1351034487;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 16:21:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 158.204985  Lock_time: 0.000298 Rows_sent: 16540  Rows_examined: 8109260
SET timestamp=1351034499;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:21:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.293218  Lock_time: 0.000101 Rows_sent: 124  Rows_examined: 1043509
SET timestamp=1351034504;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:21:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.187490  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1242867
SET timestamp=1351034507;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:21:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.765707  Lock_time: 0.000133 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034511;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.663544  Lock_time: 0.000220 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034511;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:21:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.350718  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034515;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.358394  Lock_time: 0.000053 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351034515;
# Time: 121023 16:22:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.562643  Lock_time: 0.000204 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034542;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:22:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.318471  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034546;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:22:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.156733  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351034549;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-(SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0);
# Time: 121023 16:22:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.041203  Lock_time: 0.000152 Rows_sent: 5  Rows_examined: 2827
SET timestamp=1351034568;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:31:46' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:22:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.098021  Lock_time: 0.000075 Rows_sent: 15  Rows_examined: 1318
SET timestamp=1351034570;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:31:46' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:23:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.880005  Lock_time: 0.000177 Rows_sent: 8  Rows_examined: 926546
SET timestamp=1351034593;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.829084  Lock_time: 0.000168 Rows_sent: 6  Rows_examined: 926546
SET timestamp=1351034593;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:23:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.201563  Lock_time: 0.000119 Rows_sent: 124  Rows_examined: 1043509
SET timestamp=1351034599;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.202278  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242867
SET timestamp=1351034599;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:23:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.856328  Lock_time: 0.000089 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351034602;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:23:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.559824  Lock_time: 0.000174 Rows_sent: 16540  Rows_examined: 8109279
SET timestamp=1351034604;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:23:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.657865  Lock_time: 0.000090 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351034606;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:24:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.777453  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034640;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:24:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.741326  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19540
SET timestamp=1351034643;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:24:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.078568  Lock_time: 0.000086 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351034645;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:24:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 131.985689  Lock_time: 0.000155 Rows_sent: 65265  Rows_examined: 1737555
SET timestamp=1351034653;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 16:24:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.769870  Lock_time: 0.000130 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034696;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.412735  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034696;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:25:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.363129  Lock_time: 0.000074 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034700;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.377389  Lock_time: 0.000090 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351034700;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:25:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.069566  Lock_time: 0.000104 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351034734;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 16:25:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.269580  Lock_time: 0.000211 Rows_sent: 7  Rows_examined: 926546
SET timestamp=1351034738;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:25:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.954176  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034743;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:25:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.399986  Lock_time: 0.000131 Rows_sent: 124  Rows_examined: 1043510
SET timestamp=1351034748;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:25:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.349370  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1242868
SET timestamp=1351034749;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:26:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.073336  Lock_time: 0.000152 Rows_sent: 6  Rows_examined: 926547
SET timestamp=1351034773;
# Time: 121023 16:26:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.963349  Lock_time: 0.000121 Rows_sent: 124  Rows_examined: 1043516
SET timestamp=1351034802;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:26:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.250913  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242874
SET timestamp=1351034803;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:26:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.879592  Lock_time: 0.000175 Rows_sent: 16540  Rows_examined: 8109310
SET timestamp=1351034808;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:27:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.763466  Lock_time: 0.000174 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351034847;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:27:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.825684  Lock_time: 0.000138 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351034849;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:27:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.973063  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351034852;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.135018  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351034852;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:27:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 173.297696  Lock_time: 0.000137 Rows_sent: 1493  Rows_examined: 6454903
SET timestamp=1351034875;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 16:29:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.930652  Lock_time: 0.000136 Rows_sent: 7567  Rows_examined: 53320
SET timestamp=1351034946;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,sessions.data,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-09-01' AND sessions.expire < '2012-10-01'   AND sessions.affiliate IN ('educationmatch','silverback','sunrisetest','teleserve','windycity');
# Time: 121023 16:29:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.779620  Lock_time: 0.000093 Rows_sent: 124  Rows_examined: 1043517
SET timestamp=1351034982;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:29:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.133723  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242875
SET timestamp=1351034985;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:29:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.441403  Lock_time: 0.000223 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351034986;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.369122  Lock_time: 0.000222 Rows_sent: 8  Rows_examined: 926552
SET timestamp=1351034986;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:29:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.752159  Lock_time: 0.000215 Rows_sent: 16540  Rows_examined: 8109498
SET timestamp=1351034991;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:29:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.862282  Lock_time: 0.000076 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351034996;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:30:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.586913  Lock_time: 0.000083 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351035000;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:30:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.566174  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19547
SET timestamp=1351035004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:30:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.731837  Lock_time: 0.000102 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351035024;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.720014  Lock_time: 0.000087 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351035024;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 16:31:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.318938  Lock_time: 0.000150 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035062;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.141958  Lock_time: 0.000155 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035062;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:31:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.111085  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035065;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 16:31:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.557080  Lock_time: 0.000127 Rows_sent: 124  Rows_examined: 1043517
SET timestamp=1351035085;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:31:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.641402  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1242875
SET timestamp=1351035086;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.569667  Lock_time: 0.000076 Rows_sent: 0  Rows_examined: 19547
SET timestamp=1351035123;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:32:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.927680  Lock_time: 0.000173 Rows_sent: 3  Rows_examined: 30533
SET timestamp=1351035137;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 16:32:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.679979  Lock_time: 0.000169 Rows_sent: 8  Rows_examined: 926552
SET timestamp=1351035153;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.801414  Lock_time: 0.000171 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035153;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:32:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.511071  Lock_time: 0.000094 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351035157;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:32:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.216424  Lock_time: 0.000051 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351035159;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:33:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 141.664830  Lock_time: 0.000162 Rows_sent: 16540  Rows_examined: 8109498
SET timestamp=1351035203;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:33:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.376543  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035213;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.496784  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035213;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:33:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.512519  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035217;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.522715  Lock_time: 0.000046 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351035217;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:33:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.722026  Lock_time: 0.000089 Rows_sent: 124  Rows_examined: 1043517
SET timestamp=1351035223;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:33:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.611014  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242875
SET timestamp=1351035224;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:35:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.434253  Lock_time: 0.000163 Rows_sent: 8  Rows_examined: 926552
SET timestamp=1351035300;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.028298  Lock_time: 0.000169 Rows_sent: 6  Rows_examined: 926552
SET timestamp=1351035300;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:35:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.630841  Lock_time: 0.000078 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351035307;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:35:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.038170  Lock_time: 0.000039 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351035308;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:35:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.571120  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1043518
SET timestamp=1351035330;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:35:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.776510  Lock_time: 0.000118 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351035332;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.100858  Lock_time: 0.000119 Rows_sent: 468  Rows_examined: 1242876
SET timestamp=1351035332;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:35:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.610893  Lock_time: 0.000186 Rows_sent: 16540  Rows_examined: 8109499
SET timestamp=1351035338;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:36:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.178414  Lock_time: 0.000182 Rows_sent: 7603  Rows_examined: 56231
SET timestamp=1351035365;
# Time: 121023 16:36:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.473409  Lock_time: 0.000111 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035382;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:36:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.422024  Lock_time: 0.000092 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351035387;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:37:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.648712  Lock_time: 0.000201 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035423;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.776146  Lock_time: 0.000126 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035423;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.465968  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035423;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:37:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.121878  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035428;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.123381  Lock_time: 0.000044 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035428;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.140403  Lock_time: 0.000040 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351035428;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:37:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.926542  Lock_time: 0.000129 Rows_sent: 124  Rows_examined: 1043518
SET timestamp=1351035444;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:37:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.573813  Lock_time: 0.000087 Rows_sent: 468  Rows_examined: 1242876
SET timestamp=1351035446;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:38:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.285976  Lock_time: 0.000220 Rows_sent: 6  Rows_examined: 926552
SET timestamp=1351035488;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:38:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.150313  Lock_time: 0.000108 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351035492;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:38:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.147733  Lock_time: 0.000212 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035511;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.151009  Lock_time: 0.000134 Rows_sent: 8  Rows_examined: 926552
SET timestamp=1351035511;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:38:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.577110  Lock_time: 0.000092 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351035516;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:38:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.335375  Lock_time: 0.000079 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351035517;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:38:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.465053  Lock_time: 0.000287 Rows_sent: 16540  Rows_examined: 8109541
SET timestamp=1351035533;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:39:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 248.341643  Lock_time: 0.000179 Rows_sent: 1493  Rows_examined: 6454933
SET timestamp=1351035549;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 16:39:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.941635  Lock_time: 0.000097 Rows_sent: 124  Rows_examined: 1043518
SET timestamp=1351035584;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:39:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.799578  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1242876
SET timestamp=1351035585;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:39:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.618920  Lock_time: 0.000140 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035593;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.574512  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035593;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:39:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.156114  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035597;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.172870  Lock_time: 0.000046 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351035597;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.558906  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19548
# Time: 121023 16:40:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.476492  Lock_time: 0.000082 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351035639;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.483257  Lock_time: 0.000092 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351035639;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 16:40:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.410522  Lock_time: 0.000159 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035653;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:40:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.393183  Lock_time: 0.000213 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035656;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:41:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.581083  Lock_time: 0.000170 Rows_sent: 6  Rows_examined: 926552
SET timestamp=1351035690;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.561443  Lock_time: 0.000157 Rows_sent: 8  Rows_examined: 926552
SET timestamp=1351035690;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.613123  Lock_time: 0.000185 Rows_sent: 7  Rows_examined: 926552
SET timestamp=1351035690;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:41:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.839359  Lock_time: 0.000074 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351035697;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:41:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.956815  Lock_time: 0.000041 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351035698;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:41:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.342120  Lock_time: 0.000034 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351035699;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:41:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 115.257337  Lock_time: 0.000093 Rows_sent: 124  Rows_examined: 1043518
SET timestamp=1351035717;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:41:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.608744  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242876
SET timestamp=1351035718;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:42:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.522548  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19550
SET timestamp=1351035722;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:42:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.928863  Lock_time: 0.000281 Rows_sent: 16540  Rows_examined: 8109541
SET timestamp=1351035723;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:42:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.165827  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351035760;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.842516  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351035760;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:42:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.258774  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035763;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.271475  Lock_time: 0.000064 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351035763;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:43:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.442356  Lock_time: 0.000092 Rows_sent: 124  Rows_examined: 1043520
SET timestamp=1351035789;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.577071  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1242878
SET timestamp=1351035789;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:43:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.943916  Lock_time: 0.000144 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351035806;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:43:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.665459  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035810;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:43:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.059499  Lock_time: 0.000091 Rows_sent: 389  Rows_examined: 1097289
SET timestamp=1351035836;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 16:44:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.465397  Lock_time: 0.000115 Rows_sent: 65265  Rows_examined: 1737584
SET timestamp=1351035843;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 16:44:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.924524  Lock_time: 0.000182 Rows_sent: 8  Rows_examined: 926553
SET timestamp=1351035867;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.958051  Lock_time: 0.000214 Rows_sent: 6  Rows_examined: 926553
SET timestamp=1351035867;
# Time: 121023 16:45:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.182334  Lock_time: 0.000130 Rows_sent: 124  Rows_examined: 1043520
SET timestamp=1351035914;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:45:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.567859  Lock_time: 0.000104 Rows_sent: 10  Rows_examined: 2254
SET timestamp=1351035920;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 16:45:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.540850  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242878
SET timestamp=1351035924;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:45:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 148.346478  Lock_time: 0.000217 Rows_sent: 16540  Rows_examined: 8109621
SET timestamp=1351035929;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:45:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.093807  Lock_time: 0.000117 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351035935;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 16:45:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.485014  Lock_time: 0.000112 Rows_sent: 17  Rows_examined: 1410
SET timestamp=1351035945;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 15:42:43' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:46:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.185429  Lock_time: 0.000135 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351035967;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.111494  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351035967;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:46:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.488837  Lock_time: 0.000085 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351035971;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:46:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.500410  Lock_time: 0.000040 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351035972;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:46:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.579911  Lock_time: 0.000105 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036002;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:46:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.008089  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036005;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:47:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.226558  Lock_time: 0.000096 Rows_sent: 5  Rows_examined: 2683
SET timestamp=1351036048;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:32:23' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:47:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.107465  Lock_time: 0.000091 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351036049;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:32:23' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:47:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.919206  Lock_time: 0.000110 Rows_sent: 6  Rows_examined: 926553
SET timestamp=1351036054;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.584258  Lock_time: 0.000203 Rows_sent: 8  Rows_examined: 926553
SET timestamp=1351036054;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:47:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.865770  Lock_time: 0.000041 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351036059;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:47:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.123148  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351036061;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.626125  Lock_time: 0.000113 Rows_sent: 124  Rows_examined: 1043520
SET timestamp=1351036061;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:47:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.509005  Lock_time: 0.000092 Rows_sent: 17  Rows_examined: 1815
SET timestamp=1351036063;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:48:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.292071  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 19550
SET timestamp=1351036084;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:48:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.975794  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036091;
# Time: 121023 16:48:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 139.793109  Lock_time: 0.000071 Rows_sent: 468  Rows_examined: 1242878
SET timestamp=1351036100;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:48:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 144.037325  Lock_time: 0.000219 Rows_sent: 16540  Rows_examined: 8109621
SET timestamp=1351036105;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:48:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.370386  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 1142
SET timestamp=1351036121;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC;
# Time: 121023 16:49:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.338485  Lock_time: 0.000153 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036152;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.180743  Lock_time: 0.000130 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036152;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:49:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.509481  Lock_time: 0.000065 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036157;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.691889  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351036157;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:49:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.792609  Lock_time: 0.000159 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036178;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:49:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.372542  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036181;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:49:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 118.088115  Lock_time: 0.000130 Rows_sent: 124  Rows_examined: 1043520
SET timestamp=1351036199;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.237649  Lock_time: 0.000046 Rows_sent: 0  Rows_examined: 19551
SET timestamp=1351036204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:50:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.764565  Lock_time: 0.000064 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351036229;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.770058  Lock_time: 0.000087 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351036229;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 16:50:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.203838  Lock_time: 0.000173 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351036243;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:50:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.688317  Lock_time: 0.000165 Rows_sent: 6  Rows_examined: 926553
SET timestamp=1351036246;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:50:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.195782  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351036255;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:51:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.942143  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036267;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.687419  Lock_time: 0.000187 Rows_sent: 8  Rows_examined: 926553
SET timestamp=1351036267;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:51:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.060041  Lock_time: 0.000130 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351036272;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:51:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.067216  Lock_time: 0.000056 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351036274;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:51:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 148.957519  Lock_time: 0.000212 Rows_sent: 16540  Rows_examined: 8109621
SET timestamp=1351036290;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:51:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 112.580532  Lock_time: 0.000095 Rows_sent: 124  Rows_examined: 1043521
SET timestamp=1351036314;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:51:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 414.178452  Lock_time: 0.000134 Rows_sent: 1493  Rows_examined: 6454940
SET timestamp=1351036316;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 16:51:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.325564  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1242879
SET timestamp=1351036319;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
# Time: 121023 16:52:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.558804  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036338;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.690412  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036338;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:52:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.193450  Lock_time: 0.000142 Rows_sent: 3  Rows_examined: 30538
SET timestamp=1351036339;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 16:52:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.543245  Lock_time: 0.000041 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036342;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.575600  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351036342;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:53:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.075218  Lock_time: 0.000131 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036382;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:53:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.094202  Lock_time: 0.000068 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036385;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:53:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.340540  Lock_time: 0.000167 Rows_sent: 6  Rows_examined: 926553
SET timestamp=1351036416;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.412659  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036416;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.363466  Lock_time: 0.000149 Rows_sent: 8  Rows_examined: 926553
SET timestamp=1351036416;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:53:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.094328  Lock_time: 0.000062 Rows_sent: 17  Rows_examined: 1815
SET timestamp=1351036423;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:53:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.638255  Lock_time: 0.000049 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351036424;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:53:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.893605  Lock_time: 0.000059 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351036425;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:53:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.277490  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351036426;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:54:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.858615  Lock_time: 0.000095 Rows_sent: 124  Rows_examined: 1043521
SET timestamp=1351036449;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:54:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 129.551600  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1242879
SET timestamp=1351036450;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:54:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.839921  Lock_time: 0.000214 Rows_sent: 16540  Rows_examined: 8109644
SET timestamp=1351036456;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:54:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.116449  Lock_time: 0.000141 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036490;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.388922  Lock_time: 0.000127 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036490;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.149296  Lock_time: 0.000195 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036490;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:54:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.888194  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036493;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.892274  Lock_time: 0.000083 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036493;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.903060  Lock_time: 0.000047 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351036493;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:55:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.156019  Lock_time: 0.000109 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351036526;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 16:56:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.941245  Lock_time: 0.000084 Rows_sent: 0  Rows_examined: 19552
SET timestamp=1351036564;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:56:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.444959  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036575;
# Time: 121023 16:56:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.217253  Lock_time: 0.000108 Rows_sent: 124  Rows_examined: 1043522
SET timestamp=1351036617;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:56:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.326186  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242880
SET timestamp=1351036618;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:57:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.485689  Lock_time: 0.000171 Rows_sent: 16540  Rows_examined: 8109674
SET timestamp=1351036624;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 16:57:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.787773  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036654;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:57:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.543570  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036657;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:58:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.178962  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19552
SET timestamp=1351036685;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 16:58:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.229378  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036692;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:58:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.070779  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351036699;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:58:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.234981  Lock_time: 0.000185 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036724;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:58:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.238712  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036729;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:59:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 270.541532  Lock_time: 0.000139 Rows_sent: 1493  Rows_examined: 6454948
SET timestamp=1351036772;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.413639  Lock_time: 0.000218 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036772;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.516481  Lock_time: 0.000130 Rows_sent: 6  Rows_examined: 926553
SET timestamp=1351036772;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.510294  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926553
SET timestamp=1351036772;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 16:59:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.564845  Lock_time: 0.000033 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351036779;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:59:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.617645  Lock_time: 0.000088 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351036781;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.996580  Lock_time: 0.000128 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351036781;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 16:59:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.574329  Lock_time: 0.000097 Rows_sent: 124  Rows_examined: 1043522
SET timestamp=1351036782;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 16:59:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.909332  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242880
SET timestamp=1351036784;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 16:59:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.927686  Lock_time: 0.000240 Rows_sent: 16540  Rows_examined: 8109674
SET timestamp=1351036790;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
# Time: 121023 17:00:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.830410  Lock_time: 0.000089 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351036856;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.834008  Lock_time: 0.000114 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351036856;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:01:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 118.414836  Lock_time: 0.000170 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036917;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.458523  Lock_time: 0.000114 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036917;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 134.658316  Lock_time: 0.000122 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036917;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:02:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.644860  Lock_time: 0.000072 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036920;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.644275  Lock_time: 0.000048 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351036920;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.733072  Lock_time: 0.000121 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351036920;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:02:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.301382  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926553
SET timestamp=1351036952;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.466420  Lock_time: 0.000158 Rows_sent: 6  Rows_examined: 926553
SET timestamp=1351036952;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.435270  Lock_time: 0.000210 Rows_sent: 8  Rows_examined: 926553
SET timestamp=1351036952;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:02:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.543736  Lock_time: 0.000086 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351036958;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:02:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.305798  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351036961;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.651822  Lock_time: 0.000051 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351036961;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 160.431381  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1043523
SET timestamp=1351036961;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:02:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 162.861270  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242881
SET timestamp=1351036964;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:02:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.322240  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8109707
SET timestamp=1351036970;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:03:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.115185  Lock_time: 0.000156 Rows_sent: 7  Rows_examined: 926555
SET timestamp=1351037019;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.606442  Lock_time: 0.000133 Rows_sent: 7  Rows_examined: 926554
SET timestamp=1351037019;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.528578  Lock_time: 0.000155 Rows_sent: 7  Rows_examined: 926555
SET timestamp=1351037019;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:03:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.364673  Lock_time: 0.000061 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037023;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.364742  Lock_time: 0.000102 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037023;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.393652  Lock_time: 0.000064 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351037023;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:03:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.797915  Lock_time: 0.000113 Rows_sent: 65265  Rows_examined: 1737593
SET timestamp=1351037025;
# Time: 121023 17:05:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.732055  Lock_time: 0.000130 Rows_sent: 6  Rows_examined: 926556
SET timestamp=1351037100;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.746958  Lock_time: 0.000168 Rows_sent: 8  Rows_examined: 926557
SET timestamp=1351037100;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:05:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.546149  Lock_time: 0.000067 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351037106;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:05:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.017954  Lock_time: 0.000082 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351037108;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:05:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.315997  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1043527
SET timestamp=1351037125;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:05:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.249406  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242885
SET timestamp=1351037128;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:05:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.116012  Lock_time: 0.000123 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351037130;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:05:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.435224  Lock_time: 0.000217 Rows_sent: 16540  Rows_examined: 8109817
SET timestamp=1351037133;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:06:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.380170  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 19558
SET timestamp=1351037163;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:06:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.957615  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926557
SET timestamp=1351037165;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:06:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.487269  Lock_time: 0.000087 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351037170;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:06:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.173222  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351037201;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.750439  Lock_time: 0.000065 Rows_sent: 389  Rows_examined: 1097297
SET timestamp=1351037201;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 17:06:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.834221  Lock_time: 0.000205 Rows_sent: 5  Rows_examined: 3020
SET timestamp=1351037211;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 15:54:48' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:07:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.768251  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926557
SET timestamp=1351037221;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.773547  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926557
SET timestamp=1351037221;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.006056  Lock_time: 0.000126 Rows_sent: 7  Rows_examined: 926557
SET timestamp=1351037221;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:07:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.077613  Lock_time: 0.000045 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037224;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.078738  Lock_time: 0.000048 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037224;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.092651  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351037224;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:07:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.834406  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043528
SET timestamp=1351037242;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:07:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.781526  Lock_time: 0.000219 Rows_sent: 6  Rows_examined: 926557
SET timestamp=1351037275;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 113.588373  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242886
SET timestamp=1351037275;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:08:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.456252  Lock_time: 0.000108 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351037284;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.231940  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19559
SET timestamp=1351037284;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:08:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.863086  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037309;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:08:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.128504  Lock_time: 0.000291 Rows_sent: 16540  Rows_examined: 8109856
SET timestamp=1351037338;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:09:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 244.173884  Lock_time: 0.000149 Rows_sent: 1493  Rows_examined: 6454966
SET timestamp=1351037346;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 17:09:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.179574  Lock_time: 0.000120 Rows_sent: 124  Rows_examined: 1043529
SET timestamp=1351037355;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:09:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.130092  Lock_time: 0.000170 Rows_sent: 468  Rows_examined: 1242887
SET timestamp=1351037356;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:09:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.396976  Lock_time: 0.000122 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037378;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.578978  Lock_time: 0.000180 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037378;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:09:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.568537  Lock_time: 0.000082 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037382;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.582559  Lock_time: 0.000076 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351037382;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.425331  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 19560
SET timestamp=1351037404;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:10:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.358305  Lock_time: 0.000119 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351037431;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.336618  Lock_time: 0.000078 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351037431;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:10:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.881531  Lock_time: 0.000174 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037454;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:10:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.260865  Lock_time: 0.000401 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037457;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:11:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.562072  Lock_time: 0.000198 Rows_sent: 8  Rows_examined: 926558
SET timestamp=1351037491;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.627031  Lock_time: 0.000180 Rows_sent: 6  Rows_examined: 926558
SET timestamp=1351037491;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.608251  Lock_time: 0.000171 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037491;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:11:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.516435  Lock_time: 0.000069 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351037498;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:11:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.624085  Lock_time: 0.000039 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351037500;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.909992  Lock_time: 0.000052 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351037500;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:11:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.324448  Lock_time: 0.000122 Rows_sent: 124  Rows_examined: 1043530
SET timestamp=1351037506;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:11:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 114.501487  Lock_time: 0.000111 Rows_sent: 468  Rows_examined: 1242888
SET timestamp=1351037516;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:12:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 119.768925  Lock_time: 0.000169 Rows_sent: 16540  Rows_examined: 8109928
SET timestamp=1351037521;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
# Time: 121023 17:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.468590  Lock_time: 0.034538 Rows_sent: 3  Rows_examined: 30551
SET timestamp=1351037536;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 17:13:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.595546  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037582;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.808267  Lock_time: 0.000148 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037582;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.299223  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037582;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:13:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.988311  Lock_time: 0.000056 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037585;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.988836  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037585;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.002907  Lock_time: 0.000073 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351037585;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:13:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.475271  Lock_time: 0.041473 Rows_sent: 124  Rows_examined: 1043530
SET timestamp=1351037619;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:13:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.705114  Lock_time: 0.036640 Rows_sent: 468  Rows_examined: 1242888
SET timestamp=1351037621;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:14:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.322992  Lock_time: 0.000163 Rows_sent: 6  Rows_examined: 926558
SET timestamp=1351037648;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:14:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.883955  Lock_time: 0.000106 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351037652;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:14:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.269898  Lock_time: 0.000207 Rows_sent: 8  Rows_examined: 926558
SET timestamp=1351037676;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.207828  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037676;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:14:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.509304  Lock_time: 0.000098 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351037681;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:14:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.727433  Lock_time: 0.000099 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351037683;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:15:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.351370  Lock_time: 0.000124 Rows_sent: 3  Rows_examined: 2848
SET timestamp=1351037706;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Colorado State University Global Campus'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Colorado State University Global Campus'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023 17:15:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.076277  Lock_time: 0.000072 Rows_sent: 18  Rows_examined: 1498
SET timestamp=1351037732;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:15:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.882492  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351037733;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:15:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.162525  Lock_time: 0.000142 Rows_sent: 124  Rows_examined: 1043531
SET timestamp=1351037749;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:15:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.197977  Lock_time: 0.000132 Rows_sent: 468  Rows_examined: 1242889
SET timestamp=1351037751;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:15:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 175.607905  Lock_time: 40.013701 Rows_sent: 16540  Rows_examined: 8109928
SET timestamp=1351037756;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:16:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.272344  Lock_time: 0.000070 Rows_sent: 0  Rows_examined: 19562
SET timestamp=1351037762;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.329729  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037762;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.419719  Lock_time: 0.000109 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037762;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:16:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.175695  Lock_time: 0.000101 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037765;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 17:16:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.470797  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926558
SET timestamp=1351037794;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:16:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.424459  Lock_time: 0.000089 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037799;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:17:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.366763  Lock_time: 0.000091 Rows_sent: 124  Rows_examined: 1043533
SET timestamp=1351037843;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:17:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.031600  Lock_time: 0.000144 Rows_sent: 6  Rows_examined: 926560
SET timestamp=1351037845;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.583371  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351037845;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.455805  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926560
SET timestamp=1351037845;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:17:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.554434  Lock_time: 0.000041 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351037852;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:17:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.502610  Lock_time: 0.000082 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351037854;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.872588  Lock_time: 0.000043 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351037854;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:17:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.774036  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242891
SET timestamp=1351037873;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:17:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 115.099090  Lock_time: 0.000171 Rows_sent: 16540  Rows_examined: 8109988
SET timestamp=1351037876;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:18:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.813607  Lock_time: 0.000096 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351037923;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.532856  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351037923;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:18:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.482149  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037926;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.498502  Lock_time: 0.000043 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351037926;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:19:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.755919  Lock_time: 0.000080 Rows_sent: 124  Rows_examined: 1043536
SET timestamp=1351037940;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:19:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.507083  Lock_time: 0.000084 Rows_sent: 468  Rows_examined: 1242894
SET timestamp=1351037946;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:19:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.290490  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351037964;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:19:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.033588  Lock_time: 0.000102 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351037967;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:19:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.209821  Lock_time: 0.000078 Rows_sent: 17  Rows_examined: 1453
SET timestamp=1351037974;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime >= '2012-10-23' AND interest.datetime < '2012-10-23 16:19:32' GROUP BY interest.affiliate;
# Time: 121023 17:19:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 278.052083  Lock_time: 0.000118 Rows_sent: 1493  Rows_examined: 6454970
SET timestamp=1351037979;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 17:19:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.356259  Lock_time: 0.000106 Rows_sent: 2994  Rows_examined: 269386
SET timestamp=1351037987;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023 17:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.181275  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19563
SET timestamp=1351038004;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:20:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.909114  Lock_time: 0.000082 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351038029;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.922285  Lock_time: 0.000126 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351038029;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 17:20:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.857620  Lock_time: 0.000161 Rows_sent: 6  Rows_examined: 926560
SET timestamp=1351038039;
# Time: 121023 17:21:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.073652  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038071;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.252715  Lock_time: 0.000178 Rows_sent: 8  Rows_examined: 926560
SET timestamp=1351038071;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:21:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.176628  Lock_time: 0.000051 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351038076;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:21:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.040202  Lock_time: 0.000094 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351038078;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:21:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 114.953445  Lock_time: 0.000110 Rows_sent: 124  Rows_examined: 1043536
SET timestamp=1351038116;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 115.096938  Lock_time: 0.000090 Rows_sent: 468  Rows_examined: 1242894
SET timestamp=1351038116;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:22:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 179.788333  Lock_time: 0.000210 Rows_sent: 16540  Rows_examined: 8110061
SET timestamp=1351038121;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:22:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.170927  Lock_time: 0.000040 Rows_sent: 0  Rows_examined: 19563
SET timestamp=1351038124;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:22:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.849001  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038125;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.905359  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038125;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:22:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.689751  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351038129;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.703200  Lock_time: 0.000103 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351038129;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:22:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.622810  Lock_time: 0.000154 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038162;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:22:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.484885  Lock_time: 0.000076 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351038165;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:23:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.470825  Lock_time: 0.000168 Rows_sent: 6  Rows_examined: 926560
SET timestamp=1351038204;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.405116  Lock_time: 0.000164 Rows_sent: 8  Rows_examined: 926560
SET timestamp=1351038204;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.594859  Lock_time: 0.102758 Rows_sent: 124  Rows_examined: 1043536
SET timestamp=1351038204;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:23:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.874918  Lock_time: 0.106529 Rows_sent: 468  Rows_examined: 1242894
SET timestamp=1351038205;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:23:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.757767  Lock_time: 0.000069 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351038209;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:23:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.808161  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351038210;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:24:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.108657  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038243;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:24:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.114309  Lock_time: 0.000102 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351038250;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:24:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 130.907359  Lock_time: 0.105226 Rows_sent: 65266  Rows_examined: 1737628
SET timestamp=1351038252;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 17:24:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.100833  Lock_time: 0.000202 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038296;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.190516  Lock_time: 0.000136 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038296;
# Time: 121023 17:25:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.886736  Lock_time: 0.000082 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351038328;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:25:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.923463  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038335;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:25:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.140812  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351038341;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:25:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.729739  Lock_time: 10.754135 Rows_sent: 124  Rows_examined: 1043536
SET timestamp=1351038345;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:25:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.051030  Lock_time: 10.749411 Rows_sent: 468  Rows_examined: 1242894
SET timestamp=1351038348;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:25:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.117660  Lock_time: 56.232829 Rows_sent: 10  Rows_examined: 2280
SET timestamp=1351038350;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.187363  Lock_time: 65.302273 Rows_sent: 10  Rows_examined: 2280
SET timestamp=1351038350;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.679230  Lock_time: 60.793975 Rows_sent: 10  Rows_examined: 2280
SET timestamp=1351038350;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 17:26:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.368079  Lock_time: 0.000167 Rows_sent: 8  Rows_examined: 926560
SET timestamp=1351038388;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.379263  Lock_time: 0.000163 Rows_sent: 6  Rows_examined: 926560
SET timestamp=1351038388;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:26:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.898669  Lock_time: 0.000064 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351038393;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:26:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.784941  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351038394;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:27:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.510522  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926560
SET timestamp=1351038420;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:27:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.177907  Lock_time: 0.000070 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351038426;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:27:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.948348  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926561
SET timestamp=1351038472;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.878100  Lock_time: 0.000199 Rows_sent: 7  Rows_examined: 926561
SET timestamp=1351038472;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:27:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.186412  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351038475;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.194145  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351038475;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:28:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.301982  Lock_time: 0.000095 Rows_sent: 0  Rows_examined: 19564
SET timestamp=1351038488;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:28:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 200.036980  Lock_time: 46.827975 Rows_sent: 16540  Rows_examined: 8110061
SET timestamp=1351038501;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:28:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.259566  Lock_time: 0.000173 Rows_sent: 7  Rows_examined: 926561
SET timestamp=1351038511;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:28:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.887727  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351038515;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:29:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.457901  Lock_time: 0.000149 Rows_sent: 6  Rows_examined: 926561
SET timestamp=1351038573;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.502574  Lock_time: 0.000167 Rows_sent: 8  Rows_examined: 926561
SET timestamp=1351038573;
# Time: 121023 17:30:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.292466  Lock_time: 0.000116 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351038621;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.310114  Lock_time: 0.000101 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351038621;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 17:30:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.180909  Lock_time: 0.000198 Rows_sent: 7  Rows_examined: 926561
SET timestamp=1351038630;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:30:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.612487  Lock_time: 0.000096 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351038635;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:31:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 360.090925  Lock_time: 46.837024 Rows_sent: 1493  Rows_examined: 6454978
SET timestamp=1351038661;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 17:31:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.765707  Lock_time: 0.000144 Rows_sent: 7  Rows_examined: 926561
SET timestamp=1351038681;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.925677  Lock_time: 0.000111 Rows_sent: 7  Rows_examined: 926561
SET timestamp=1351038681;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.511821  Lock_time: 0.000178 Rows_sent: 7  Rows_examined: 926561
SET timestamp=1351038681;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:31:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.067642  Lock_time: 0.000049 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351038684;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.068116  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351038684;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.180648  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351038684;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:32:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.176923  Lock_time: 0.000184 Rows_sent: 6  Rows_examined: 926562
SET timestamp=1351038735;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:32:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.413880  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351038745;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:32:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 387.838979  Lock_time: 296.999114 Rows_sent: 124  Rows_examined: 1043537
SET timestamp=1351038749;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:32:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 388.725993  Lock_time: 296.999562 Rows_sent: 468  Rows_examined: 1242895
SET timestamp=1351038750;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:32:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.442414  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351038757;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.275814  Lock_time: 0.000156 Rows_sent: 8  Rows_examined: 926562
SET timestamp=1351038757;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:32:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.521780  Lock_time: 0.000072 Rows_sent: 17  Rows_examined: 1815
SET timestamp=1351038764;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-22 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:32:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.047438  Lock_time: 0.000037 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351038767;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:32:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.381556  Lock_time: 0.000064 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351038772;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:32:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.753651  Lock_time: 28.716476 Rows_sent: 3  Rows_examined: 30558
SET timestamp=1351038773;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 17:34:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.698808  Lock_time: 0.000130 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351038856;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.536505  Lock_time: 0.000203 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351038856;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.647247  Lock_time: 0.000142 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351038856;
# Time: 121023 17:35:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.926914  Lock_time: 0.000143 Rows_sent: 6  Rows_examined: 926562
SET timestamp=1351038913;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:35:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.097955  Lock_time: 0.000068 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351038917;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:35:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.837306  Lock_time: 0.000122 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351038928;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:35:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 276.945208  Lock_time: 88.457072 Rows_sent: 16540  Rows_examined: 8110101
SET timestamp=1351038938;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:35:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.111790  Lock_time: 0.000129 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351038943;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:36:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.131735  Lock_time: 0.000101 Rows_sent: 0  Rows_examined: 19564
SET timestamp=1351038962;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:36:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.029305  Lock_time: 0.000091 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351038968;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.953585  Lock_time: 0.000112 Rows_sent: 8  Rows_examined: 926562
SET timestamp=1351038968;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:36:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.933398  Lock_time: 0.000039 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351038973;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:36:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.790493  Lock_time: 0.000083 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351038974;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:37:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.914638  Lock_time: 0.000152 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039030;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.227320  Lock_time: 0.000120 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039030;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:37:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.288468  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039033;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.411650  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351039033;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:37:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 214.898711  Lock_time: 97.125767 Rows_sent: 124  Rows_examined: 1043540
SET timestamp=1351039056;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 215.644273  Lock_time: 97.125061 Rows_sent: 468  Rows_examined: 1242898
SET timestamp=1351039056;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:37:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.146102  Lock_time: 0.000147 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039058;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:37:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.395684  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039062;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:38:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.542920  Lock_time: 0.000050 Rows_sent: 0  Rows_examined: 19564
SET timestamp=1351039083;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:38:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.920762  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926562
SET timestamp=1351039112;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.829265  Lock_time: 0.000164 Rows_sent: 6  Rows_examined: 926562
SET timestamp=1351039112;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:38:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.840465  Lock_time: 0.000075 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351039117;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:38:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.072075  Lock_time: 0.000125 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351039118;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:39:19
# Time: 121023 17:40:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.275140  Lock_time: 0.000145 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039200;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.760518  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039200;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.323845  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039200;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:40:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.190914  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19564
SET timestamp=1351039204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.837614  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039204;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.837976  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039204;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.846103  Lock_time: 0.000060 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351039204;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:40:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.704760  Lock_time: 0.000150 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351039223;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.695194  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351039223;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:41:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 377.863391  Lock_time: 37.184850 Rows_sent: 1493  Rows_examined: 6454992
SET timestamp=1351039279;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 17:41:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.585634  Lock_time: 0.000168 Rows_sent: 8  Rows_examined: 926562
SET timestamp=1351039289;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.668360  Lock_time: 0.000168 Rows_sent: 6  Rows_examined: 926562
SET timestamp=1351039289;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:41:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.180891  Lock_time: 0.000106 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351039295;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:41:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.506346  Lock_time: 0.000056 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351039296;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:41:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.114122  Lock_time: 0.000127 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351039305;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:42:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.193762  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 19566
SET timestamp=1351039322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:42:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.434588  Lock_time: 0.000194 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039334;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:42:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.009461  Lock_time: 0.000284 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351039339;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:42:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.163069  Lock_time: 0.000112 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.602624  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.953614  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:42:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 293.461884  Lock_time: 182.627537 Rows_sent: 124  Rows_examined: 1043540
SET timestamp=1351039375;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:42:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.144745  Lock_time: 0.000064 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039376;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.145462  Lock_time: 0.000082 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039376;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.152971  Lock_time: 0.000038 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351039376;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:42:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 295.385670  Lock_time: 182.629396 Rows_sent: 468  Rows_examined: 1242898
SET timestamp=1351039377;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
# Time: 121023 17:43:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 360.958143  Lock_time: 242.871751 Rows_sent: 16540  Rows_examined: 8110141
SET timestamp=1351039382;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:44:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.603010  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926562
SET timestamp=1351039442;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.654735  Lock_time: 0.000167 Rows_sent: 6  Rows_examined: 926562
SET timestamp=1351039442;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:44:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.828773  Lock_time: 0.000043 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351039446;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:44:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.048604  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351039448;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:44:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.763586  Lock_time: 0.000215 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039483;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:44:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.317552  Lock_time: 0.000101 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351039487;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:44:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 167.010619  Lock_time: 61.010990 Rows_sent: 65266  Rows_examined: 1737646
SET timestamp=1351039488;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 17:45:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.459046  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351039519;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:46:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.311022  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 19566
SET timestamp=1351039564;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:46:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.502265  Lock_time: 0.000152 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039566;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.416858  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039566;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:46:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.248715  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039570;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.288861  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351039570;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:46:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 150.934335  Lock_time: 46.801355 Rows_sent: 124  Rows_examined: 1043542
SET timestamp=1351039592;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:46:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 153.763712  Lock_time: 46.806960 Rows_sent: 468  Rows_examined: 1242900
SET timestamp=1351039595;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:46:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.651474  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039603;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:46:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.304640  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039606;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:47:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.769726  Lock_time: 0.000184 Rows_sent: 6  Rows_examined: 926562
SET timestamp=1351039650;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.773555  Lock_time: 0.000164 Rows_sent: 8  Rows_examined: 926562
SET timestamp=1351039650;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:47:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.861846  Lock_time: 0.000108 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351039655;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:47:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.011596  Lock_time: 0.000108 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351039656;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:47:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.979202  Lock_time: 0.000102 Rows_sent: 24  Rows_examined: 20316
SET timestamp=1351039663;
SELECT DATE_FORMAT(date,'%H'),visitors FROM hits WHERE source='Facebook' AND DATE(date)='2012-10-21';
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.744624  Lock_time: 0.000140 Rows_sent: 6  Rows_examined: 3792
SET timestamp=1351039663;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-22 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:48:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.078011  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19566
SET timestamp=1351039682;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:48:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.929995  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039686;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:48:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.832616  Lock_time: 0.000073 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351039691;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:49:01
# Time: 121023 17:49:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 199.651958  Lock_time: 34.120450 Rows_sent: 16540  Rows_examined: 8110245
SET timestamp=1351039760;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:49:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.269878  Lock_time: 0.000207 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039784;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:49:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.541583  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039788;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:50:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.456136  Lock_time: 0.000159 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351039823;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.452563  Lock_time: 0.000083 Rows_sent: 0  Rows_examined: 29636
SET timestamp=1351039823;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:50:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.292479  Lock_time: 0.000204 Rows_sent: 8  Rows_examined: 926562
SET timestamp=1351039831;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.296989  Lock_time: 0.000148 Rows_sent: 6  Rows_examined: 926562
SET timestamp=1351039831;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.334197  Lock_time: 0.000171 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039831;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:50:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.625008  Lock_time: 0.000111 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351039838;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:50:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.703439  Lock_time: 0.000049 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351039839;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.056940  Lock_time: 0.000061 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351039839;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:51:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 386.561687  Lock_time: 94.128254 Rows_sent: 1493  Rows_examined: 6454998
SET timestamp=1351039887;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 17:51:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.104208  Lock_time: 0.000080 Rows_sent: 1  Rows_examined: 1160
SET timestamp=1351039895;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC;
# Time: 121023 17:51:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.878361  Lock_time: 0.000057 Rows_sent: 15  Rows_examined: 1162
SET timestamp=1351039897;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:15:33' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:52:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.709550  Lock_time: 0.000177 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039924;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.793921  Lock_time: 0.000223 Rows_sent: 7  Rows_examined: 926562
SET timestamp=1351039924;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:52:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.065353  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351039927;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.080060  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351039927;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:52:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 287.180232  Lock_time: 203.392908 Rows_sent: 124  Rows_examined: 1043542
SET timestamp=1351039968;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:52:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 291.872211  Lock_time: 203.392950 Rows_sent: 468  Rows_examined: 1242900
SET timestamp=1351039973;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:52:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.351155  Lock_time: 77.741805 Rows_sent: 10  Rows_examined: 2290
SET timestamp=1351039975;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.673479  Lock_time: 26.064241 Rows_sent: 10  Rows_examined: 2290
SET timestamp=1351039975;
# Time: 121023 17:53:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.996664  Lock_time: 51.420673 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351039990;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 17:53:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.146255  Lock_time: 0.000177 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351040010;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:53:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.105296  Lock_time: 0.000119 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351040015;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:54:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.609151  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351040042;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:54:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 112.158876  Lock_time: 0.000160 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351040061;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.228498  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040061;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:54:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.553484  Lock_time: 0.000099 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351040066;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:54:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.897295  Lock_time: 0.000099 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351040068;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:55:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.397364  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351040119;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 17:55:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.782429  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040120;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.911706  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040120;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:55:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.171317  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351040123;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.293414  Lock_time: 0.000054 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351040123;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:55:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 237.956647  Lock_time: 51.407644 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351040159;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 17:56:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.343204  Lock_time: 105.214003 Rows_sent: 10  Rows_examined: 2290
SET timestamp=1351040161;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 17:56:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.631019  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040175;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.636763  Lock_time: 0.000166 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351040175;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.653860  Lock_time: 0.000236 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351040175;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:56:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.877083  Lock_time: 0.000053 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351040184;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:56:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.850350  Lock_time: 0.000052 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351040185;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:56:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.672204  Lock_time: 0.000107 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351040186;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:57:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.769439  Lock_time: 0.000080 Rows_sent: 1  Rows_examined: 166389
SET timestamp=1351040245;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.disqualified='1' ORDER BY sessions.sent_date DESC;
# Time: 121023 17:57:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 205.626186  Lock_time: 118.411763 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351040246;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 17:57:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 207.664833  Lock_time: 118.410119 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351040248;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 17:58:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.125627  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351040284;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 17:58:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.363330  Lock_time: 0.000214 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040286;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:58:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 17:58:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.655973  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040322;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:58:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.148384  Lock_time: 0.000089 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351040325;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:59:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 274.783883  Lock_time: 58.472001 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351040375;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 17:59:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.780498  Lock_time: 0.000168 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351040380;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.681563  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351040380;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 17:59:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.884150  Lock_time: 0.000058 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351040385;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 17:59:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.206783  Lock_time: 0.000118 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351040386;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.151325  Lock_time: 0.000150 Rows_sent: 22  Rows_examined: 6482
SET timestamp=1351040404;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# Time: 121023 18:00:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.126272  Lock_time: 0.000080 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351040405;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:00:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.046163  Lock_time: 0.000090 Rows_sent: 5  Rows_examined: 3530
SET timestamp=1351040407;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Kaplan University C'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Kaplan University C'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# Time: 121023 18:00:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.390892  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351040426;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 18:00:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.452815  Lock_time: 0.000093 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351040436;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 18:01:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 178.044339  Lock_time: 90.866675 Rows_sent: 55  Rows_examined: 276864
SET timestamp=1351040460;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:01:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 181.493620  Lock_time: 90.866681 Rows_sent: 8  Rows_examined: 188004
SET timestamp=1351040463;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:01:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 183.485043  Lock_time: 90.814949 Rows_sent: 0  Rows_examined: 0
SET timestamp=1351040465;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:01:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.260002  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351040506;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.258316  Lock_time: 0.000078 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351040506;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:02:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.203274  Lock_time: 0.000128 Rows_sent: 10  Rows_examined: 2290
SET timestamp=1351040529;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.sent_date >= '2012-10-23' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 18:02:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.295556  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351040531;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:02:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 221.531731  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040546;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:02:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.059109  Lock_time: 0.000097 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351040554;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:02:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.350148  Lock_time: 0.000123 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351040574;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 18:02:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.675473  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351040577;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 18:04:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 399.732664  Lock_time: 127.926545 Rows_sent: 10  Rows_examined: 517989
SET timestamp=1351040644;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.disqualified='1' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 18:04:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.160779  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351040645;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:04:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.835925  Lock_time: 0.000095 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351040652;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 18:04:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 264.000752  Lock_time: 0.000149 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040679;
# Time: 121023 18:04:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.276266  Lock_time: 0.000084 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351040690;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:05:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.516192  Lock_time: 0.000117 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351040725;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:05:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 207.458455  Lock_time: 0.000134 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351040729;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:05:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 208.774695  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351040731;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:05:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.111059  Lock_time: 0.000145 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040744;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:05:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.084407  Lock_time: 0.000090 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351040748;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:05:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 228.104686  Lock_time: 0.000145 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351040750;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 18:06:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 152.450246  Lock_time: 0.000290 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351040795;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:06:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.754194  Lock_time: 0.000219 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040809;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:06:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.972589  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351040812;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:07:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.513036  Lock_time: 0.000099 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351040832;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:07:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.562520  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351040834;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:07:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.363052  Lock_time: 0.000176 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040835;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:07:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.148155  Lock_time: 0.000104 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351040838;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:08:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.879787  Lock_time: 0.000139 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351040891;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:08:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.159399  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351040896;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:08:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.389515  Lock_time: 0.000209 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040915;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.369262  Lock_time: 0.000162 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351040915;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:08:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.573502  Lock_time: 0.000091 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351040921;
# Time: 121023 18:08:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.517679  Lock_time: 0.000213 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351040922;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:08:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 220.088691  Lock_time: 0.000189 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351040923;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 18:08:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.742679  Lock_time: 0.000091 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351040924;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:09:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.853065  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351040972;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:09:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.413366  Lock_time: 0.000098 Rows_sent: 15  Rows_examined: 1162
SET timestamp=1351040978;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:15:33' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:09:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.460406  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351040979;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:09:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.204286  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040990;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.011633  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351040990;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:09:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.898880  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351040993;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.927342  Lock_time: 0.000101 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351040993;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:10:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.959567  Lock_time: 0.000094 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351041022;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.981440  Lock_time: 0.000095 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351041022;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:11:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.050582  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041073;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.177913  Lock_time: 0.000172 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351041073;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.267106  Lock_time: 0.000158 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351041073;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:11:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.556451  Lock_time: 0.000068 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351041080;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:11:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.663754  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351041082;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.016286  Lock_time: 0.000094 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351041082;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:11:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.044391  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351041087;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:11:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.004938  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351041088;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:11:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.376840  Lock_time: 0.000236 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351041094;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:12:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.421588  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351041123;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:12:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.299541  Lock_time: 0.000269 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351041148;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 18:13:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.073631  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041205;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:14:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.046388  Lock_time: 0.000128 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351041245;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:14:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.906978  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351041246;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:14:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.836893  Lock_time: 0.000210 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351041251;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:14:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.380393  Lock_time: 0.000137 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351041255;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:14:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.264084  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351041260;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:14:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.084262  Lock_time: 0.000169 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351041272;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.046086  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041272;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:14:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.219935  Lock_time: 0.000097 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351041276;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:14:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.816742  Lock_time: 0.000048 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351041278;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:15:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.465547  Lock_time: 0.000111 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351041326;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:16:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.119123  Lock_time: 0.000105 Rows_sent: 24  Rows_examined: 20316
SET timestamp=1351041364;
SELECT DATE_FORMAT(date,'%H'),visitors FROM hits WHERE source='Facebook' AND DATE(date)='2012-10-21';
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.725219  Lock_time: 0.000053 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351041364;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:16:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.656309  Lock_time: 0.000144 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041381;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 14:53:56' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.222548  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041381;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:16:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.297483  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351041384;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.421858  Lock_time: 0.000073 Rows_sent: 22  Rows_examined: 31198
SET timestamp=1351041384;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 14:53:56' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:17:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.209283  Lock_time: 0.000049 Rows_sent: 16  Rows_examined: 8426
SET timestamp=1351041426;
SELECT `date`,visitors FROM hits WHERE source='Reply' AND DATE(`date`)='2012-10-18';
# Time: 121023 18:17:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.289316  Lock_time: 0.000164 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351041430;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:17:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.925811  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351041434;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:17:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.540522  Lock_time: 0.000128 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351041439;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:17:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.007611  Lock_time: 0.000191 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041454;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.051474  Lock_time: 0.000142 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351041454;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:17:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.723848  Lock_time: 0.000079 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351041459;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:17:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.371450  Lock_time: 0.000076 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351041460;
# Time: 121023 18:17:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.648049  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351041464;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:17:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.612405  Lock_time: 0.000208 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351041469;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:18:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.812945  Lock_time: 0.000108 Rows_sent: 15  Rows_examined: 1162
SET timestamp=1351041519;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:15:33' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:18:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.883187  Lock_time: 0.000107 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351041521;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:18:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.537516  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351041522;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:18:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.119818  Lock_time: 0.000172 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041538;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:19:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 240.853230  Lock_time: 0.000179 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351041541;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 18:19:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.961849  Lock_time: 0.000120 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351041542;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:19:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.124752  Lock_time: 0.000169 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351041597;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.875209  Lock_time: 0.000172 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351041597;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:20:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.415467  Lock_time: 0.000055 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351041602;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:20:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.338974  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351041605;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:20:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.459811  Lock_time: 0.000080 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351041608;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:20:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.108992  Lock_time: 0.000059 Rows_sent: 7273  Rows_examined: 13179
SET timestamp=1351041613;
SELECT data FROM interest WHERE `datetime` > NOW() - INTERVAL 10 DAY AND submit=1 AND data <> "";
# Time: 121023 18:20:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.270143  Lock_time: 0.000111 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351041634;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.295203  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351041634;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:20:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.481382  Lock_time: 0.000171 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041647;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:20:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.054631  Lock_time: 0.000077 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351041651;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:21:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 124.363506  Lock_time: 0.000214 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351041666;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:21:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.168999  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351041690;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:21:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.419246  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351041698;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:21:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.852139  Lock_time: 0.000190 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041717;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:22:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.601669  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351041720;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:23:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.591447  Lock_time: 0.000160 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351041787;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.614866  Lock_time: 0.000119 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351041787;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
# Time: 121023 18:23:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.483853  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351041790;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.870022  Lock_time: 0.000080 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351041790;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:23:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.661971  Lock_time: 0.000178 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351041795;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:23:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.140745  Lock_time: 0.000130 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351041817;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.071909  Lock_time: 0.000211 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041817;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:23:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.730584  Lock_time: 0.000096 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351041822;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:23:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.084078  Lock_time: 0.000093 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351041824;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:23:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.926510  Lock_time: 0.000108 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351041828;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 18:24:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.894475  Lock_time: 0.000081 Rows_sent: 18  Rows_examined: 1502
SET timestamp=1351041893;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 17:21:48' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:25:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.184745  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041901;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:25:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.311461  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351041905;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:25:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.669532  Lock_time: 0.000135 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351041907;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:25:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.470478  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351041909;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:25:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.140442  Lock_time: 0.000072 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351041925;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:25:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.216830  Lock_time: 0.000154 Rows_sent: 5  Rows_examined: 3137
SET timestamp=1351041953;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:26:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.079991  Lock_time: 0.000102 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351041962;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:26:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.452255  Lock_time: 0.000134 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351041967;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.546917  Lock_time: 0.000239 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351041967;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:26:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.792736  Lock_time: 0.000094 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351041971;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:26:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.635221  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351041973;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:26:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.102851  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351041995;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:26:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.211257  Lock_time: 0.000099 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351041999;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:26:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.625519  Lock_time: 0.000095 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042011;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:26:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.830552  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042012;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:26:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.364415  Lock_time: 0.000171 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351042017;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
# Time: 121023 18:27:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.425383  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042075;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:27:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.744277  Lock_time: 0.000105 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351042078;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:28:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 185.906348  Lock_time: 0.000103 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351042087;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 18:29:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.917193  Lock_time: 0.000163 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351042147;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.006733  Lock_time: 0.000167 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351042147;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:29:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.107067  Lock_time: 0.000102 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351042152;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:29:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.133594  Lock_time: 0.000106 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351042153;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:29:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.048360  Lock_time: 0.000065 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042154;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:29:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.481953  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042163;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:29:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.821823  Lock_time: 0.000135 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351042168;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:29:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.448208  Lock_time: 0.000214 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042194;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:29:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.775840  Lock_time: 0.000082 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351042198;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.581013  Lock_time: 0.000158 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351042218;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.674093  Lock_time: 0.000118 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351042218;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:31:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.900049  Lock_time: 0.000200 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042278;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:31:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.975986  Lock_time: 0.000103 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351042281;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:31:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.889911  Lock_time: 0.000158 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042288;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:31:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.558995  Lock_time: 0.000158 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042289;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:32:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.677676  Lock_time: 0.000044 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351042323;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.187477  Lock_time: 0.000178 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351042336;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.146086  Lock_time: 0.000193 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351042336;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:32:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.556454  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351042342;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:33:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.330731  Lock_time: 0.000187 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351042380;
# Time: 121023 18:33:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 158.617247  Lock_time: 0.000213 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351042419;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:33:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.964896  Lock_time: 0.000084 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042432;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:33:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.588503  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042433;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:33:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.732625  Lock_time: 0.000158 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042438;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:34:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.620973  Lock_time: 0.000069 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351042441;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:35:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.735340  Lock_time: 0.000169 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351042505;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.765187  Lock_time: 0.000155 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351042505;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:35:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.055870  Lock_time: 0.000059 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351042511;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:35:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.016333  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351042512;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:35:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.118552  Lock_time: 0.000137 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042530;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:35:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.945902  Lock_time: 0.000090 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042533;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:35:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.407700  Lock_time: 0.000099 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351042534;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:35:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.242423  Lock_time: 0.000167 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351042538;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:35:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.150621  Lock_time: 0.000135 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042559;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:36:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.806929  Lock_time: 0.000082 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351042563;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.355889  Lock_time: 0.000100 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351042563;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:36:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.177012  Lock_time: 0.000188 Rows_sent: 5  Rows_examined: 2600
SET timestamp=1351042597;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:15:33' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:36:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.045925  Lock_time: 0.000085 Rows_sent: 18  Rows_examined: 1505
SET timestamp=1351042605;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 17:33:41' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:36:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.898219  Lock_time: 0.000095 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042612;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:36:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.974245  Lock_time: 0.000133 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042614;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.501548  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042614;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:36:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 18:37:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.082355  Lock_time: 0.000160 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351042676;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:38:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.813614  Lock_time: 0.000113 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351042680;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:38:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.905973  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351042686;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:38:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 206.781906  Lock_time: 0.000101 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351042707;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 18:38:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.020424  Lock_time: 0.000198 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351042709;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.020910  Lock_time: 0.000239 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042709;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:38:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.553293  Lock_time: 0.000100 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351042714;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:38:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.243428  Lock_time: 0.000071 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351042715;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:38:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.616057  Lock_time: 0.000225 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351042732;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:38:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.805857  Lock_time: 0.000165 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042737;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.995971  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042737;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:39:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.522990  Lock_time: 0.000124 Rows_sent: 15  Rows_examined: 1162
SET timestamp=1351042777;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:15:33' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:39:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.969228  Lock_time: 0.000145 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042799;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:40:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.906348  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351042802;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:40:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.544158  Lock_time: 0.000073 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351042803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:40:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.389088  Lock_time: 0.000110 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351042823;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.389200  Lock_time: 0.000102 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351042823;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 18:40:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.010986  Lock_time: 0.000101 Rows_sent: 2994  Rows_examined: 269389
SET timestamp=1351042852;
SELECT universities.name as university, schools.id, schools.name as school
				FROM schools
				JOIN universities ON (universities.id = schools.university_id) 
				JOIN programs ON (programs.school_id = schools.id)
				WHERE programs.online = 0
				GROUP BY schools.id
				ORDER BY schools.name;
# Time: 121023 18:41:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.008644  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042882;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.059100  Lock_time: 0.000269 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351042882;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.043692  Lock_time: 0.000180 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351042882;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:41:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.417786  Lock_time: 0.000060 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351042888;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:41:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.350555  Lock_time: 0.000083 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351042890;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:41:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.736760  Lock_time: 0.000098 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351042891;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:41:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.533246  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042896;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:41:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.417033  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042897;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:41:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 18:43:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.165449  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351042980;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:43:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.971562  Lock_time: 0.000083 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351042983;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:43:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.433654  Lock_time: 0.000095 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351042984;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.641346  Lock_time: 0.000165 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351042984;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:43:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.157529  Lock_time: 0.000191 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351043005;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 18:43:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.407401  Lock_time: 0.000146 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351043039;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:44:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.767754  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351043043;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:44:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.825197  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351043044;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:44:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.884740  Lock_time: 0.000192 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043077;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.794018  Lock_time: 0.000145 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351043077;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:44:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.389248  Lock_time: 0.000093 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351043081;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:44:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.035285  Lock_time: 0.000103 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351043083;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:45:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.726499  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043101;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.950643  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043101;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:45:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.114674  Lock_time: 0.000281 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351043103;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:45:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.484146  Lock_time: 0.000061 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351043113;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:46:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.036292  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351043162;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:46:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.365629  Lock_time: 0.000149 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043167;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:46:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.283400  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351043170;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:47:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.093231  Lock_time: 0.000108 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351043231;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.968518  Lock_time: 0.000159 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351043231;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.778929  Lock_time: 0.000131 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043231;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:47:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.079614  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043233;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
# Time: 121023 18:47:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.317239  Lock_time: 0.000196 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351043239;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:47:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.169626  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043274;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:47:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.925170  Lock_time: 0.000101 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351043278;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:48:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.097372  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351043282;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:48:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.034253  Lock_time: 0.000149 Rows_sent: 5  Rows_examined: 2600
SET timestamp=1351043316;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:15:33' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:48:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 225.698687  Lock_time: 0.000099 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351043326;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 18:48:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.680502  Lock_time: 0.000180 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043336;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:48:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.836701  Lock_time: 0.000305 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351043339;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:49:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.049099  Lock_time: 0.000103 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043344;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:49:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.938230  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043345;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:50:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.829842  Lock_time: 0.000168 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351043401;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.808396  Lock_time: 0.000174 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351043401;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:50:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.065467  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351043410;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:50:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.464792  Lock_time: 0.000052 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351043412;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:50:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.094249  Lock_time: 0.000063 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351043414;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:50:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.141283  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351043432;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.139397  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351043432;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:50:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.720577  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043446;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:50:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.296958  Lock_time: 0.000104 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351043450;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:50:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.017977  Lock_time: 0.000132 Rows_sent: 1747  Rows_examined: 33688
SET timestamp=1351043453;
SELECT sessions.id,sessions.affiliate,sessions.lead_price,sessions.affiliate_price,sessions.email,sessions.expire,sessions.sent_date,sessions.university,NULL,sessions.disqualified,sessions.reason,sessions.category,sessions.score,sessions.enrolled,sessions.applied,programs.name,programs.degree_type,allocations.name FROM sessions LEFT JOIN programs ON sessions.program_id=programs.id LEFT JOIN allocations ON programs.allocation_id=allocations.id WHERE sessions.sent=1 AND sessions.expire >='2012-10-01' AND sessions.expire < '2012-10-24'  AND sessions.university IN ('Strayer University Campus');
# Time: 121023 18:51:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 129.510732  Lock_time: 0.000209 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351043471;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:51:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.950425  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043478;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.141855  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043478;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
# Time: 121023 18:51:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.507713  Lock_time: 0.000159 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043517;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:51:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.615637  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351043519;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:52:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.016960  Lock_time: 0.000065 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351043523;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:52:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.491257  Lock_time: 0.000149 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351043538;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 18:53:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.619956  Lock_time: 0.000150 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043602;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.595531  Lock_time: 0.000174 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351043602;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.661302  Lock_time: 0.000207 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351043602;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:53:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.519773  Lock_time: 0.000057 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351043608;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:53:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.403930  Lock_time: 0.000071 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351043610;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.625706  Lock_time: 0.000092 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351043610;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:53:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.475317  Lock_time: 0.000120 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043619;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:53:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.405428  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043620;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:53:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.338049  Lock_time: 0.000200 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351043626;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:55:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.871887  Lock_time: 0.000150 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043703;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:55:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.522338  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351043707;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:55:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.068837  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351043721;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 18:55:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.178781  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043725;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:55:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.745597  Lock_time: 0.000082 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351043726;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 18:55:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.724526  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043728;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:56:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.298543  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351043762;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:56:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.666402  Lock_time: 0.000170 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351043771;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.605483  Lock_time: 0.000155 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351043771;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:56:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.255010  Lock_time: 0.000077 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351043776;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:56:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.551599  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351043777;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:56:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.174724  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043808;
# Time: 121023 18:57:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.272746  Lock_time: 0.000127 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043820;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:57:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.302179  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043821;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:57:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 125.416700  Lock_time: 0.000290 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351043826;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:58:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.121717  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043880;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:58:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.313866  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351043882;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 18:58:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.100425  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351043883;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:58:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 204.141843  Lock_time: 0.000122 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351043905;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 18:59:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.681842  Lock_time: 0.000172 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351043943;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:59:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.907780  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351043954;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:59:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.554830  Lock_time: 0.000093 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351043956;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 18:59:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.505081  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351043957;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 18:59:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.735083  Lock_time: 0.000238 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351043962;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 18:59:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.677410  Lock_time: 0.000163 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351043980;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.686191  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351043980;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 18:59:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.541516  Lock_time: 0.000078 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351043984;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 18:59:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.154227  Lock_time: 0.000078 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351043986;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:00:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.302418  Lock_time: 0.000114 Rows_sent: 22  Rows_examined: 6482
SET timestamp=1351044002;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# Time: 121023 19:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.813065  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351044003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:00:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.617240  Lock_time: 0.000125 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351044052;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.604399  Lock_time: 0.000112 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351044052;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:01:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.791540  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 198
SET timestamp=1351044083;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.university='ECPI University' ORDER BY sessions.sent_date DESC;
# Time: 121023 19:01:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.117230  Lock_time: 0.000136 Rows_sent: 10  Rows_examined: 12981
SET timestamp=1351044087;
SELECT SQL_CALC_FOUND_ROWS sessions.id,sessions.expire,sessions.sent_date,INET_NTOA(sessions.ip),sessions.university,sessions.`post`,sessions.`return`,sessions.affiliate,sessions.affiliate_price,sessions.lead_price,sessions.disqualified,sessions.reason,sessions.`data`,sessions.sub,sessions.enrolled,sessions.applied,sessions.phone,sessions.first_name,sessions.last_name,sessions.email,NULL,sessions.everify,null,null,sessions.sentby,programs.name,programs.degree_type,sessions.score FROM programs,sessions WHERE sessions.`sent`=1 AND programs.id=sessions.program_id  AND sessions.university='ECPI University' ORDER BY sessions.sent_date DESC LIMIT 0,10;
# Time: 121023 19:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.068522  Lock_time: 0.000077 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351044123;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:02:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.594431  Lock_time: 0.000099 Rows_sent: 1  Rows_examined: 198
SET timestamp=1351044132;
SELECT COUNT(1),SUM(IF(LEFT(reason,3)='***',1,0)) FROM sessions WHERE `sent`=1 AND `show`=1 AND `disqualified`=1 AND program_id!=0  AND sessions.university='ECPI University' AND sessions.sent_date >= '2012-10-01' ORDER BY sessions.sent_date DESC;
# Time: 121023 19:02:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.857780  Lock_time: 0.000287 Rows_sent: 10  Rows_examined: 5019
# Time: 121023 19:02:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 166.273037  Lock_time: 0.000122 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351044167;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:02:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 167.922728  Lock_time: 0.000202 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351044169;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:02:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.097167  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044171;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:02:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.934050  Lock_time: 0.000079 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351044175;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:02:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 114.669857  Lock_time: 0.000209 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351044176;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:03:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.643108  Lock_time: 0.000131 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351044212;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 19:03:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.523982  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044237;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:03:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.616800  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351044239;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:05:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.830098  Lock_time: 0.000166 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351044307;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:05:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.356581  Lock_time: 0.000111 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351044311;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:05:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.358131  Lock_time: 0.000105 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351044313;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.581683  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351044315;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:05:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.920652  Lock_time: 0.000175 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351044320;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:05:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.385172  Lock_time: 0.000116 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351044329;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:05:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.269242  Lock_time: 0.000156 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351044341;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.314115  Lock_time: 0.000202 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044341;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:05:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.373682  Lock_time: 0.000064 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351044346;
# Time: 121023 19:06:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.883656  Lock_time: 0.000070 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351044413;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.727526  Lock_time: 0.000103 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351044413;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:06:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.417122  Lock_time: 0.000168 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044414;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:06:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.082432  Lock_time: 0.000085 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351044417;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:07:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.789295  Lock_time: 0.000171 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351044479;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:08:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.062135  Lock_time: 0.000051 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351044484;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:08:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.780215  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351044486;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:08:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 206.054024  Lock_time: 0.000124 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351044507;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 19:08:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.701867  Lock_time: 0.000184 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044510;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.621538  Lock_time: 0.000167 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351044510;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:08:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.664542  Lock_time: 0.000097 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351044514;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:08:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.386888  Lock_time: 0.000076 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351044516;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:08:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 113.661701  Lock_time: 0.000208 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351044535;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:08:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.873399  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351044537;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:08:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.092601  Lock_time: 0.000128 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351044538;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:09:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.865451  Lock_time: 0.000152 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044599;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:10:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.639064  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351044602;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:10:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.256825  Lock_time: 0.000048 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351044603;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:10:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.729270  Lock_time: 0.000094 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351044624;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.716658  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351044624;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:11:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.055641  Lock_time: 0.000130 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044674;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.039806  Lock_time: 0.000164 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351044674;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.045531  Lock_time: 0.000225 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351044674;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:11:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.951902  Lock_time: 0.000047 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351044680;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:11:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.624403  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351044690;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.449483  Lock_time: 0.000143 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351044690;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:11:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.956019  Lock_time: 0.000167 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351044696;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:12:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.096209  Lock_time: 0.000067 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351044723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:12:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.040668  Lock_time: 0.000182 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351044738;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 19:13:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.047359  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044809;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:13:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.276517  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351044813;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:13:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.769999  Lock_time: 0.000128 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351044838;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:14:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 118.226202  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351044840;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:14:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.964046  Lock_time: 0.000180 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351044852;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:14:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.914098  Lock_time: 0.000092 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351044856;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:14:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.686708  Lock_time: 0.000178 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044881;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.538448  Lock_time: 0.000170 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351044881;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:14:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.476853  Lock_time: 0.000091 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351044885;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:14:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.095478  Lock_time: 0.000099 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351044887;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:15:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.859957  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351044906;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:15:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.207399  Lock_time: 0.000116 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351044907;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:15:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 130.827473  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351044912;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:15:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.564530  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351044914;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:16:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.595324  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351044966;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:16:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.923224  Lock_time: 0.000249 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351044969;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:16:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.015891  Lock_time: 0.000091 Rows_sent: 15  Rows_examined: 356
SET timestamp=1351045018;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 08:22:58' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:17:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.150968  Lock_time: 0.000151 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351045034;
# Time: 121023 19:17:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.644054  Lock_time: 0.000135 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045036;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:17:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.739551  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351045038;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.826193  Lock_time: 0.000119 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351045038;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:17:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.055396  Lock_time: 0.000212 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351045043;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:17:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.953221  Lock_time: 0.000148 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351045061;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.957224  Lock_time: 0.000151 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045061;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:17:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.973296  Lock_time: 0.000081 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351045066;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:17:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.905517  Lock_time: 0.000038 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351045068;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:18:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.393094  Lock_time: 0.000077 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351045082;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:18:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.914191  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045137;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 236.518521  Lock_time: 0.000125 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351045137;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 19:19:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.198556  Lock_time: 0.000086 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351045141;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:19:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.567133  Lock_time: 0.000111 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045143;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:19:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.688410  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351045145;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:20:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.172875  Lock_time: 0.000170 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351045200;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.178843  Lock_time: 0.000158 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351045200;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:20:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.205515  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351045204;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:20:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.064289  Lock_time: 0.000094 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351045206;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:20:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.212244  Lock_time: 0.000101 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351045207;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:20:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.110587  Lock_time: 0.000129 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351045227;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.100981  Lock_time: 0.000080 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351045227;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 19:20:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.137581  Lock_time: 0.000205 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045247;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:20:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.081959  Lock_time: 0.000115 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351045251;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:21:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 126.020988  Lock_time: 0.000203 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351045267;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:21:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.326258  Lock_time: 0.000091 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045275;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
# Time: 121023 19:21:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.905248  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045319;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:22:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.261471  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351045323;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.637638  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351045323;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:23:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.038790  Lock_time: 0.000173 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351045388;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:23:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.348122  Lock_time: 0.000099 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045391;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:23:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.937353  Lock_time: 0.000091 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351045392;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:23:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.341948  Lock_time: 0.000152 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351045393;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:23:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.638558  Lock_time: 0.000213 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351045399;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:23:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.405551  Lock_time: 0.000149 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351045409;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.302849  Lock_time: 0.000193 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045409;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:23:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.619398  Lock_time: 0.000109 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351045414;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:23:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.495445  Lock_time: 0.000051 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351045416;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:23:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.913072  Lock_time: 0.000134 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351045421;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 19:25:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.154287  Lock_time: 0.000147 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045501;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:25:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.717466  Lock_time: 0.000148 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045503;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:25:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.328353  Lock_time: 0.000127 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351045505;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:25:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.142842  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351045506;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:25:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.009780  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351045525;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:26:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.487781  Lock_time: 0.000121 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351045569;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.221294  Lock_time: 0.000165 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351045569;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:26:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.193116  Lock_time: 0.000066 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351045574;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:26:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.435987  Lock_time: 0.000080 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351045576;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:26:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.082416  Lock_time: 0.000162 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045595;
# Time: 121023 19:26:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.058332  Lock_time: 0.000110 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045611;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:26:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.232875  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351045612;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:26:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.630094  Lock_time: 0.000144 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351045617;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:27:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.156245  Lock_time: 0.000138 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045676;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:27:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.711608  Lock_time: 0.000082 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351045679;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:28:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 187.894677  Lock_time: 0.000087 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351045688;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 19:29:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.962992  Lock_time: 0.000142 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351045741;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.927825  Lock_time: 0.000162 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351045741;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:29:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.817620  Lock_time: 0.000050 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351045746;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:29:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.980118  Lock_time: 0.000093 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351045747;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:29:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.821394  Lock_time: 0.000129 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045749;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:29:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.808384  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351045759;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:29:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.036492  Lock_time: 0.000238 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351045764;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:29:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.130404  Lock_time: 0.000146 Rows_sent: 5  Rows_examined: 2683
SET timestamp=1351045769;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:32:23' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:29:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.426137  Lock_time: 0.000094 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351045772;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:32:23' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:29:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.748118  Lock_time: 0.000129 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045790;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:29:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.794155  Lock_time: 0.000119 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351045793;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.238167  Lock_time: 0.000097 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351045803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:30:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.403616  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351045819;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.385819  Lock_time: 0.000079 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351045819;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:31:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.609300  Lock_time: 0.000176 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045877;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:31:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.986630  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351045880;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:31:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.487945  Lock_time: 0.000116 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351045888;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
# Time: 121023 19:31:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.381556  Lock_time: 0.000124 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351045889;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:32:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.171215  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351045925;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:32:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 18.016923  Lock_time: 0.000164 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351045939;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 19:32:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.512555  Lock_time: 0.000138 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351045967;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:32:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.886121  Lock_time: 0.000141 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351045971;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:33:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.123963  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351045999;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.162335  Lock_time: 0.000124 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351045999;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:33:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.146063  Lock_time: 0.000060 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351046008;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:33:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.470331  Lock_time: 0.000084 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351046011;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:33:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 115.073600  Lock_time: 0.000097 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046036;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:34:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 120.431785  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046041;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:34:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 185.015107  Lock_time: 0.000261 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351046046;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:34:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.114352  Lock_time: 0.000195 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046049;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:34:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.986288  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351046054;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:35:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.163096  Lock_time: 0.000164 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351046103;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.152764  Lock_time: 0.000202 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351046103;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:35:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.077845  Lock_time: 0.000097 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351046108;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:35:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.332925  Lock_time: 0.000068 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351046110;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:35:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.555562  Lock_time: 0.000100 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046127;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:35:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.306749  Lock_time: 0.000121 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351046131;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:35:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.084546  Lock_time: 0.000166 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046156;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:36:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.968248  Lock_time: 0.000080 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351046160;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:36:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.775484  Lock_time: 0.000100 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046211;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:36:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.986573  Lock_time: 0.000135 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046212;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:36:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.454146  Lock_time: 0.000147 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046214;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:36:57
# Time: 121023 19:38:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.000427  Lock_time: 0.000146 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351046280;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:38:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.780814  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351046283;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:38:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.379009  Lock_time: 0.000078 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351046284;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:38:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 204.164926  Lock_time: 0.000172 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351046305;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 19:38:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.316573  Lock_time: 0.000117 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351046308;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:38:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.043439  Lock_time: 0.000079 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351046311;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:38:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 113.620233  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351046335;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:39:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.769453  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046340;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:39:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.078714  Lock_time: 0.000103 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351046344;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:39:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.391680  Lock_time: 0.000129 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046367;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.953799  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046367;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:40:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.428325  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046410;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:40:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.741162  Lock_time: 0.000131 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351046413;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:40:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.006570  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351046425;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.005171  Lock_time: 0.000103 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351046425;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:41:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.825038  Lock_time: 0.000141 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351046475;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.867375  Lock_time: 0.000175 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351046475;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 28.204278  Lock_time: 0.000110 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046475;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:41:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.018276  Lock_time: 0.000090 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351046481;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:41:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.152899  Lock_time: 0.000046 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351046483;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.491002  Lock_time: 0.000048 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351046483;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:41:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.104970  Lock_time: 0.000130 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046492;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.915919  Lock_time: 0.000132 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046492;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:41:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.240910  Lock_time: 0.000315 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351046498;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
# Time: 121023 19:42:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.559046  Lock_time: 0.000147 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046579;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:43:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.079619  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351046582;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:43:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.440944  Lock_time: 0.000100 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046584;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.552799  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046584;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:43:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.873481  Lock_time: 0.000202 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351046604;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 19:44:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.603469  Lock_time: 0.000180 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351046643;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:44:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.547108  Lock_time: 0.000083 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351046647;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:44:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.209052  Lock_time: 0.000162 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351046680;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.113118  Lock_time: 0.000200 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046680;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:44:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.560727  Lock_time: 0.000102 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351046685;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:44:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.243448  Lock_time: 0.000094 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351046687;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:45:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.282909  Lock_time: 0.000258 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351046704;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:45:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.752583  Lock_time: 0.000096 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046707;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.265361  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046707;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:45:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.821573  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351046714;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:46:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.102605  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351046762;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:46:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.874931  Lock_time: 0.000159 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046769;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:46:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.039268  Lock_time: 0.000097 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351046774;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:47:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.857828  Lock_time: 0.000138 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351046827;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.804492  Lock_time: 0.000120 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351046827;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:47:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.175848  Lock_time: 0.000097 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351046832;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:47:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.305949  Lock_time: 0.000105 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351046833;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:47:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.023660  Lock_time: 0.000140 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046840;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:47:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.578440  Lock_time: 0.000088 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046845;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:47:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.919403  Lock_time: 0.000173 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351046851;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
# Time: 121023 19:47:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.393960  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046869;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:47:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.944457  Lock_time: 0.000098 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351046873;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:48:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.141502  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351046882;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:48:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 234.776699  Lock_time: 0.000164 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351046936;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 19:48:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.598065  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351046938;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:49:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.312510  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351046941;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:49:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.623008  Lock_time: 0.000136 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351046943;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:49:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.445616  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351046944;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:50:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.693276  Lock_time: 0.000160 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351047001;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.687497  Lock_time: 0.000155 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351047001;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:50:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.164058  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351047005;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:50:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.397427  Lock_time: 0.000095 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351047013;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:50:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.682804  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351047014;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:50:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.437150  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351047034;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.435069  Lock_time: 0.000079 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351047034;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:50:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.783270  Lock_time: 0.000152 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047047;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:50:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.120998  Lock_time: 0.000092 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351047051;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:51:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 129.994985  Lock_time: 0.000154 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351047071;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:51:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.873484  Lock_time: 0.000114 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351047084;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:51:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.272001  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351047085;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:51:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.457609  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047117;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:52:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.665415  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351047120;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:52:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.059603  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351047123;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 19:52:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.030186  Lock_time: 0.000227 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351047138;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 19:53:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.793142  Lock_time: 0.000113 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351047206;
# Time: 121023 19:53:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.553193  Lock_time: 0.000100 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351047224;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:53:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 104.468356  Lock_time: 0.000090 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351047225;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:53:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.773674  Lock_time: 0.000230 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351047230;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:55:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.612748  Lock_time: 0.000159 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047302;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:55:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.249587  Lock_time: 0.000078 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351047305;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:55:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.213317  Lock_time: 0.000097 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351047319;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:55:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.301283  Lock_time: 0.000143 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351047321;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:55:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.930311  Lock_time: 0.000120 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351047326;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 19:55:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.656821  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351047332;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 19:56:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.510492  Lock_time: 0.000216 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351047373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.412973  Lock_time: 0.000173 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351047373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:56:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.916650  Lock_time: 0.000070 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351047378;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:56:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.265992  Lock_time: 0.000100 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351047379;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:56:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.629724  Lock_time: 0.000153 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047403;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:56:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.211236  Lock_time: 0.000083 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351047407;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:56:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.601223  Lock_time: 0.000128 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351047418;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:57:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 125.311953  Lock_time: 0.000175 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351047426;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:57:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.543773  Lock_time: 0.000069 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351047446;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:57:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.747678  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047479;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:58:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 19:58:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 215.111822  Lock_time: 0.000136 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351047516;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 19:58:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.185513  Lock_time: 0.000123 Rows_sent: 5  Rows_examined: 963
SET timestamp=1351047537;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 08:22:58' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:59:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.677144  Lock_time: 0.000138 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351047556;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:59:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.916730  Lock_time: 0.000100 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351047560;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:59:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.651983  Lock_time: 0.000144 Rows_sent: 5  Rows_examined: 2683
SET timestamp=1351047572;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:32:23' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:59:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.318291  Lock_time: 0.000094 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351047573;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:32:23' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:59:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.087335  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351047575;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 19:59:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.305919  Lock_time: 0.000088 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351047576;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 19:59:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.541015  Lock_time: 0.000190 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351047581;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 19:59:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.208832  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047584;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.667002  Lock_time: 0.000095 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351047584;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 19:59:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.317939  Lock_time: 0.000045 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351047589;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 19:59:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.910788  Lock_time: 0.000068 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351047590;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.064527  Lock_time: 0.000130 Rows_sent: 5  Rows_examined: 2362
SET timestamp=1351047603;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Campus Explorer : Grand Canyon University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Campus Explorer : Grand Canyon University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.387219  Lock_time: 0.000090 Rows_sent: 154  Rows_examined: 21036
SET timestamp=1351047603;
SELECT LOWER(stats_small.val),DATE_FORMAT(stats_small.datetime, '%Y-%m-%d %H:00:00') AS hr,COUNT(DISTINCT stats_small.session),SUBSTRING_INDEX(stats_small.host,'.',-2) AS domain FROM stats_small WHERE stats_small.name='utm_source' AND stats_small.datetime >= '2012-10-23' GROUP BY stats_small.val,hr,domain;
# Time: 121023 20:00:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.398708  Lock_time: 0.000174 Rows_sent: 22  Rows_examined: 6482
SET timestamp=1351047604;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.583886  Lock_time: 0.000057 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351047604;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:00:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.419032  Lock_time: 0.000174 Rows_sent: 5  Rows_examined: 3137
SET timestamp=1351047656;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 18:57:53' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:01:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.441761  Lock_time: 0.000126 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351047662;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.442049  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351047662;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.291895  Lock_time: 0.000042 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351047723;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:02:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.344618  Lock_time: 0.000166 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351047728;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 113.004739  Lock_time: 0.000136 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047728;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.408322  Lock_time: 0.000161 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351047728;
# Time: 121023 20:02:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.190509  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351047741;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:02:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 162.799167  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351047764;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:02:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 165.237036  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351047766;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:02:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.844442  Lock_time: 0.000210 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351047772;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:02:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.829840  Lock_time: 0.000167 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047774;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:02:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.362717  Lock_time: 0.000100 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351047778;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:03:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.078288  Lock_time: 0.000114 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351047822;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 20:03:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.667522  Lock_time: 0.000150 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047839;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:04:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.717041  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351047842;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:05:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.312771  Lock_time: 0.000142 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351047905;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.330815  Lock_time: 0.000213 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351047905;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:05:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.170113  Lock_time: 0.000070 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351047917;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:05:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.399743  Lock_time: 0.000115 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351047919;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:05:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.615188  Lock_time: 0.000095 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351047921;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:05:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.619661  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351047923;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:05:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.818737  Lock_time: 0.000128 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351047928;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.226807  Lock_time: 0.000114 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351047928;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:05:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.860974  Lock_time: 0.000179 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351047953;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:05:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.930427  Lock_time: 0.000080 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351047957;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:06:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.000501  Lock_time: 0.000099 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048011;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:06:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.904610  Lock_time: 0.000171 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048012;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:06:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.171002  Lock_time: 0.000160 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048014;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:06:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 20:08:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.218686  Lock_time: 0.000170 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351048087;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:08:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.382348  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351048092;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:08:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 201.479396  Lock_time: 0.000128 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351048103;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 20:08:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.333964  Lock_time: 0.000136 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048122;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.452026  Lock_time: 0.000228 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351048122;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:08:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.487106  Lock_time: 0.000068 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351048127;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:08:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.195201  Lock_time: 0.000097 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351048129;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:09:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 119.790390  Lock_time: 0.000211 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351048141;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:09:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.177148  Lock_time: 0.000101 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048167;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.578297  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048167;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:10:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.212599  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048203;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:10:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.348421  Lock_time: 0.000236 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351048207;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:10:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.232503  Lock_time: 0.000099 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351048223;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.229360  Lock_time: 0.000118 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351048223;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:11:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.105682  Lock_time: 0.000157 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351048274;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.292915  Lock_time: 0.000231 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351048274;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.310783  Lock_time: 0.000144 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048274;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:11:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.440021  Lock_time: 0.000095 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351048280;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:11:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.325821  Lock_time: 0.000103 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351048282;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:11:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.498849  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351048283;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:11:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.153532  Lock_time: 0.000101 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048290;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:11:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.642461  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048292;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:11:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.941624  Lock_time: 0.000217 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351048297;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
# Time: 121023 20:12:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.562966  Lock_time: 0.000235 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351048335;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 20:13:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.193099  Lock_time: 0.000126 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048399;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:13:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.040048  Lock_time: 0.000063 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351048402;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:13:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.580215  Lock_time: 0.000119 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048426;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:13:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.019028  Lock_time: 0.000117 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048428;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:14:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.812288  Lock_time: 0.000042 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351048444;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:14:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.812966  Lock_time: 0.000091 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351048446;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:14:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.897994  Lock_time: 0.000051 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351048450;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:14:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.087665  Lock_time: 0.000098 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048471;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.987910  Lock_time: 0.000127 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351048471;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:14:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.012888  Lock_time: 0.000045 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351048475;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:14:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.332171  Lock_time: 0.000053 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351048476;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:14:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.671686  Lock_time: 0.000087 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048499;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.921166  Lock_time: 0.000069 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048499;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:15:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.661530  Lock_time: 0.000143 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351048502;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:15:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.361083  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351048512;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:15:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.975206  Lock_time: 0.000106 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048559;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:16:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.581528  Lock_time: 0.000044 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351048562;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:16:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.208945  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351048563;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:16:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.733881  Lock_time: 0.000132 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351048614;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:16:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.613869  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351048617;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:17:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.015578  Lock_time: 0.000084 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048635;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:17:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.758650  Lock_time: 0.000080 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048639;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:17:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.075126  Lock_time: 0.000152 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351048645;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
# Time: 121023 20:17:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.827113  Lock_time: 0.000096 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351048648;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.814469  Lock_time: 0.000118 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048648;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:17:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.932689  Lock_time: 0.000055 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351048653;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:17:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.228026  Lock_time: 0.000058 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351048654;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:17:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 178.535077  Lock_time: 0.000090 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351048679;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 20:18:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.364791  Lock_time: 0.000037 Rows_sent: 1  Rows_examined: 256
SET timestamp=1351048725;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6003912172832' LIMIT 1;
# Time: 121023 20:19:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.897267  Lock_time: 0.000101 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048743;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:19:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.860351  Lock_time: 0.000080 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048745;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:19:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.639484  Lock_time: 0.000052 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351048746;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:19:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.886601  Lock_time: 0.000117 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048747;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:20:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.225996  Lock_time: 0.000046 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351048802;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:20:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.848114  Lock_time: 0.000119 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351048806;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.848295  Lock_time: 0.000104 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351048806;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:20:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.027263  Lock_time: 0.000051 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351048811;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:20:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.221438  Lock_time: 0.000051 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351048812;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:20:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.735219  Lock_time: 0.000099 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351048826;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.724064  Lock_time: 0.000064 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351048826;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 20:20:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.559812  Lock_time: 0.000126 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048847;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:20:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.695021  Lock_time: 0.000049 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351048850;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:21:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.909681  Lock_time: 0.000067 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048868;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.119775  Lock_time: 0.000071 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048868;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:21:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.588966  Lock_time: 0.000197 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351048869;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:21:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.774291  Lock_time: 0.000093 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351048916;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:21:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.369092  Lock_time: 0.000065 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351048918;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:23:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.889329  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351048985;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:23:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.808356  Lock_time: 0.000144 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351048986;
# Time: 121023 20:23:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.644089  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351048988;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:23:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.456958  Lock_time: 0.000056 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351048989;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:23:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.796436  Lock_time: 0.000185 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351048993;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:23:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.765955  Lock_time: 0.000096 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049008;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.665195  Lock_time: 0.000122 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351049008;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:23:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.087989  Lock_time: 0.000063 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351049012;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:23:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.640652  Lock_time: 0.000035 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351049013;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:23:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.934607  Lock_time: 0.000116 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351049014;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 20:25:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.686874  Lock_time: 0.000114 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049102;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:25:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.245433  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351049105;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:25:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.436584  Lock_time: 0.000090 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049109;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:25:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.569921  Lock_time: 0.000083 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049110;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:25:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 23.794044  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351049125;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:26:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.506376  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351049162;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:26:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.030666  Lock_time: 0.000131 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351049168;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.960097  Lock_time: 0.000128 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351049168;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:26:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.584429  Lock_time: 0.000054 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351049172;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:26:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.763645  Lock_time: 0.000064 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351049174;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:26:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.687214  Lock_time: 0.000120 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049201;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:26:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.981758  Lock_time: 0.000215 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351049205;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:26:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.017588  Lock_time: 0.000068 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049211;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:26:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.718463  Lock_time: 0.000250 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351049219;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:27:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.290782  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049242;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:27:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.465132  Lock_time: 0.000096 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049273;
# Time: 121023 20:28:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 202.648251  Lock_time: 0.000118 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351049304;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 20:29:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.339586  Lock_time: 0.000128 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351049348;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:29:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.667358  Lock_time: 0.000046 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351049352;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:29:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.875382  Lock_time: 0.000129 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049354;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:29:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.181955  Lock_time: 0.000159 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049363;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:29:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.359122  Lock_time: 0.000171 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351049368;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:29:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.513537  Lock_time: 0.000124 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.415841  Lock_time: 0.000129 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351049373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:29:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.906788  Lock_time: 0.000040 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351049377;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:29:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.270995  Lock_time: 0.000046 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351049379;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:30:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.999440  Lock_time: 0.000077 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351049418;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.016186  Lock_time: 0.000064 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351049418;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:31:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.010548  Lock_time: 0.000101 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049477;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:31:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.897929  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351049480;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:31:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.856824  Lock_time: 0.000073 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049488;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:31:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.569172  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049493;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:32:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.492255  Lock_time: 0.000102 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351049524;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:32:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.823563  Lock_time: 0.000037 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351049527;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:32:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.728104  Lock_time: 0.000098 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351049534;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:32:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.337856  Lock_time: 0.000121 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351049540;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 20:32:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.449990  Lock_time: 0.000121 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049567;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.273683  Lock_time: 0.000097 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351049567;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:32:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.002986  Lock_time: 0.000057 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351049571;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:32:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.440967  Lock_time: 0.000064 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351049572;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:33:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 20:33:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.190558  Lock_time: 0.000067 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049623;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:33:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 109.135925  Lock_time: 0.000064 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049630;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:33:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.950908  Lock_time: 0.000100 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049634;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:33:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.556733  Lock_time: 0.000053 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351049637;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:35:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.426483  Lock_time: 0.000127 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351049705;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.389599  Lock_time: 0.000143 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351049705;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:35:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.799566  Lock_time: 0.000058 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351049709;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:35:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.201270  Lock_time: 0.000041 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351049711;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:35:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.858198  Lock_time: 0.000076 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049718;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:35:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.904430  Lock_time: 0.000101 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049725;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:35:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.442567  Lock_time: 0.000137 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351049730;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:35:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 30.917539  Lock_time: 0.000056 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351049732;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:35:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.879477  Lock_time: 0.000105 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049757;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:36:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.508890  Lock_time: 0.000050 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351049760;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:36:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.039029  Lock_time: 0.000077 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049809;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:36:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.130349  Lock_time: 0.000065 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049810;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:36:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.708848  Lock_time: 0.000105 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351049812;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:36:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.596509  Lock_time: 0.000061 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351049815;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:38:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.511053  Lock_time: 0.000039 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351049888;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:38:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.346806  Lock_time: 0.000104 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351049889;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:38:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.303585  Lock_time: 0.000063 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351049893;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:38:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 197.873587  Lock_time: 0.000094 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351049899;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 20:38:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.009630  Lock_time: 0.000181 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351049918;
# Time: 121023 20:38:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 115.192696  Lock_time: 0.000153 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351049936;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:39:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.416668  Lock_time: 0.000088 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351049949;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:39:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.707405  Lock_time: 0.000066 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351049950;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:40:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.239901  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351050002;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.564056  Lock_time: 0.000100 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050002;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:40:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.035436  Lock_time: 0.000081 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351050005;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:40:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.420503  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351050023;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 22.425363  Lock_time: 0.000155 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351050023;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:41:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.028754  Lock_time: 0.000027 Rows_sent: 1  Rows_examined: 18394
SET timestamp=1351050078;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004202678832' LIMIT 1;
# Time: 121023 20:41:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.678077  Lock_time: 0.000115 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351050085;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.759393  Lock_time: 0.000148 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351050085;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:41:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.483554  Lock_time: 0.000049 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351050089;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:41:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.788946  Lock_time: 0.000051 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351050091;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:41:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.380454  Lock_time: 0.000059 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351050103;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 20:41:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 103.598896  Lock_time: 0.000134 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050104;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:41:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.465756  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050106;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:41:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.833009  Lock_time: 0.000212 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351050112;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:41:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.397145  Lock_time: 0.000123 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050117;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:42:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.748324  Lock_time: 0.000049 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351050121;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:42:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.232660  Lock_time: 0.000089 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050174;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.366440  Lock_time: 0.000105 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050174;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.257894  Lock_time: 0.000161 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050174;
# Time: 121023 20:43:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.260360  Lock_time: 0.000079 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351050195;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 20:43:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.031369  Lock_time: 0.000139 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351050234;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:43:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.639096  Lock_time: 0.000060 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351050238;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:44:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.074404  Lock_time: 0.000043 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351050245;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:44:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.403561  Lock_time: 0.000103 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050272;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.563105  Lock_time: 0.000142 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351050272;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:44:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.092386  Lock_time: 0.000048 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351050276;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:44:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.611761  Lock_time: 0.000049 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351050277;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:44:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.157745  Lock_time: 0.000186 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351050292;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:45:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.897280  Lock_time: 0.000085 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050308;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:45:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.543744  Lock_time: 0.000073 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050309;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:45:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 11.950067  Lock_time: 0.000067 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351050313;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:46:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.557488  Lock_time: 0.000095 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050368;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:46:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.745640  Lock_time: 0.000051 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351050371;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:47:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.047537  Lock_time: 0.000129 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351050424;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.009952  Lock_time: 0.000097 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351050424;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:47:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.434501  Lock_time: 0.000055 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351050428;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:47:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.585945  Lock_time: 0.000054 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351050430;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:47:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.002586  Lock_time: 0.000089 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050436;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:47:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.135985  Lock_time: 0.000107 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050437;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:47:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.459681  Lock_time: 0.000169 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351050443;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:47:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.315946  Lock_time: 0.000134 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050469;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:47:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.801582  Lock_time: 0.000048 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351050472;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:48:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 221.929318  Lock_time: 0.000156 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351050523;
# Time: 121023 20:48:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.798949  Lock_time: 0.000127 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050537;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:49:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.575106  Lock_time: 0.000062 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351050540;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:49:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.720718  Lock_time: 0.000107 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050542;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:49:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.657341  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050543;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:49:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.244460  Lock_time: 0.000030 Rows_sent: 1  Rows_examined: 11801
SET timestamp=1351050553;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004524622470' LIMIT 1;
# Time: 121023 20:50:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.044310  Lock_time: 0.000039 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351050602;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:50:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.403886  Lock_time: 0.000094 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351050609;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.489393  Lock_time: 0.000093 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351050609;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:50:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.023766  Lock_time: 0.000063 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351050614;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:50:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.273188  Lock_time: 0.000066 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351050615;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:50:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.076302  Lock_time: 0.000062 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351050632;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.069999  Lock_time: 0.000060 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351050632;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:50:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.756262  Lock_time: 0.000095 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050645;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:50:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.725308  Lock_time: 0.000219 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351050648;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:51:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 123.134510  Lock_time: 0.000151 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351050664;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:51:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.270576  Lock_time: 0.000077 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050678;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.624400  Lock_time: 0.000080 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050678;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:51:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.604029  Lock_time: 0.000033 Rows_sent: 1  Rows_examined: 22872
SET timestamp=1351050696;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004498716670' LIMIT 1;
# Time: 121023 20:51:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.384978  Lock_time: 0.000134 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050718;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:52:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.405299  Lock_time: 0.000047 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351050720;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:52:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.318955  Lock_time: 0.000038 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351050724;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:52:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.440934  Lock_time: 0.000134 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351050735;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 20:52:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.074699  Lock_time: 0.000078 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351050738;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 20:53:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.538074  Lock_time: 0.000132 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050795;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.298729  Lock_time: 0.000100 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351050795;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.534835  Lock_time: 0.000106 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351050795;
# Time: 121023 20:53:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.472179  Lock_time: 0.000068 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050812;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:53:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.239413  Lock_time: 0.000087 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050813;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:53:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.625549  Lock_time: 0.000159 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351050818;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:54:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.183642  Lock_time: 0.000097 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351050897;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:54:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.527616  Lock_time: 0.000050 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351050899;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:55:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.384011  Lock_time: 0.000084 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351050903;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:55:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.073778  Lock_time: 0.000072 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351050905;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:55:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.583824  Lock_time: 0.000024 Rows_sent: 1  Rows_examined: 15862
SET timestamp=1351050914;
SELECT 1 FROM compliance_ads WHERE id_type = 'pcrid' AND id_value = '6004372610581' LIMIT 1;
# Time: 121023 20:55:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.559073  Lock_time: 0.000087 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351050923;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 20:56:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.317010  Lock_time: 0.000042 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351050962;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 20:56:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.314900  Lock_time: 0.000097 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351050967;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.326278  Lock_time: 0.000139 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351050967;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:56:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.038087  Lock_time: 0.000049 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351050972;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:56:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.154600  Lock_time: 0.000057 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351050974;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:56:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.181158  Lock_time: 0.000131 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051000;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:56:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.886198  Lock_time: 0.000047 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351051004;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:57:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.008634  Lock_time: 0.000189 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351051023;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:57:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.834353  Lock_time: 0.000071 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351051024;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.053998  Lock_time: 0.000109 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051024;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:57:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 132.705424  Lock_time: 0.000130 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351051034;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 20:57:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.271138  Lock_time: 0.000097 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051078;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:58:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.657000  Lock_time: 0.000096 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351051081;
# Time: 121023 20:59:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.463711  Lock_time: 0.000166 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351051144;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.279991  Lock_time: 0.000176 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351051144;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:59:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.147260  Lock_time: 0.000086 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351051157;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:59:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.701007  Lock_time: 0.000046 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351051158;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:59:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.658445  Lock_time: 0.000093 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351051160;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 20:59:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 80.685237  Lock_time: 0.000129 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051161;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 20:59:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.979014  Lock_time: 0.000168 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351051167;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 20:59:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.463677  Lock_time: 0.000156 Rows_sent: 5  Rows_examined: 2683
SET timestamp=1351051168;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:32:23' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:59:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.764149  Lock_time: 0.000085 Rows_sent: 15  Rows_examined: 1204
SET timestamp=1351051172;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 13:32:23' AND interest.datetime >= '2012-10-23 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 20:59:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.293295  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051187;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 20:59:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.834274  Lock_time: 0.000080 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351051190;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.599789  Lock_time: 0.000117 Rows_sent: 22  Rows_examined: 6482
SET timestamp=1351051203;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.095598  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351051203;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:00:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.703779  Lock_time: 0.000077 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351051250;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='Campus Explorer') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'Campus Explorer%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 21:00:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.017485  Lock_time: 0.000121 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351051252;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.026904  Lock_time: 0.000146 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351051252;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:01:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 10.022958  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351051260;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 21:02:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.417997  Lock_time: 0.000210 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351051326;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.457917  Lock_time: 0.000180 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351051326;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 110.137874  Lock_time: 0.000131 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051326;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:02:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.835275  Lock_time: 0.000133 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351051332;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:02:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.412831  Lock_time: 0.000052 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351051333;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:02:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.945002  Lock_time: 0.000075 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351051334;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:02:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 159.262272  Lock_time: 0.000114 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351051361;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:02:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 161.416142  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051363;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:02:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 106.656921  Lock_time: 0.000307 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351051368;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
# Time: 121023 21:02:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.745956  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051372;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:02:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.283555  Lock_time: 0.000116 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351051376;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:03:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 92.905665  Lock_time: 0.000159 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351051414;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 21:03:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.376249  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051438;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:04:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.639751  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351051441;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:05:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.204625  Lock_time: 0.000139 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351051500;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:05:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.088096  Lock_time: 0.000110 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351051508;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:05:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.810703  Lock_time: 0.000107 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351051514;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:05:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.606482  Lock_time: 0.000087 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051515;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:05:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.887108  Lock_time: 0.000174 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351051521;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:05:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 27.114146  Lock_time: 0.000064 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351051528;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:05:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.441201  Lock_time: 0.000130 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351051543;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.134088  Lock_time: 0.000130 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051543;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:05:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.214874  Lock_time: 0.000096 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351051547;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:05:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.871360  Lock_time: 0.000055 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351051549;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:06:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.578068  Lock_time: 0.000104 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051600;
SELECT COUNT(DISTINCT sessions.id),allocations.allocation,allocations.id FROM allocations,programs LEFT JOIN sessions ON sessions.program_id=programs.id AND sessions.sent=1 AND sessions.`show`=1 AND sessions.disqualified=0 AND sessions.sent_date >='2012-10-01' WHERE programs.allocation_id=allocations.id GROUP BY allocations.id;
# Time: 121023 21:06:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.497589  Lock_time: 0.000213 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051613;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:06:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.997831  Lock_time: 0.000080 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351051616;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:07:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.451376  Lock_time: 0.000140 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351051622;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.140263  Lock_time: 0.000118 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051622;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:07:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 147.154238  Lock_time: 0.000119 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351051648;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 21:08:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.663515  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351051683;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:08:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.085243  Lock_time: 0.000211 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351051685;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.169867  Lock_time: 0.000162 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351051685;
# Time: 121023 21:08:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.267030  Lock_time: 0.000118 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051724;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:08:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.143872  Lock_time: 0.000085 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351051729;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:08:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.171999  Lock_time: 0.000196 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351051739;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:09:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.556110  Lock_time: 0.000107 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351051748;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.739058  Lock_time: 0.000070 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051748;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:10:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.850619  Lock_time: 0.000155 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051800;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:10:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.609794  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351051803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:10:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.334311  Lock_time: 0.000125 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351051804;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:10:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.230441  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351051822;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.244268  Lock_time: 0.000094 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351051822;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 21:11:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.301317  Lock_time: 0.000148 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351051874;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.169353  Lock_time: 0.000236 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351051874;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.238297  Lock_time: 0.000161 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351051874;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:11:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.559295  Lock_time: 0.000085 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351051881;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:11:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.774284  Lock_time: 0.000058 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351051883;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 9.035517  Lock_time: 0.000088 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351051883;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:11:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.153052  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351051889;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:11:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.148422  Lock_time: 0.000160 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351051890;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:11:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.849371  Lock_time: 0.000183 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351051896;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.125673  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351051922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:12:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.767680  Lock_time: 0.000196 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351051935;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 21:13:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.445660  Lock_time: 0.000146 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052009;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:13:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.504668  Lock_time: 0.000069 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351052012;
# Time: 121023 21:13:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 111.134333  Lock_time: 0.000092 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052032;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:13:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 114.351229  Lock_time: 0.000106 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052035;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:14:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.527482  Lock_time: 0.000163 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351052051;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:14:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.006247  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351052055;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:14:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.581773  Lock_time: 0.000128 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052083;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.196557  Lock_time: 0.000158 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351052083;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:14:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.454266  Lock_time: 0.000073 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351052088;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:14:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.298070  Lock_time: 0.000119 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351052090;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:15:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.297267  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351052115;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:15:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 141.530575  Lock_time: 0.000214 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351052123;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:15:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.538046  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052137;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:15:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.316948  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052138;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:16:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.821483  Lock_time: 0.000153 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052161;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:16:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.608925  Lock_time: 0.000059 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351052163;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:16:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.381310  Lock_time: 0.000094 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351052165;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:17:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.320196  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052222;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:17:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.630547  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052223;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:17:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.856984  Lock_time: 0.000176 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351052228;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:17:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.197460  Lock_time: 0.000124 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351052231;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:17:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.900314  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351052235;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:17:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.920215  Lock_time: 0.000183 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351052258;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.019815  Lock_time: 0.000148 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052258;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:17:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.218520  Lock_time: 0.000051 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351052262;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:17:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.036012  Lock_time: 0.000054 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351052264;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:18:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 215.412336  Lock_time: 0.000130 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351052316;
# Time: 121023 21:18:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 42.901539  Lock_time: 0.000179 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052338;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:19:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.862092  Lock_time: 0.000099 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351052341;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:19:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.437685  Lock_time: 0.000136 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052345;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.020692  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052345;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:19:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.602395  Lock_time: 0.000147 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351052395;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 25.961127  Lock_time: 0.000146 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351052395;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:20:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.941682  Lock_time: 0.000050 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351052400;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:20:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.933904  Lock_time: 0.000087 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351052401;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.196594  Lock_time: 0.000052 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351052403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:20:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.475084  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351052423;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 21.467272  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351052423;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 21:20:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.028652  Lock_time: 0.000143 Rows_sent: 5  Rows_examined: 2683
SET timestamp=1351052428;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 13:32:23' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:20:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.646322  Lock_time: 0.000143 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052442;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:20:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.111936  Lock_time: 0.000094 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351052446;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:21:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.617979  Lock_time: 0.000162 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351052464;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:21:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.697219  Lock_time: 0.000156 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052467;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.872820  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052467;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:21:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.649002  Lock_time: 0.000120 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052516;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:21:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.628890  Lock_time: 0.000122 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351052519;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:23:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.392501  Lock_time: 0.000120 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052587;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.170409  Lock_time: 0.000183 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351052587;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:23:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 70.241122  Lock_time: 0.000174 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052591;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.880749  Lock_time: 0.000108 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351052591;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:23:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.646177  Lock_time: 0.000192 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351052596;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
# Time: 121023 21:23:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.107959  Lock_time: 0.000118 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351052610;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.373942  Lock_time: 0.000197 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052610;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:23:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.403253  Lock_time: 0.000112 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351052616;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:23:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 7.094246  Lock_time: 0.000061 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351052618;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:23:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.577982  Lock_time: 0.000145 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351052620;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 21:24:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.459234  Lock_time: 0.000158 Rows_sent: 5  Rows_examined: 3137
SET timestamp=1351052697;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 18:57:53' AND sessions.sent_date >= '2012-10-23 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:25:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.831912  Lock_time: 0.000137 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052708;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:25:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.748538  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351052712;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:25:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.598386  Lock_time: 0.000097 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052720;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:25:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.924026  Lock_time: 0.000114 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052723;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:25:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 24.154578  Lock_time: 0.000128 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351052726;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:26:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.343809  Lock_time: 0.000208 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351052773;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.351250  Lock_time: 0.000134 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351052773;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:26:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.970587  Lock_time: 0.000096 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351052778;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:26:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.303326  Lock_time: 0.000064 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351052780;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:26:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.429275  Lock_time: 0.000183 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052801;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:26:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.213837  Lock_time: 0.000131 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351052805;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:27:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.783632  Lock_time: 0.000118 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052825;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.028973  Lock_time: 0.000139 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052825;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:27:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.318619  Lock_time: 0.000258 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351052829;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:27:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.631318  Lock_time: 0.000206 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052876;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:27:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.940624  Lock_time: 0.000078 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351052879;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:28:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 181.462173  Lock_time: 0.000155 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351052883;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 21:29:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.493381  Lock_time: 0.000147 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351052943;
# Time: 121023 21:29:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.880433  Lock_time: 0.000094 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351052950;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:29:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.429468  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351052953;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:29:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.099701  Lock_time: 0.000126 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351052958;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:29:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.279174  Lock_time: 0.000147 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351052999;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:30:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.220845  Lock_time: 0.000110 Rows_sent: 5  Rows_examined: 3662
SET timestamp=1351053005;
SELECT
    id,
    post,
    sent,
    reason,
    sent_date as `date`,
    disqualified,
    program_id,
    university
FROM
    sessions s
WHERE
    s.university = 'Marian University'
    AND s.sent_date >= NOW() - INTERVAL 1 DAY

UNION

SELECT
    id,
    data,
    0,
    reason,
    datetime as `date`,
    1,
    program_id,
    university
FROM
    reject r
WHERE
    r.university = 'Marian University'
    AND r.datetime >= NOW() - INTERVAL 1 DAY
ORDER BY
    date DESC
LIMIT 5;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.179340  Lock_time: 0.000051 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351053005;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:30:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.416919  Lock_time: 0.000121 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351053006;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:30:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.378810  Lock_time: 0.000142 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351053022;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 20.357804  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351053022;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:31:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.766240  Lock_time: 0.000154 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053081;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:31:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.069988  Lock_time: 0.000077 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351053084;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:31:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.255539  Lock_time: 0.000156 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053093;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:31:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 95.144024  Lock_time: 0.000147 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053096;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:32:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.070693  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351053124;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:32:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 17.060817  Lock_time: 0.000117 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351053139;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 21:32:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.873515  Lock_time: 0.000091 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351053149;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 21:32:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.038667  Lock_time: 0.000154 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351053159;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:32:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.606573  Lock_time: 0.000095 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351053164;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:33:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.259816  Lock_time: 0.000169 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053188;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.194867  Lock_time: 0.000216 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351053188;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:33:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.660031  Lock_time: 0.000098 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351053193;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:33:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 21:33:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.172043  Lock_time: 0.000078 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053229;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.182832  Lock_time: 0.000121 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053229;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:33:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 171.964057  Lock_time: 0.000287 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351053233;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:34:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.540205  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053245;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:34:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.297840  Lock_time: 0.000088 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351053248;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:35:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.842068  Lock_time: 0.000166 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351053314;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.965997  Lock_time: 0.000164 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351053314;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:35:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.027047  Lock_time: 0.000080 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351053319;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:35:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.574643  Lock_time: 0.000053 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351053321;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:35:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.352515  Lock_time: 0.000158 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053324;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:35:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.319059  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053326;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:35:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 26.617971  Lock_time: 0.000068 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351053327;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:35:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.541955  Lock_time: 0.000220 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351053331;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:36:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.524860  Lock_time: 0.000058 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351053363;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:36:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.834686  Lock_time: 0.000173 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053373;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:36:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.733944  Lock_time: 0.000086 Rows_sent: 389  Rows_examined: 1097308
SET timestamp=1351053377;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 21:36:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 5.162868  Lock_time: 0.000075 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351053378;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:37:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 76.758482  Lock_time: 0.000135 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053438;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:37:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.892232  Lock_time: 0.000074 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053440;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:37:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.530539  Lock_time: 0.000165 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053442;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:37:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.710423  Lock_time: 0.000079 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351053447;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:37:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.412225  Lock_time: 0.000099 Rows_sent: 389  Rows_examined: 1097308
SET timestamp=1351053472;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 21:38:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 3.883049  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351053485;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:38:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.618572  Lock_time: 0.000209 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351053504;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.756048  Lock_time: 0.000146 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351053504;
# Time: 121023 21:38:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 105.199765  Lock_time: 0.000208 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351053527;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:38:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 234.354889  Lock_time: 0.000142 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351053535;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 21:39:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.429927  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053549;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:39:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.175983  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053550;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:39:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.652559  Lock_time: 0.000140 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053597;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:40:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.618839  Lock_time: 0.000123 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351053600;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:40:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.088225  Lock_time: 0.000098 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351053602;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:40:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.316722  Lock_time: 0.000100 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351053620;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 19.304625  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351053620;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:41:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.314228  Lock_time: 0.000206 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351053675;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 29.441560  Lock_time: 0.000163 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053675;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.528903  Lock_time: 0.000163 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351053675;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:41:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.660905  Lock_time: 0.000084 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351053681;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:41:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.023659  Lock_time: 0.000089 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351053683;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 8.752372  Lock_time: 0.000091 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351053683;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:41:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 90.718469  Lock_time: 0.000110 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053691;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:41:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.724967  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053692;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:41:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.967876  Lock_time: 0.000233 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351053698;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:42:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 43.532011  Lock_time: 0.000170 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053779;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-23 00:00:00' AND sessions.sent_date >= '2012-10-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:43:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.927751  Lock_time: 0.000173 Rows_sent: 22  Rows_examined: 29883
SET timestamp=1351053782;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-23 00:00:00' AND interest.datetime >= '2012-10-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:43:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.669556  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053783;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
# Time: 121023 21:43:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.954044  Lock_time: 0.000084 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351053803;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 21:44:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.736299  Lock_time: 0.000165 Rows_sent: 6  Rows_examined: 926565
SET timestamp=1351053840;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-10-01 00:00:00' AND sessions.sent_date >= '2012-09-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:44:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.368083  Lock_time: 0.000042 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351053842;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:44:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.845914  Lock_time: 0.000100 Rows_sent: 22  Rows_examined: 38476
SET timestamp=1351053845;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-10-01 00:00:00' AND interest.datetime >= '2012-09-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:44:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.950602  Lock_time: 0.000163 Rows_sent: 8  Rows_examined: 926565
SET timestamp=1351053875;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-08-01 00:00:00' AND sessions.sent_date >= '2012-07-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.277976  Lock_time: 0.000164 Rows_sent: 7  Rows_examined: 926565
SET timestamp=1351053875;
SELECT referrals.source,COUNT(DISTINCT sessions.phone),COUNT(sessions.id),SUM(IF(sessions.disqualified=0,1,0)),SUM(sessions.lead_price),SUM(IF(sessions.disqualified=0,sessions.lead_price,0)),SUM(IF(sessions.disqualified=0,sessions.affiliate_price,0)) FROM referrals LEFT JOIN sessions ON sessions.`sent`=1 AND sessions.`show`=1 AND sessions.affiliate=referrals.source AND sessions.sent_date < '2012-09-01 00:00:00' AND sessions.sent_date >= '2012-08-01 00:00:00' WHERE referrals.active=1 AND sessions.university NOT LIKE 'Neutron Interactive%' GROUP BY referrals.source;
# Time: 121023 21:44:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 4.527566  Lock_time: 0.000033 Rows_sent: 19  Rows_examined: 26934
SET timestamp=1351053880;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-08-01 00:00:00' AND interest.datetime >= '2012-07-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:44:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 6.247031  Lock_time: 0.000094 Rows_sent: 26  Rows_examined: 39258
SET timestamp=1351053882;
SELECT interest.affiliate,COUNT(1) FROM interest WHERE interest.submit=0 AND interest.affiliate != '' AND interest.datetime < '2012-09-01 00:00:00' AND interest.datetime >= '2012-08-01 00:00:00' GROUP BY interest.affiliate;
# Time: 121023 21:45:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 118.784651  Lock_time: 0.000206 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351053900;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.577919  Lock_time: 0.000079 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053900;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:45:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.801470  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351053901;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:45:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.374834  Lock_time: 0.000104 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351053913;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:46:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.309688  Lock_time: 0.000139 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351053999;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:46:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.973631  Lock_time: 0.000157 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054000;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:46:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.292584  Lock_time: 0.000131 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351054003;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 21:46:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.695438  Lock_time: 0.000185 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351054005;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:48:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.555148  Lock_time: 0.000078 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351054082;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:48:30
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.751772  Lock_time: 0.000097 Rows_sent: 389  Rows_examined: 1097308
SET timestamp=1351054110;
SELECT university,MAX(sent_date),disqualified,enrolled FROM sessions WHERE (reason LIKE '***%' OR applied=1 OR enrolled=1) GROUP BY university,disqualified,enrolled;
# Time: 121023 21:49:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.983045  Lock_time: 0.000110 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351054160;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:49:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.939167  Lock_time: 0.000088 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054161;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:50:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.263788  Lock_time: 0.000071 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351054203;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:50:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.240113  Lock_time: 0.000125 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351054215;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.236133  Lock_time: 0.000059 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351054215;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
# Time: 121023 21:50:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 77.664711  Lock_time: 0.000290 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351054219;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:51:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.161755  Lock_time: 0.000154 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351054270;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:51:11
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.692720  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054271;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.140400  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351054322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 21:52:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.183957  Lock_time: 0.000096 Rows_sent: 1  Rows_examined: 0
SET timestamp=1351054332;
SELECT CAST((SELECT allocations.allocation FROM allocations WHERE allocations.name='College Bound') AS SIGNED)-CAST((SELECT COUNT(id) FROM sessions WHERE university LIKE 'College Bound%' AND sent_date>='2012-10-01 00:00:00' AND disqualified=0) AS SIGNED);
# Time: 121023 21:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.183450  Lock_time: 0.000245 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351054336;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 21:53:25
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.708204  Lock_time: 0.000167 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351054405;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.299030  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054405;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:53:31
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 89.650052  Lock_time: 0.000259 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351054411;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.374068  Lock_time: 0.000162 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351054489;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.901018  Lock_time: 0.000138 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054489;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:55:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.605853  Lock_time: 0.000093 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351054515;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 21:56:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.054678  Lock_time: 0.000209 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351054580;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 21:56:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.042662  Lock_time: 0.000134 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351054598;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:56:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 37.702551  Lock_time: 0.000100 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054599;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:56:44
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 102.477524  Lock_time: 0.000154 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351054604;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 21:58:47
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.552613  Lock_time: 0.000152 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351054727;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 21:58:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.236565  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054728;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 21:58:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.278976  Lock_time: 0.000185 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351054734;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.060724  Lock_time: 0.000060 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351054803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 2.107095  Lock_time: 0.000134 Rows_sent: 22  Rows_examined: 6482
SET timestamp=1351054803;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
# Time: 121023 22:00:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.560798  Lock_time: 0.000084 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351054851;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.568292  Lock_time: 0.000094 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351054851;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 22:02:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 121.009313  Lock_time: 0.000110 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351054922;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:02:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 122.305416  Lock_time: 0.000152 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351054923;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:02:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 66.920886  Lock_time: 0.000227 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351054928;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:02:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.524542  Lock_time: 0.000113 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351054971;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 22:05:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.975501  Lock_time: 0.000124 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055100;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:05:01
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 59.603329  Lock_time: 0.000123 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055101;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:05:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.207918  Lock_time: 0.000317 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351055106;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:05:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.235769  Lock_time: 0.000088 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351055113;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:06:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 23.125518  Lock_time: 0.000069 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055184;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:06:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 35.777017  Lock_time: 0.000112 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055196;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:06:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 107.042426  Lock_time: 0.000171 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351055208;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 22:08:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 62.062890  Lock_time: 0.000215 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351055283;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:08:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.441114  Lock_time: 0.000131 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055328;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.884168  Lock_time: 0.000073 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055328;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:10:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.126299  Lock_time: 0.000077 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351055403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 22:10:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.315434  Lock_time: 0.000126 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351055418;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.322935  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351055418;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:11:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 60.795076  Lock_time: 0.000171 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055462;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:11:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.379486  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055463;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
# Time: 121023 22:11:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.217923  Lock_time: 0.000187 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351055469;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.124578  Lock_time: 0.000062 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351055522;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 22:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.851137  Lock_time: 0.000177 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351055536;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 22:13:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 86.827186  Lock_time: 0.000130 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055608;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:13:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.599637  Lock_time: 0.000159 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055609;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:14:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.503481  Lock_time: 0.000209 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351055640;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:14:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.504422  Lock_time: 0.000134 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055696;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.031432  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055696;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:15:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.590569  Lock_time: 0.000081 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351055714;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:16:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.511483  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351055763;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 22:16:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.694298  Lock_time: 0.000096 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055795;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.310137  Lock_time: 0.000130 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055795;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:16:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 99.010742  Lock_time: 0.000134 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351055801;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.031592  Lock_time: 0.000189 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351055801;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:18:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.335951  Lock_time: 0.000145 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351055936;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:18:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 56.154018  Lock_time: 0.000109 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351055937;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:20:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.377272  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351056002;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 22:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.636520  Lock_time: 0.000205 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351056003;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:20:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.944478  Lock_time: 0.000097 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351056016;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.941290  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351056016;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:21:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Time: 121023 22:21:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.490636  Lock_time: 0.000073 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056067;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:22:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.156148  Lock_time: 0.000166 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056161;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:22:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.276923  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056162;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:22:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.422742  Lock_time: 0.000177 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351056169;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:22:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.107722  Lock_time: 0.000124 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351056174;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 22:24:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.847430  Lock_time: 0.000071 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056299;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.492623  Lock_time: 0.000139 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056299;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:25:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.566078  Lock_time: 0.000113 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351056315;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:26:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.817963  Lock_time: 0.000241 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351056386;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:26:39
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.220967  Lock_time: 0.000191 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056399;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:26:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.157868  Lock_time: 0.000119 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056400;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:26:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.271344  Lock_time: 0.000137 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351056402;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 22:28:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.699040  Lock_time: 0.000111 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056529;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:28:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.610529  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056530;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:28:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.905335  Lock_time: 0.000274 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351056535;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.007169  Lock_time: 0.000056 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351056603;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 22:30:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.555224  Lock_time: 0.000148 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351056616;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.538282  Lock_time: 0.000110 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351056616;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:31:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.932312  Lock_time: 0.000141 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056673;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:31:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.701199  Lock_time: 0.000134 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056674;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
# Time: 121023 22:32:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.618367  Lock_time: 0.000138 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351056736;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 22:32:28
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.686020  Lock_time: 0.000219 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351056748;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:33:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.220895  Lock_time: 0.000105 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056801;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.698773  Lock_time: 0.000097 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056801;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:34:46
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.008046  Lock_time: 0.000097 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056886;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 45.528144  Lock_time: 0.000120 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056886;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:34:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.506110  Lock_time: 0.000258 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351056892;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:35:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.695169  Lock_time: 0.000121 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351056914;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:36:32
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.609672  Lock_time: 0.000134 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351056992;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:36:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.308231  Lock_time: 0.000188 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351056993;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:36:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 93.749524  Lock_time: 0.000162 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351056995;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 22:38:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 67.264900  Lock_time: 0.000216 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351057088;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:38:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.488516  Lock_time: 0.000166 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351057130;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:38:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.937095  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351057131;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:40:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.831020  Lock_time: 0.000079 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351057216;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.839828  Lock_time: 0.000094 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351057216;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 22:41:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.387846  Lock_time: 0.000092 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351057269;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:41:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.002406  Lock_time: 0.000166 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351057270;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:41:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.796641  Lock_time: 0.000198 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351057275;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
# Time: 121023 22:42:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.512803  Lock_time: 0.000183 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351057362;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:42:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.740578  Lock_time: 0.000094 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351057363;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:42:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.248527  Lock_time: 0.000145 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351057375;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 22:44:24
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 83.563425  Lock_time: 0.000209 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351057464;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:44:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.744315  Lock_time: 0.000104 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351057494;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:44:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.267762  Lock_time: 0.000074 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351057495;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:45:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.417937  Lock_time: 0.000092 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351057513;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:46:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.214815  Lock_time: 0.000168 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351057593;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:46:34
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.837301  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351057594;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:46:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 97.210497  Lock_time: 0.000149 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351057598;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 22:46:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.694409  Lock_time: 0.000174 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351057600;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:48:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.545353  Lock_time: 0.000102 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351057731;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:48:52
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.264100  Lock_time: 0.000141 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351057732;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:50:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.138920  Lock_time: 0.000044 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351057803;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 22:50:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.951893  Lock_time: 0.000190 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351057805;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:50:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.311795  Lock_time: 0.000116 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351057817;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.315260  Lock_time: 0.000144 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351057817;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:51:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.072520  Lock_time: 0.000086 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351057866;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.686871  Lock_time: 0.000083 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351057866;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:52:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.160056  Lock_time: 0.000072 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351057922;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 22:52:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.974841  Lock_time: 0.000199 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351057936;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
# Time: 121023 22:53:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.505852  Lock_time: 0.000112 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058003;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.099057  Lock_time: 0.000187 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058003;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:53:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 87.776749  Lock_time: 0.000175 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351058009;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.589689  Lock_time: 0.000104 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058088;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.143037  Lock_time: 0.000161 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058089;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:55:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.115803  Lock_time: 0.000079 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351058114;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 22:56:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.310938  Lock_time: 0.000187 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351058179;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 22:56:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.988303  Lock_time: 0.000075 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058201;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:56:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.663265  Lock_time: 0.000092 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058202;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:56:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 108.332530  Lock_time: 0.000136 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351058209;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 22:58:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.507971  Lock_time: 0.000163 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058328;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 22:58:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.283580  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058329;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 22:58:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.563449  Lock_time: 0.000193 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351058334;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.702603  Lock_time: 0.000105 Rows_sent: 22  Rows_examined: 6482
SET timestamp=1351058403;
SELECT
    interest.id,
    SUBSTR(interest.data,
        LOCATE('"init_uri":"', interest.data)+16,
        LOCATE('"', interest.data, LOCATE('"init_uri":"', interest.data) + 16) - LOCATE('"init_uri":"', interest.data) - 16
    ) AS init_uri

FROM
    interest
    LEFT JOIN interest_ext_data ON (
        interest.id = interest_ext_data.interest_id
    )
WHERE
    interest_ext_data.interest_id IS NULL
    AND interest.`datetime` > CURDATE() - INTERVAL 1 DAY
    AND interest.id > 838584
LIMIT
    200;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.967009  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351058403;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:00:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.209165  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351058450;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.225959  Lock_time: 0.000154 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351058450;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# Time: 121023 23:01:58
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 116.988315  Lock_time: 0.000113 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058518;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:01:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 117.557219  Lock_time: 0.000127 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058519;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:02:05
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.231203  Lock_time: 0.000217 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351058525;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
# Time: 121023 23:02:45
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.058887  Lock_time: 0.000144 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058565;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 44.164497  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058565;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:02:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.941326  Lock_time: 0.000149 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351058579;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 23:04:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.341150  Lock_time: 0.000126 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058693;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:04:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.964703  Lock_time: 0.000125 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058694;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:05:00
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 58.945031  Lock_time: 0.000246 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351058700;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:05:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.391162  Lock_time: 0.000083 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351058714;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:06:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 33.959803  Lock_time: 0.000115 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058795;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:06:36
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.627385  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058796;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:06:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 96.072162  Lock_time: 0.000137 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351058797;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 23:08:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 75.413183  Lock_time: 0.000217 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351058897;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:08:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.127473  Lock_time: 0.000108 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351058934;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:08:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.924900  Lock_time: 0.000105 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351058935;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:10:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.863244  Lock_time: 0.000079 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351059003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:10:18
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.988522  Lock_time: 0.000194 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351059018;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 16.986227  Lock_time: 0.000124 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351059018;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:11:13
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.027938  Lock_time: 0.000131 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059073;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:11:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 72.611463  Lock_time: 0.000099 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059074;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:11:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.112770  Lock_time: 0.000196 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351059079;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:12:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.136039  Lock_time: 0.000081 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351059122;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:12:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.742614  Lock_time: 0.000219 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351059136;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
# Time: 121023 23:13:22
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.574206  Lock_time: 0.000136 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059202;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:13:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 82.448019  Lock_time: 0.000098 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059203;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:14:21
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.399216  Lock_time: 0.000285 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351059261;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:14:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.506435  Lock_time: 0.000109 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059281;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.025349  Lock_time: 0.000109 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059281;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:15:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.705605  Lock_time: 0.000098 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351059314;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:16:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.507368  Lock_time: 0.000077 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351059363;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:16:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 51.845433  Lock_time: 0.000159 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059413;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:16:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.595182  Lock_time: 0.000104 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059414;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:16:59
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 57.892183  Lock_time: 0.000251 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351059419;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:17:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.457678  Lock_time: 0.000129 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351059429;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 23:18:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.500597  Lock_time: 0.000135 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059530;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:18:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 50.160749  Lock_time: 0.000096 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059531;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:20:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.752207  Lock_time: 0.000085 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351059603;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:20:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.485179  Lock_time: 0.000212 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351059610;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:20:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.705591  Lock_time: 0.000164 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351059616;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.684517  Lock_time: 0.000089 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351059616;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:21:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.688349  Lock_time: 0.000160 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059670;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.338575  Lock_time: 0.000088 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059670;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:22:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.377048  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059760;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 39.670516  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059760;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
# Time: 121023 23:22:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.019664  Lock_time: 0.000329 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351059768;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:22:53
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.461011  Lock_time: 0.000193 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351059773;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121023 23:24:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.890113  Lock_time: 0.000214 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351059896;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.505157  Lock_time: 0.000102 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351059896;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:25:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.429428  Lock_time: 0.000099 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351059915;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:26:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.580832  Lock_time: 0.000202 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351059986;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:26:40
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.451003  Lock_time: 0.000131 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060000;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 38.923119  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060000;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:26:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 100.743156  Lock_time: 0.000122 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351060002;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 23:28:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.479966  Lock_time: 0.000155 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060130;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.357563  Lock_time: 0.000090 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060130;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:28:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.673826  Lock_time: 0.000194 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351060136;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:30:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.090816  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351060203;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:30:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.555044  Lock_time: 0.000110 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351060216;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.542871  Lock_time: 0.000110 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351060216;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:31:12
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.065998  Lock_time: 0.000134 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060272;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:31:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 71.435054  Lock_time: 0.000140 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060274;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:32:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.610765  Lock_time: 0.000061 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351060322;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:32:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.520702  Lock_time: 0.000191 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351060335;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 23:32:29
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 88.078529  Lock_time: 0.000210 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351060349;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
# Time: 121023 23:33:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.620906  Lock_time: 0.000103 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060399;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:33:20
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 79.130726  Lock_time: 0.000196 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060400;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:34:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.718495  Lock_time: 0.000162 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060490;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.253501  Lock_time: 0.000093 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060490;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:34:57
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.497011  Lock_time: 0.000189 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351060497;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:35:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.996986  Lock_time: 0.000094 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351060515;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:36:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 31.482956  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060593;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 32.240411  Lock_time: 0.000132 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060593;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:36:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 94.322300  Lock_time: 0.000129 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351060595;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 23:38:07
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 65.984551  Lock_time: 0.000205 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351060687;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:38:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.264217  Lock_time: 0.000133 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060730;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 48.827607  Lock_time: 0.000091 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060730;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:40:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.056419  Lock_time: 0.000054 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351060802;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:40:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.713986  Lock_time: 0.000152 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351060817;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.698716  Lock_time: 0.000086 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351060817;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:41:10
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 68.418673  Lock_time: 0.000119 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060870;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 69.015479  Lock_time: 0.000095 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060870;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:41:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 74.691617  Lock_time: 0.000178 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351060876;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:42:42
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.567271  Lock_time: 0.000100 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351060962;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:42:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 41.670914  Lock_time: 0.000159 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351060963;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:42:55
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 54.426654  Lock_time: 0.000182 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351060975;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
# Time: 121023 23:44:23
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 81.691790  Lock_time: 0.000214 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351061063;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:44:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.000399  Lock_time: 0.000104 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061094;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 53.574686  Lock_time: 0.000131 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061094;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:45:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 12.576264  Lock_time: 0.000093 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351061114;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:46:02
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.080752  Lock_time: 0.000041 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351061162;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:46:35
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.196343  Lock_time: 0.000076 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061195;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 34.850944  Lock_time: 0.000081 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061195;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:46:41
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 98.955568  Lock_time: 0.000124 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351061201;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 40.872541  Lock_time: 0.000157 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351061201;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:48:50
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.036395  Lock_time: 0.000092 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061330;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:48:51
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 49.831099  Lock_time: 0.000111 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061331;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:50:04
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 63.154543  Lock_time: 0.000202 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351061404;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:50:16
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.095586  Lock_time: 0.000133 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351061416;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 14.080671  Lock_time: 0.000085 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351061416;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:51:06
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.181963  Lock_time: 0.000079 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061466;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 64.796548  Lock_time: 0.000087 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061466;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:52:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.190792  Lock_time: 0.000055 Rows_sent: 0  Rows_examined: 19568
SET timestamp=1351061523;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121023 23:52:17
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 15.095096  Lock_time: 0.000145 Rows_sent: 3  Rows_examined: 30564
SET timestamp=1351061537;
SELECT /* Memcached:Operation_Allocation */
   allocations.id,
   allocations.allocation
FROM
   sessions USE INDEX (sent_date)
   INNER JOIN programs ON (
       programs.id=sessions.program_id
        AND INSTR(sessions.data, '_orig') > 0
        AND CONVERT(SUBSTR(sessions.data,INSTR(sessions.data, 'age_orig":"') + 11, 2), SIGNED) BETWEEN 15 AND 20
       AND sessions.sent_date > DATE_FORMAT(NOW(), '%Y-%m-01')
       AND sessions.disqualified=0
       AND programs.university_id NOT IN(SELECT id FROM universities WHERE tier=5)
   )
   INNER JOIN allocations ON (
       allocations.id=programs.allocation_id
   )
GROUP BY
   allocations.id
HAVING
   COUNT(sessions.session_id)/allocations.allocation>0.2;
# Time: 121023 23:53:26
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 84.989748  Lock_time: 0.000118 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061606;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:53:27
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 85.628257  Lock_time: 0.000123 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061607;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:53:33
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 91.652541  Lock_time: 0.000183 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351061613;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
# Time: 121023 23:54:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.489712  Lock_time: 0.000105 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061688;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:54:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.993613  Lock_time: 0.000154 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061689;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:55:14
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 13.103667  Lock_time: 0.000109 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351061714;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121023 23:56:19
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 78.144582  Lock_time: 0.000245 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351061779;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121023 23:56:37
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.285026  Lock_time: 0.000076 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061797;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:56:38
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 36.847663  Lock_time: 0.000110 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061798;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:56:43
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 101.975075  Lock_time: 0.000201 Rows_sent: 1493  Rows_examined: 6455011
SET timestamp=1351061803;
SELECT /* Memcached:allocations_by_source */
    COUNT(DISTINCT sessions.id),
    allocations_referrals.allocation,
    allocations_referrals.percent,
    allocations.id,
    allocations_referrals.hardcap,
    allocations_referrals.referral_name
FROM
    allocations_referrals
INNER JOIN allocations ON (
    allocations.id = allocations_referrals.allocation_id
)
INNER JOIN programs ON (
    programs.allocation_id = allocations.id
)
LEFT JOIN sessions ON(
    sessions.program_id = programs.id
    AND sessions.affiliate = allocations_referrals.referral_name
    AND sessions.sent = 1
    AND sessions.show = 1
    AND sessions.disqualified = 0
    AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
)
GROUP BY
    allocations.id,
    allocations_referrals.referral_name;
# Time: 121023 23:58:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.446336  Lock_time: 0.000098 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351061928;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121023 23:58:49
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 47.087866  Lock_time: 0.000089 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351061929;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121023 23:58:54
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 52.450391  Lock_time: 0.000282 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351061934;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121024  0:00:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 1.813352  Lock_time: 0.000068 Rows_sent: 0  Rows_examined: 18099
SET timestamp=1351062003;
SELECT id,`return`,university FROM sessions WHERE disqualified=1 AND reason='Awaiting Status' AND sent_date > DATE_SUB(CURDATE(), INTERVAL 15 DAY);
# Time: 121024  0:00:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.708301  Lock_time: 0.000100 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351062048;
SELECT
    sessions.id,
    sessions.email,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason,
    sessions.affiliate,
    SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'program":"', -1), '"', 1) as program,
    sessions.data
FROM
    sessions
WHERE
    sessions.sent = 0
    AND sessions.`show` = 1
    AND sessions.disqualified = 0
    AND sessions.post <> ''
    AND sessions.reason = ''
    AND sessions.expire > DATE_SUB(NOW(), INTERVAL 15 DAY);
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.722984  Lock_time: 0.000096 Rows_sent: 1  Rows_examined: 29637
SET timestamp=1351062048;
SELECT
    sessions.id,
    sessions.university,
    sessions.post,
    sessions.zip,
    sessions.reason
FROM
    sessions
WHERE
    sessions.sent = 0 
    AND sessions.`show` = 1 
    AND sessions.disqualified = 0 
    AND sessions.post <> ''
    AND sessions.university <> ''
    AND SUBSTRING_INDEX(SUBSTRING_INDEX(data, 'verification_score":', -1), ',', 1) = 0 
    AND sessions.expire > DATE_FORMAT(NOW(), '%Y-%m-01');
# Time: 121024  0:02:08
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 127.135199  Lock_time: 0.000118 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351062128;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# Time: 121024  0:02:09
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 128.147733  Lock_time: 0.000108 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351062129;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121024  0:02:15
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 73.604839  Lock_time: 0.000167 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351062135;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
    COUNT(sessions.id), SUM(IF(BINARY(UPPER(SUBSTRING(sessions.affiliate,1,1)))=BINARY(SUBSTRING(sessions.affiliate,1,1)),1,0)),
    100*COUNT(sessions.id)/`allocations`.allocation AS perc,
    `affiliates_price`.allocation,
    affiliates.name,
    `allocations`.pause,
    `allocations`.price
FROM
    `allocations`,
    `universities`,
    paul.`affiliates_price`,
    affiliates,
    `programs` LEFT JOIN sessions ON
        sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.program_id=`programs`.id
        AND DATE_FORMAT(sessions.sent_date, '%c-%Y') = '10-2012'
WHERE
    `allocations`.id=`programs`.allocation_id
    AND `programs`.university_id=`universities`.id
    AND `affiliates_price`.allocation_id=`allocations`.id
    AND `affiliates_price`.affiliate_id=affiliates.id
    
GROUP BY
    `allocations`.id,
    `affiliates_price`.id
ORDER BY
    `allocations`.name;
# Time: 121024  0:02:48
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 46.570667  Lock_time: 0.000127 Rows_sent: 65266  Rows_examined: 1737651
SET timestamp=1351062168;
SELECT /* Memcached:program_mix_flags */
	allocations.id,
	allocations.allocation,
	programs.id,
	COUNT(DISTINCT sessions.id),
	programs.boost,
	programs.cap,
	programs.cap_number,
	programs.pause
FROM
	programs
	INNER JOIN allocations ON (
		allocations.id=programs.allocation_id
	)
	LEFT JOIN sessions ON (
		sessions.program_id=programs.id
		AND sessions.`show`=1
		AND sessions.sent=1
		AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
	)
	GROUP BY
		programs.id
	HAVING
		COUNT(DISTINCT sessions.id)>0
		OR programs.boost=1
		OR programs.cap>0
		OR programs.cap_number>0
		OR programs.pause=1;
# Time: 121024  0:04:56
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.061560  Lock_time: 0.000097 Rows_sent: 124  Rows_examined: 1043545
SET timestamp=1351062296;
SELECT /* Memcached:Remaining_Allocations*/
    allocations.id,
    allocations.allocation
FROM
    allocations,
    programs
LEFT JOIN sessions ON (
    sessions.sent=1
    AND sessions.`show`=1
    AND sessions.disqualified=0
    AND sessions.sent_date > DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    AND sessions.program_id=programs.id
)
WHERE
    allocations.id=programs.allocation_id
    AND allocations.pause=0
GROUP BY
    allocations.id
HAVING
    COUNT(DISTINCT sessions.id) < allocations.allocation;
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 55.727655  Lock_time: 0.000163 Rows_sent: 468  Rows_examined: 1242903
SET timestamp=1351062296;
SELECT /* Memcached:leads_allocations */
    COUNT(DISTINCT sessions.id),
    allocations.allocation,
    allocations.filldays,
    allocations.id,
    allocations.pause
FROM
    allocations
    JOIN programs ON (
        programs.allocation_id=allocations.id
    )
    LEFT JOIN sessions ON (
        sessions.program_id=programs.id
        AND sessions.sent=1
        AND sessions.`show`=1
        AND sessions.disqualified=0
        AND sessions.sent_date >= DATE_FORMAT(CURDATE(), "%Y-%m-01 00:00:00")
    )
GROUP BY
    allocations.id;
# Time: 121024  0:05:03
# User@Host: ampush[ampush] @ amweb01 [10.54.91.136]
# Query_time: 61.959341  Lock_time: 0.000244 Rows_sent: 16540  Rows_examined: 8110273
SET timestamp=1351062303;
SELECT /* Memcached:Allocations_Simple_Current_Month */
    `allocations`.id,
    `allocations`.name,
    `allocations`.allocation,
    `allocations`.updated,
    `allocations`.filldays,
    `allocations`.daycap,
    `universities`.active,
